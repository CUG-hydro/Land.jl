<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Leaf Level Basics · Land</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="Land logo"/></a><div class="docs-package-name"><span class="docs-autofit">Land</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../plant_module/">Plant Module</a></li><li><a class="tocitem" href="../../photosynthesis_models/">PhotosynthesisModels Module</a></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox" checked/><label class="tocitem" for="menuitem-4"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Canopy Radiative Transfer</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../Radiation_Test_BRDF/">Reflected and Emitted Radiance</a></li><li><a class="tocitem" href="../RAMI_benchmarking_example/">RAMI benchmarking</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox" checked/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">PhotoSynthesis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Leaf Level Basics</a><ul class="internal"><li><a class="tocitem" href="#Rate-Limiting-Steps-for-photosynthesis-1"><span>Rate Limiting Steps for photosynthesis</span></a></li><li><a class="tocitem" href="#Simple-example:-1"><span>Simple example:</span></a></li></ul></li><li><a class="tocitem" href="../Leaf-Photosynthesis-Rates/">Enzyme catalysis T-dependence</a></li><li><a class="tocitem" href="../Leaf-Photosynthesis-Synthesis/">Leaf Photosynthetic rates</a></li></ul></li><li><span class="tocitem">Canopy Energy Balance</span></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li><a class="is-disabled">PhotoSynthesis</a></li><li class="is-active"><a href>Leaf Level Basics</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Leaf Level Basics</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/CliMA/Land/blob/master/notebooks/Leaf-Photosynthesis.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Leaf-Photosynthesis-Basics-1"><a class="docs-heading-anchor" href="#Leaf-Photosynthesis-Basics-1">Leaf Photosynthesis Basics</a><a class="docs-heading-anchor-permalink" href="#Leaf-Photosynthesis-Basics-1" title="Permalink"></a></h1><p>This tutorial will walk you through the most basic aspects of how we implement Photosynthesis at the leaf level. Most of the concepts are described in the literature, with the first quantitative approach to modeling photosynthesis given in Farquhar, von Caemmerer and Berry<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup> in their seminal 1980 paper for C3 photosynthesis. C4 photosynthesis is largely based on Collatz et al<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup> but we approach the photosynthesis modeling with a rather generic approach that facilitates the application of different photosynthesis modeling approaches without changing the core code base. A good overview on the entire process of photosynthesis and different parameterizations can be found in Bonan<sup class="footnote-reference"><a id="citeref-3" href="#footnote-3">[3]</a></sup>.</p><p>At the core of both C3 and C4 photosynthesis is an enzyme catalyzed reaction of ribulose-1,5-bisphosphate (RuBP) with CO<span>$_2$</span>, yielding two 3-carbon compounds (phosphoglycerate (PGA)) as the initial products of photosynthesis. The enzyme RuBP carboxylase/oxygenase (Rubisco) catalyzes this reaction. With the regeneration of the substrate RuBP through the light reactions (using produced ATP and NADPH), the core cycle of photosynthesis is formed. This cycle was discovered in 1950 by Melvin Calvin, James Bassham, and Andrew Benson at the University of California, Berkeley<sup class="footnote-reference"><a id="citeref-4" href="#footnote-4">[4]</a></sup><sup class="footnote-reference"><a id="citeref-5" href="#footnote-5">[5]</a></sup> by using the radioactive isotope carbon-14.</p><p>An oxygenation step of RuBP releases half a CO<span>$_2$</span>. This so called photorespiration process results in inefficiencies in C3 photosynthesis, as both CO<span>$_2$</span> and O<span>$_2$</span> compete at the Rubisco site. The overall photosynthetic rate of the enzyme-catalyzed turnover rates at the Rubisco site thus determine the overall photosynthesis</p><div>\[A_n = V_c - 0.5V_o - R_d\,,\]</div><p>with <span>$V_c$</span> being the carboxylation rate, <span>$V_o$</span> the oxygenation rate and <span>$R_d$</span> the mitochondrial respiration. Both rates follow Michaelis-Menten kinetics, accounting for the competing substrate effects:</p><div>\[V_c = \frac{V_{c,max}C_c}{C_c+K_c(1+O_c/K_o)}\]</div><div>\[V_o = \frac{V_{o,max}O_c}{O_c+K_o(1+C_c/K_c)}\,\]</div><p>with <span>$K_c$</span> and <span>$K_o$</span> being the Michaelis Menten constants for CO<span>$_2$</span> and O<span>$_2$</span>, <span>$C_c$</span> and <span>$O_c$</span> the partial pressures of CO<span>$_2$</span> and O<span>$_2$</span> at the Rubisco site.</p><p>The ratio of oxygenation to carboxylation rates is</p><div>\[\phi = \frac{V_o}{V_c} = \frac{V_{o,max}K_c}{V_{c,max}K_o}\frac{O_c}{C_c}\,\]</div><p>which yields the CO<span>$_2$</span> compensation point <span>$\Gamma_\star$</span>:</p><div>\[\Gamma_\star = 0.5\frac{V_{o,max}K_c}{V_{c,max}K_o}O_c\,\]</div><p>with is the internal CO<span>$_2$</span> partial pressure at which oxygenation and carboxylation cancel each other out in terms of CO<span>$_2$</span> consumption and production (neglecting <span>$R_d$</span>).</p><h2 id="Rate-Limiting-Steps-for-photosynthesis-1"><a class="docs-heading-anchor" href="#Rate-Limiting-Steps-for-photosynthesis-1">Rate Limiting Steps for photosynthesis</a><a class="docs-heading-anchor-permalink" href="#Rate-Limiting-Steps-for-photosynthesis-1" title="Permalink"></a></h2><h3 id="Rubisco-limited-rates:-1"><a class="docs-heading-anchor" href="#Rubisco-limited-rates:-1">Rubisco-limited rates:</a><a class="docs-heading-anchor-permalink" href="#Rubisco-limited-rates:-1" title="Permalink"></a></h3><p>The net photosynthetic rate limited by Rubisco when RuBP re-generation is not constraining can thus be described as</p><div>\[A_n = \left(1-\frac{\Gamma_\star}{C_c}\right)V_c-R_d\,\]</div><p>which equals (now denoting <span>$A_c$</span> as the Rubisco limited rate):</p><div>\[A_c = \frac{(C_c-\Gamma_\star) V_{c,max}}{C_c+K_c(1+O_c/K_o)}\,\]</div><p>which is implemented in our routines &quot;rubisco<em>limited</em>rate!&quot;.</p><h3 id="RuBP-regeration-limited-rates-(light-limited):-1"><a class="docs-heading-anchor" href="#RuBP-regeration-limited-rates-(light-limited):-1">RuBP-regeration limited rates (light-limited):</a><a class="docs-heading-anchor-permalink" href="#RuBP-regeration-limited-rates-(light-limited):-1" title="Permalink"></a></h3><p>RuBP is regenerated via the ligh reaction, which generates ATP and NADP to power this part of the Calvin-Benson-Bassham cycle. Without going into details of the NADPH or ATP requirements for regeneration, the rate of RuBP limited photosynthesis through light-powered electron transport <span>$J$</span> (µmol/m<span>$^2$</span>/s) is given as</p><div>\[A_j = \underbrace{\frac{C_c-\Gamma_\star}{Cc}}_{\text{loss in photorespiration}}\underbrace{\frac{J\,C_c}{4C_c+8\Gamma_\star}}_{\text{RuBP regeneration}} = \frac{J(C_c-\Gamma_\star)}{4C_c+8\Gamma_\star}\,\]</div><p>One can already see what the key difference between C3 and C4 photosynthesis is based on these set of equation for rubisco turnover and RuBP-regeneration limited rates. In C4 photosynthesis, <span>$C_c$</span> is typically only about 70% of the ambient CO<span>$_2$</span> concentration as CO<span>$_2$</span> has to diffuse through stomata and the mesophyll. For C4, a carbon accumulation mechanism uses a four-carbon organic acid (hence C4) to transport CO<span>$_2$</span> from the mesophyll cells to the bundle sheath cells, where the reaction with Rubisco takes place. This leads to much higher <span>$C_c$</span> for C4 plants (<span>$&gt;&gt;$</span> than ambient air CO<span>$_2$</span>), which is often simplified for <span>$A_c$</span> as the limit of C3 equation with <span>$\lim_{C_c \to \infty}$</span> Ac(C3):</p><div>\[A_c^{C4} = V_{c,max}\]</div><p>Similarly, the RuBP-regeneration limited rate simplifies to:</p><div>\[A_j^{C4} = \alpha J\]</div><p>with a slightly lower efficiency <span>$\alpha$</span> for C4 photosynthesis compared to C3 (as the carbon accumulation mechanism also consumes ATP). In reality, the situation is somewhat more complex and there are different approximations for Rubisco and RuBP limited rate constants. A comprehensive overview is described in von Caemmerer <sup class="footnote-reference"><a id="citeref-6" href="#footnote-6">[6]</a></sup>. Again, our goal is to provide a flexible framework for photosynthesis modeling, so different implementations of rate limiting steps <span>$A_c,A_j$</span> can be used in a modular framework (achieved through code abstraction and multiple dispatch in Julia).</p><h3 id="Electron-Transport-Rate-J-1"><a class="docs-heading-anchor" href="#Electron-Transport-Rate-J-1">Electron Transport Rate <span>$J$</span></a><a class="docs-heading-anchor-permalink" href="#Electron-Transport-Rate-J-1" title="Permalink"></a></h3><p>The rate of electron transport is driven by absorbed photosynthetically absorbed radiation (APAR, <span>$\mu mol/m^2/s$</span>) by Photosystem II (PSII). With our leaf level optical model, we already compute the efficiency of absorbtion by leaves depending on pigment contents. We define <span>$\varphi_{PSII}$</span> as the quantum yield of photosystem II (maxima about 0.83) and <span>$f_{PSII}$</span> the fraction of light used for PSII (PSII/(PSI+PSII)), typically assume to be 0.5.</p><div>\[J_{PSII} = f_{PSII} \varphi_{PSII} APAR\]</div><p>In most models, a maximum electron transport <span>$J_{max}$</span> rate is assumed and the actual electron trapsort rate <span>$J_a$</span> is defined as the lower root of the quadratic expression</p><div>\[\Theta_j J_a^2 -(J_{PSII}+J_{max})+ J_{PSII}J_{max} = 0\]</div><p>where <span>$\Theta_j$</span> is a curvature parameter to assure a smooth transition.</p><h3 id="Product-limited-rates:-1"><a class="docs-heading-anchor" href="#Product-limited-rates:-1">Product limited rates:</a><a class="docs-heading-anchor-permalink" href="#Product-limited-rates:-1" title="Permalink"></a></h3><p>Typically, a thrid limitation of photosynthesis is being used as well, which we denote as product limited rate here, even though the processes for C3 and C4 plants differ. Typically, the export of the products of photosynthesis (triose phosphates) in the synthesis of sugars can be rate limiting, which is often parameterized by <span>$V_{c,max}$</span>:</p><div>\[A_p = a V_{c,max}\,,\]</div><p>where our standard definition for C3 used a=0.5, which rarely limits photosynthesis compared to <span>$A_c$</span> and <span>$A_j$</span>.</p><p>For C4 plants, we use the PEP-carboxylase CO<span>$_2$</span> concentration mechanism into the bundle sheath cell as product limited rate step, using Michaelis-Menten kinetics:</p><div>\[A_p^{C4} = \frac{V_{p,max}C_c}{C_c + K_p}\]</div><p>with corresponding Michaelis Menten constant <span>$K_p$</span> and maximal rates <span>$V_{p,max}$</span>.</p><h3 id="Total-rate:-1"><a class="docs-heading-anchor" href="#Total-rate:-1">Total rate:</a><a class="docs-heading-anchor-permalink" href="#Total-rate:-1" title="Permalink"></a></h3><p>The gross photosynthetic rate <span>$A_g$</span> can then be define as the mininum of all possible limitations:</p><div>\[A_g = min(Ac,Aj,Ap)\]</div><p>or, alternatively, using quadratic equations as for <span>$J$</span>, which provides smoother transitions and co-limitation to some degree (both are options in our setup with a user defined curvature parameter <span>$\Theta$</span>.</p><p>Net leaf photosynthesis includes mitochondrial respiration as well:</p><div>\[A_n = A_g - R_d\]</div><h2 id="Simple-example:-1"><a class="docs-heading-anchor" href="#Simple-example:-1">Simple example:</a><a class="docs-heading-anchor-permalink" href="#Simple-example:-1" title="Permalink"></a></h2><p>We just want to lay out a first simple example as to how our model setup work:</p><pre><code class="language-"># Loading the Photosynthesis model:
using Revise
using Land.Photosynthesis
# Defining our Field Type (we can easily switch between Double and Float precision this way)
const FT = Float32;
nothing #hide</code></pre><pre><code class="language-"># Create a standard leaf with defualt parameters
leaf = leaf_params{FT}();

# Create a standard meteo structure:
met = meteo{FT}();
nothing #hide</code></pre><hr/><p>How to use the documentation, what do we know about leaf_params, which stores most physiologically relevant parameters. (Not printed here, try in the command line!).</p><pre><code class="language-julia">?leaf_params</code></pre><pre><code class="language-julia">?meteo</code></pre><h3 id="Defining-the-model-setup-1"><a class="docs-heading-anchor" href="#Defining-the-model-setup-1">Defining the model setup</a><a class="docs-heading-anchor-permalink" href="#Defining-the-model-setup-1" title="Permalink"></a></h3><p>The most important step is to define which submodules to use. There might be different implementations for Fluorescence, Photosynthesis (C3,C4,etc), respiration, stomatal conductance (e.g. Ball-Berry, Medlyn), the T-dependence of J<span>$_{max}$</span>, V<span>$_{c,max}$</span> and Michaelis Menten constants as well as leaf boundary layer resistance (setting it to 0 here to mimic well vented laboratory leaf level measurements) and colimitation.</p><pre><code class="language-">##Here, we just have to worry abou the photosynthesis module, which we set here:
mod_photo = C3FvCBPhoto()

# All modules here:
mods = Photosynthesis.PhotoMods(
    fluorescence    = FlexasTolBerryFluorescence{FT}(),
    photosynthesis  = C3FvCBPhoto(),
    respiration     = RespirationCLM{FT}(),
    stomatal        = BallBerryStomata{FT}(g1=8),
    Jmax            = JmaxCLM{FT}(),
    Vmax            = VcmaxCLM{FT}(),
    MichaelisMenten = MM_CLM{FT}(),
    BoundaryLayer   = FixedBoundaryResistance{FT}(ra=0),
    colimitation = CurvedColimit{FT}(0.99));
nothing #hide</code></pre><pre><code class="language-"># Set APAR to 250 $\mu mol/m^2/s$
leaf.APAR = 250;
# Set temperature to 290K
leaf.T = 290;
# Applying the T-correction for all rate constants:
Photosynthesis.set_leaf_temperature!(mods, leaf)
@show leaf.Vcmax
@show leaf.Jmax
# Specify Cc directly here in ppm (will be converted to Pa internally)
leaf.Cc = 350;
nothing #hide</code></pre><pre><code class="language-">Aj = Photosynthesis.light_limited_rate!(mod_photo, leaf, met, leaf.APAR)</code></pre><pre><code class="language-">Ac = Photosynthesis.rubisco_limited_rate!(mod_photo, leaf, met)</code></pre><pre><code class="language-">Ap = Photosynthesis.product_limited_rate!(mod_photo, leaf, met)</code></pre><hr/><h3 id="Summary-1"><a class="docs-heading-anchor" href="#Summary-1">Summary</a><a class="docs-heading-anchor-permalink" href="#Summary-1" title="Permalink"></a></h3><p>This was the simplest example to compute A<span>$_c$</span>, A<span>$_j$</span> and A<span>$_p$</span> with a specified C<span>$_c$</span> and APAR. In reality, C<span>$_c$</span> is defined by the interplay of photosynthetic demand and the supply through diffusion through stomata and the mesophyll. However, you can easily exchange the photosynthesis model above with C4FvCBPhoto(). You can also play around with leaf temperature T and APAR as well as <span>$C_c$</span>.</p><pre><code class="language-julia">?C3FvCBPhoto</code></pre><pre><code class="language-julia">?C4CollatzPhoto</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>Farquhar, G.D., von Caemmerer, S.V. and Berry, J.A., 1980. A biochemical model of photosynthetic CO<span>$_2$</span> assimilation in leaves of C3 species. Planta, 149(1), pp.78-90.</li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a>Collatz, G.J., Ribas-Carbo, M. and Berry, J.A., 1992. Coupled photosynthesis-stomatal conductance model for leaves of C4 plants. Functional Plant Biology, 19(5), pp.519-538.</li><li class="footnote" id="footnote-3"><a class="tag is-link" href="#citeref-3">3</a>Bonan, G., 2019. Climate change and terrestrial ecosystem modeling. Cambridge University Press.</li><li class="footnote" id="footnote-4"><a class="tag is-link" href="#citeref-4">4</a>Calvin, Melvin, and Andrew Alm Benson. &quot;The path of carbon in photosynthesis IV: the identity and sequence of the intermediates in sucrose synthesis.&quot; Science 109, no. 2824 (1949): 140-142.</li><li class="footnote" id="footnote-5"><a class="tag is-link" href="#citeref-5">5</a>Benson, A.A., Bassham, J.A., Calvin, M., Goodale, T.C., Haas, V.A. and Stepka, W., 1950. The path of carbon in photosynthesis. v. paper chromatography and radioautography of the products1. Journal of the American Chemical Society, 72(4), pp.1710-1718.</li><li class="footnote" id="footnote-6"><a class="tag is-link" href="#citeref-6">6</a>Von Caemmerer, S., 2000. Biochemical models of leaf photosynthesis. Csiro publishing.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../RAMI_benchmarking_example/">« RAMI benchmarking</a><a class="docs-footer-nextpage" href="../Leaf-Photosynthesis-Rates/">Enzyme catalysis T-dependence »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 28 May 2020 22:47">Thursday 28 May 2020</span>. Using Julia version 1.3.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
