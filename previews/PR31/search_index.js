var documenterSearchIndex = {"docs":
[{"location":"pages/Photosynthesis/#Photosynthesis-module-for-the-LAND-model-1","page":"Photosynthesis","title":"Photosynthesis module for the LAND model","text":"","category":"section"},{"location":"pages/Photosynthesis/#Temperature-Dependency-1","page":"Photosynthesis","title":"Temperature Dependency","text":"","category":"section"},{"location":"pages/Photosynthesis/#Types-1","page":"Photosynthesis","title":"Types","text":"","category":"section"},{"location":"pages/Photosynthesis/#","page":"Photosynthesis","title":"Photosynthesis","text":"Land.Photosynthesis.AbstractTDParameterSet\nLand.Photosynthesis.ArrheniusTD\nLand.Photosynthesis.ArrheniusPeakTD","category":"page"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.AbstractTDParameterSet","page":"Photosynthesis","title":"Land.Photosynthesis.AbstractTDParameterSet","text":"type AbstractTDParameterSet{FT}\n\nHierarchy of the AbstractTDParameterSet:\n\nArrheniusTD\nArrheniusPeakTD\n\n\n\n\n\n","category":"type"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.ArrheniusTD","page":"Photosynthesis","title":"Land.Photosynthesis.ArrheniusTD","text":"struct ArrheniusTD{FT}\n\nAn AbstractTDParameterSet type struct using\n\ncorr = exp left( dfracΔHaR T_0 - dfracΔHaR T_1 right)\n\nFields\n\nVAL_25\nUncorrected value at 298.15 K\nΔHa_to_R\nRatio between ΔHa and R [K]\nΔHa_to_RT25\nRatio between ΔHa and R*K_25\n\n\n\n\n\n","category":"type"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.ArrheniusPeakTD","page":"Photosynthesis","title":"Land.Photosynthesis.ArrheniusPeakTD","text":"struct ArrheniusPeakTD{FT}\n\nAn AbstractTDParameterSet type struct using\n\ncorr = exp left( dfracΔHaR T_0 - dfracΔHaR T_1 right)\n       cdot\n       dfrac 1 + exp left( dfracS_v T_0 - H_dR T_0 right) \n               1 + exp left( dfracS_v T_1 - H_dR T_1 right) \n\nFields\n\nΔHa_to_RT25\nRatio between ΔHa and R*K_25\nΔHd_to_R\nRatio between ΔHd and R\nΔSv_to_R\nRatio between ΔSv and R\nC\nCorrection factor C = 1 + exp( Sv/R + Hd/(RT0) )\n\n\n\n\n\n","category":"type"},{"location":"pages/Photosynthesis/#Parameter-sets-1","page":"Photosynthesis","title":"Parameter sets","text":"","category":"section"},{"location":"pages/Photosynthesis/#","page":"Photosynthesis","title":"Photosynthesis","text":"Land.Photosynthesis.JmaxTDBernacchi\nLand.Photosynthesis.JmaxTDCLM\nLand.Photosynthesis.JmaxTDLeuning\nLand.Photosynthesis.KcTDBernacchi\nLand.Photosynthesis.KcTDCLM\nLand.Photosynthesis.KoTDBernacchi\nLand.Photosynthesis.KoTDCLM\nLand.Photosynthesis.KpepTDBoyd\nLand.Photosynthesis.KpepTDCLM\nLand.Photosynthesis.RespirationTDBernacchi\nLand.Photosynthesis.RespirationTDCLM\nLand.Photosynthesis.VcmaxTDBernacchi\nLand.Photosynthesis.VcmaxTDCLM\nLand.Photosynthesis.VcmaxTDLeuning\nLand.Photosynthesis.VomaxTDBernacchi\nLand.Photosynthesis.VpmaxTDBoyd\nLand.Photosynthesis.ΓStarTDBernacchi\nLand.Photosynthesis.ΓStarTDCLM","category":"page"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.JmaxTDBernacchi","page":"Photosynthesis","title":"Land.Photosynthesis.JmaxTDBernacchi","text":"ArrheniusPeakTD type Jmax TD \n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.JmaxTDCLM","page":"Photosynthesis","title":"Land.Photosynthesis.JmaxTDCLM","text":"ArrheniusPeakTD type Jmax TD \n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.JmaxTDLeuning","page":"Photosynthesis","title":"Land.Photosynthesis.JmaxTDLeuning","text":"ArrheniusPeakTD type Jmax TD from Leuning's data \n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.KcTDBernacchi","page":"Photosynthesis","title":"Land.Photosynthesis.KcTDBernacchi","text":"ArrheniusTD type Kc TD from Bernacchi's data \n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.KcTDCLM","page":"Photosynthesis","title":"Land.Photosynthesis.KcTDCLM","text":"ArrheniusTD type Kc TD \n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.KoTDBernacchi","page":"Photosynthesis","title":"Land.Photosynthesis.KoTDBernacchi","text":"ArrheniusTD type Ko TD from Bernacchi's data \n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.KoTDCLM","page":"Photosynthesis","title":"Land.Photosynthesis.KoTDCLM","text":"ArrheniusTD type Ko TD \n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.KpepTDBoyd","page":"Photosynthesis","title":"Land.Photosynthesis.KpepTDBoyd","text":"ArrheniusTD type Kpep TD from Boyd's data \n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.KpepTDCLM","page":"Photosynthesis","title":"Land.Photosynthesis.KpepTDCLM","text":"ArrheniusTD type Kpep TD \n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.RespirationTDBernacchi","page":"Photosynthesis","title":"Land.Photosynthesis.RespirationTDBernacchi","text":"ArrheniusTD type Respiration TD from Bernacchi's data \n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.RespirationTDCLM","page":"Photosynthesis","title":"Land.Photosynthesis.RespirationTDCLM","text":"ArrheniusPeakTD type Respiration TD \n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.VcmaxTDBernacchi","page":"Photosynthesis","title":"Land.Photosynthesis.VcmaxTDBernacchi","text":"ArrheniusTD type Vcmax TD from Bernacchi's data \n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.VcmaxTDCLM","page":"Photosynthesis","title":"Land.Photosynthesis.VcmaxTDCLM","text":"ArrheniusPeakTD type Vcmax TD \n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.VcmaxTDLeuning","page":"Photosynthesis","title":"Land.Photosynthesis.VcmaxTDLeuning","text":"ArrheniusPeakTD type Vcmax TD from Leuning's data \n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.VomaxTDBernacchi","page":"Photosynthesis","title":"Land.Photosynthesis.VomaxTDBernacchi","text":"ArrheniusTD type Vomax TD from Bernacchi's data \n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.VpmaxTDBoyd","page":"Photosynthesis","title":"Land.Photosynthesis.VpmaxTDBoyd","text":"ArrheniusPeakTD type Vpmax TD from Boyd's data \n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.ΓStarTDBernacchi","page":"Photosynthesis","title":"Land.Photosynthesis.ΓStarTDBernacchi","text":"ArrheniusTD type Γ^* TD from Bernacchi's data \n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.ΓStarTDCLM","page":"Photosynthesis","title":"Land.Photosynthesis.ΓStarTDCLM","text":"ArrheniusTD type Γ* TD \n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Photosynthesis-Colimitation-1","page":"Photosynthesis","title":"Photosynthesis Colimitation","text":"","category":"section"},{"location":"pages/Photosynthesis/#","page":"Photosynthesis","title":"Photosynthesis","text":"Land.Photosynthesis.AbstractColimitation\nLand.Photosynthesis.MinColimit\nLand.Photosynthesis.CurvedColimit","category":"page"},{"location":"pages/Photosynthesis/#Land.MathTools.AbstractColimitation","page":"Photosynthesis","title":"Land.MathTools.AbstractColimitation","text":"type AbstractColimitation\n\nHierarchy of the AbstractColimitation:\n\nMinColimit\nCurvedColimit\n\n\n\n\n\n","category":"type"},{"location":"pages/Photosynthesis/#Land.MathTools.MinColimit","page":"Photosynthesis","title":"Land.MathTools.MinColimit","text":"struct MinColimit\n\nTakes the minimum of all computed photosynthetic rates.\n\n\n\n\n\n","category":"type"},{"location":"pages/Photosynthesis/#Land.MathTools.CurvedColimit","page":"Photosynthesis","title":"Land.MathTools.CurvedColimit","text":"struct CurvedColimit{FT}\n\nTakes curved limitation for computed photosynthetic rates.\n\nFields\n\ncurvature\nCurveature ratio\n\n\n\n\n\n","category":"type"},{"location":"pages/Photosynthesis/#Fluorescence-Model-1","page":"Photosynthesis","title":"Fluorescence Model","text":"","category":"section"},{"location":"pages/Photosynthesis/#Types-2","page":"Photosynthesis","title":"Types","text":"","category":"section"},{"location":"pages/Photosynthesis/#","page":"Photosynthesis","title":"Photosynthesis","text":"Land.Photosynthesis.AbstractFluoModelParaSet\nLand.Photosynthesis.FluoParaSet","category":"page"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.AbstractFluoModelParaSet","page":"Photosynthesis","title":"Land.Photosynthesis.AbstractFluoModelParaSet","text":"type AbstractFluoModelParaSet\n\nHierarchy of the AbstractFluoModelParaSet:\n\nFluoParaSet\n\n\n\n\n\n","category":"type"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.FluoParaSet","page":"Photosynthesis","title":"Land.Photosynthesis.FluoParaSet","text":"struct FluoParaSet{FT}\n\nA AbstractFluoModelParaSet type paramter set.\n\nFields\n\nKn1\nFluorescence model coefficient\nKn2\nFluorescence model coefficient\nKn3\nFluorescence model coefficient\n\n\n\n\n\n","category":"type"},{"location":"pages/Photosynthesis/#Parameter-sets-2","page":"Photosynthesis","title":"Parameter sets","text":"","category":"section"},{"location":"pages/Photosynthesis/#","page":"Photosynthesis","title":"Photosynthesis","text":"Land.Photosynthesis.FluorescenceFlexas","category":"page"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.FluorescenceFlexas","page":"Photosynthesis","title":"Land.Photosynthesis.FluorescenceFlexas","text":"FluoParaSet type parameter set using Flexas's data \n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Respiration-Quantification-1","page":"Photosynthesis","title":"Respiration Quantification","text":"","category":"section"},{"location":"pages/Photosynthesis/#","page":"Photosynthesis","title":"Photosynthesis","text":"Land.Photosynthesis.VtoRCollatz\nLand.Photosynthesis.VtoRDefault","category":"page"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.VtoRCollatz","page":"Photosynthesis","title":"Land.Photosynthesis.VtoRCollatz","text":"A constant of 0.01 \n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.VtoRDefault","page":"Photosynthesis","title":"Land.Photosynthesis.VtoRDefault","text":"A constant of 0.015 \n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Stomatal-Model-Scheme-1","page":"Photosynthesis","title":"Stomatal Model Scheme","text":"","category":"section"},{"location":"pages/Photosynthesis/#","page":"Photosynthesis","title":"Photosynthesis","text":"Land.Photosynthesis.AbstractStomatalModel\nLand.Photosynthesis.EmpiricalStomatalModel\nLand.Photosynthesis.OptimizationStomatalModel","category":"page"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.AbstractStomatalModel","page":"Photosynthesis","title":"Land.Photosynthesis.AbstractStomatalModel","text":"type AbstractStomatalModel\n\nHierarchy of the AbstractStomatalModel:\n\nEmpiricalStomatalModel\nOptimizationStomatalModel\n\n\n\n\n\n","category":"type"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.EmpiricalStomatalModel","page":"Photosynthesis","title":"Land.Photosynthesis.EmpiricalStomatalModel","text":"type EmpiricalStomatalModel\n\nHierarchy of the EmpiricalStomatalModel:\n\nESMBallBerry\nESMGentine\nESMLeuning\nESMMedlyn\n\n\n\n\n\n","category":"type"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.OptimizationStomatalModel","page":"Photosynthesis","title":"Land.Photosynthesis.OptimizationStomatalModel","text":"type OptimizationStomatalModel\n\nHierarchy of the OptimizationStomatalModel:\n\nOSMEller\nOSMSperry\nOSMWang\nOSMWAP\nOSMWAPMod\n\n\n\n\n\n","category":"type"},{"location":"pages/Photosynthesis/#Empirical-Stomatal-Model-1","page":"Photosynthesis","title":"Empirical Stomatal Model","text":"","category":"section"},{"location":"pages/Photosynthesis/#","page":"Photosynthesis","title":"Photosynthesis","text":"Land.Photosynthesis.ESMBallBerry\nLand.Photosynthesis.ESMGentine\nLand.Photosynthesis.ESMLeuning\nLand.Photosynthesis.ESMMedlyn","category":"page"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.ESMBallBerry","page":"Photosynthesis","title":"Land.Photosynthesis.ESMBallBerry","text":"struct ESMBallBerry{FT}\n\nAn empirical model parameter set type for Ball-Berry type model. The equation used for Ball-Berry type model is\n\ngs = g0 + g1  RH  dfracACs\n\nFields\n\ng0\nminimal stomatal conductance g0 [mol m⁻² s⁻¹]\ng1\nslope of conductance-photosynthesis correlation [unitless]\n\n\n\n\n\n","category":"type"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.ESMGentine","page":"Photosynthesis","title":"Land.Photosynthesis.ESMGentine","text":"struct ESMGentine{FT}\n\nAn empirical model parameter set type for Gentine type model. The equation used for Gentine type model is\n\ngs = g0 + g1  dfrack_leafk_max  dfracACa\n\nNote it that the Gentine model does not require for a β function to tune the     soil drought response, but the use of k_leaf also does not permit     post-drought stomatal response unless k_leaf can be recovered.\n\nFields\n\ng0\nminimal stomatal conductance g0 [mol m⁻² s⁻¹]\ng1\nslope of conductance-photosynthesis correlation [unitless]\n\n\n\n\n\n","category":"type"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.ESMLeuning","page":"Photosynthesis","title":"Land.Photosynthesis.ESMLeuning","text":"struct ESMLeuning{FT}\n\nAn empirical model parameter set type for Leuning type model. The equation used for Leuning type model is\n\ngs = g0 + g1  dfracACs - Γ^*  dfrac11 + dfracVPDd0\n\nFields\n\ng0\nminimal stomatal conductance g0 [mol m⁻² s⁻¹]\ng1\nslope of conductance-photosynthesis correlation [unitless]\nd0\nfitting parameter of d/d0 below the fraction, same unit as vpd [Pa]\n\n\n\n\n\n","category":"type"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.ESMMedlyn","page":"Photosynthesis","title":"Land.Photosynthesis.ESMMedlyn","text":"struct ESMMedlyn{FT}\n\nAn empirical model parameter set type for Medlyn type model. The equation used in Medlyn type model is\n\ngs = g0 + (1 + \\dfrac{g1}{\\sqrt{VPD}} ⋅ \\dfrac{A}{Ca}\n\nFields\n\ng0\nminimal stomatal conductance g0 [mol m⁻² s⁻¹]\ng1\nslope of conductance-photosynthesis correlation [Pa⁽⁵⁾]\n\n\n\n\n\n","category":"type"},{"location":"pages/Photosynthesis/#Optimization-Stomtal-Model-1","page":"Photosynthesis","title":"Optimization Stomtal Model","text":"","category":"section"},{"location":"pages/Photosynthesis/#","page":"Photosynthesis","title":"Photosynthesis","text":"Land.Photosynthesis.OSMEller\nLand.Photosynthesis.OSMSperry\nLand.Photosynthesis.OSMWang\nLand.Photosynthesis.OSMWAP\nLand.Photosynthesis.OSMWAPMod","category":"page"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.OSMEller","page":"Photosynthesis","title":"Land.Photosynthesis.OSMEller","text":"struct OSMEller\n\nAn optimization model parameter set type for Eller model. The equation used for Eller model is\n\ndfracΘE = -dfracKE  dfracAK\n\nwhere K is dfracEP.\n\nFields\n\n\n\n\n\n","category":"type"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.OSMSperry","page":"Photosynthesis","title":"Land.Photosynthesis.OSMSperry","text":"struct OSMSperry\n\nAn optimization model parameter set type for Sperry model. The equation used for Sperry model is\n\ndfracΘE = -dfracKE  dfracA_maxK_max\n\nwhere K is dfracEP.\n\nFields\n\n\n\n\n\n","category":"type"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.OSMWang","page":"Photosynthesis","title":"Land.Photosynthesis.OSMWang","text":"struct OSMWang\n\nAn optimization model parameter set type for Eller type model. The equation used for Wang model is\n\ndfracΘE = dfracAE_crit - E\n\nFields\n\n\n\n\n\n","category":"type"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.OSMWAP","page":"Photosynthesis","title":"Land.Photosynthesis.OSMWAP","text":"struct OSMWAP{FT}\n\nAn optimization model parameter set type for Wolf-Anderegg-Pacala type model. The equation used for Wolf-Anderegg-Pacala model is\n\ndfracΘE = dfrac2aP + bK\n\nwhere K is ∂P/∂E.\n\nFields\n\na\nQuadratic equation parameter [μmol m⁻² s⁻¹ MPa⁻²]\nb\nQuadratic equation parameter [μmol m⁻² s⁻¹ MPa⁻¹]\n\n\n\n\n\n","category":"type"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.OSMWAPMod","page":"Photosynthesis","title":"Land.Photosynthesis.OSMWAPMod","text":"struct OSMWAPMod{FT}\n\nAn optimization model parameter set type for Wolf-Anderegg-Pacala type model,     modified by adding a photosynthesis component while set b and c = 0. The equation used for modified Wolf-Anderegg-Pacala model is\n\ndfracΘE = dfracaAPK\n\nwhere P is absolute value of leaf xylem pressure.\n\nFields\n\na\nQuadratic equation parameter [mol mol⁻¹ MPa⁻¹]\n\n\n\n\n\n","category":"type"},{"location":"pages/Photosynthesis/#Parameter-Sets-Collection-1","page":"Photosynthesis","title":"Parameter Sets Collection","text":"","category":"section"},{"location":"pages/Photosynthesis/#Types-3","page":"Photosynthesis","title":"Types","text":"","category":"section"},{"location":"pages/Photosynthesis/#","page":"Photosynthesis","title":"Photosynthesis","text":"Land.Photosynthesis.AbstractPhotoModelParaSet\nLand.Photosynthesis.C3ParaSet\nLand.Photosynthesis.C4ParaSet","category":"page"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.AbstractPhotoModelParaSet","page":"Photosynthesis","title":"Land.Photosynthesis.AbstractPhotoModelParaSet","text":"type AbstractPhotoModelParaSet\n\nHierarchy of the AbstractPhotoModelParaSet:\n\nC3ParaSet\nC4ParaSet\n\n\n\n\n\n","category":"type"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.C3ParaSet","page":"Photosynthesis","title":"Land.Photosynthesis.C3ParaSet","text":"struct C3Paraset{FT}\n\nParameter sets for C3 photosynthesis.\n\nFields\n\nJT\nJmax temperature dependency\nKcT\nKc temperature dependency\nKoT\nKo temperature dependency\nReT\nRespiration temperature dependency\nVcT\nVcmax temperature dependency\nΓsT\nΓ_star temperature dependency\nCol\nColimitation mode\nFlu\nFluorescence model\nSto\nStomatal model scheme\nVR\nVcmax25 and respiration correlation\nEff_1\nCoefficient 4.0/4.5 for NADPH/ATP requirement stochiometry, respectively\nEff_2\nCoefficient 8.0/10.5 for NADPH/ATP requirement stochiometry, respectively\n\n\n\n\n\n","category":"type"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.C4ParaSet","page":"Photosynthesis","title":"Land.Photosynthesis.C4ParaSet","text":"struct C4ParaSet{FT}\n\nParameter sets for C3 photosynthesis.\n\nFields\n\nKpT\nKpep temperature dependency\nReT\nRespiration temperature dependency\nVcT\nVcmax temperature dependency\nVpT\nVpmax temperature dependency\nCol\nColimitation mode\nFlu\nFluorescence model\nSto\nStomatal model scheme\nVR\nVcmax25 and respiration correlation\n\n\n\n\n\n","category":"type"},{"location":"pages/Photosynthesis/#Parameter-sets-3","page":"Photosynthesis","title":"Parameter sets","text":"","category":"section"},{"location":"pages/Photosynthesis/#","page":"Photosynthesis","title":"Photosynthesis","text":"Land.Photosynthesis.C3Bernacchi\nLand.Photosynthesis.C3CLM\nLand.Photosynthesis.C4CLM","category":"page"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.C3Bernacchi","page":"Photosynthesis","title":"Land.Photosynthesis.C3Bernacchi","text":"C3ParaSet type C3 photosynthesis using Bernacchi's data \n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.C3CLM","page":"Photosynthesis","title":"Land.Photosynthesis.C3CLM","text":"C3ParaSet type C3 photosynthesis using CLM5's data \n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.C4CLM","page":"Photosynthesis","title":"Land.Photosynthesis.C4CLM","text":"C4ParaSet type C4 photosynthesis using CLM5's data \n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Leaf-and-Environment-1","page":"Photosynthesis","title":"Leaf and Environment","text":"","category":"section"},{"location":"pages/Photosynthesis/#","page":"Photosynthesis","title":"Photosynthesis","text":"Land.Photosynthesis.Leaf\nLand.Photosynthesis.AirLayer","category":"page"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.Leaf","page":"Photosynthesis","title":"Land.Photosynthesis.Leaf","text":"struct Leaf{FT}\n\nStruct to store leaf information.\n\nFields\n\nH\nSensible Heat Flux [W m⁻²]\nLE\nLatent Heat Flux [W m⁻²]\nLV\nLatent Heat of evaporation [J mol⁻¹]\nRn\nNet Radiation Balance [W m⁻²]\nT\nTemperature [K]\nT_old\nOld temperature [K]\nwidth\nLeaf width [m]\nKd\nRate constant for thermal dissipation\nKf\nRate constant for fluorescence (const)\nKn\nNPQ rate constant (initially zero)\nKp\nRate constant for photochemistry (all reaction centers open)\nmaxPSII\nmax PSII yield (Kn=0, all RC open)\nPSII_frac\nFraction of absorbed light used by PSII ETR\ng_bc\nBoundary layer conductance to CO₂ [mol m⁻² s⁻¹]\ng_bh\nBoundary layer conductance to heat [mol m⁻² s⁻¹]\ng_bw\nBoundary layer conductance to H₂O [mol m⁻² s⁻¹]\ng_ias_c\nGias correction constant\ng_ias_e\nGias correction exponent\ng_lc\nLeaf diffusive conductance to water CO₂ [mol m⁻² s⁻¹]\ng_lw\nLeaf diffusive conductance to water H₂O [mol m⁻² s⁻¹]\ng_m\nMesophyll conductance for CO₂ [mol m⁻² s⁻¹]\ng_max\nMaximal leaf diffusive conductance [mol m⁻² s⁻¹]\ng_max25\nMaximal leaf diffusive conductance at 298.15 K [mol m⁻² s⁻¹]\ng_min\nMinimal leaf diffusive conductance [mol m⁻² s⁻¹]\ng_min25\nMinimal leaf diffusive conductance at 298.15 K [mol m⁻² s⁻¹]\ng_sc\nStomatal conductance to water CO₂ [mol m⁻² s⁻¹]\ng_sw\nStomatal conductance to water H₂O [mol m⁻² s⁻¹]\np_i\nLeaf internal CO₂ partial pressure [Pa]\np_s\nLeaf surface CO₂ partial pressure [Pa]\np_sat\nLeaf saturation vapor pressure [Pa]\nAc\nRubisCO limited photosynthetic rate [μmol m⁻² s⁻¹]\nAj\nLight limited photosynthetic rate [μmol m⁻² s⁻¹]\nAg\nGross photosynthetic rate [μmol m⁻² s⁻¹]\nAn\nNet photosynthetic rate [μmol m⁻² s⁻¹]\nAp\nProduct limited photosynthetic rate [μmol m⁻² s⁻¹]\nJ\nElectron transport [μmol m⁻² s⁻¹]\nJ_pot\nPotential Electron Transport Rate [μmol m⁻² s⁻¹]\nJmax\nMaximal electron transport rate [μmol m⁻² s⁻¹]\nJmax25\nMaximal electron transport rate at 298.15 K [μmol m⁻² s⁻¹]\nKc\nRubisCO coefficient Kc [Pa]\nKo\nRubisCO coefficient Ko [Pa]\nKpep\nPEP coefficient Ko [Pa]\nKm\nMichaelis-Menten's coefficient [Pa]\nRd\nRespiration rate [μmol m⁻² s⁻¹]\nRd25\nRespiration rate at 298.15 K [μmol m⁻² s⁻¹]\nVcmax\nMaximal carboxylation rate [μmol m⁻² s⁻¹]\nVcmax25\nMaximal carboxylation rate at 298.15 K [μmol m⁻² s⁻¹]\nVpmax\nMaximal PEP carboxylation rate [μmol m⁻² s⁻¹]\nVpmax25\nMaximal PEP carboxylation rate at 298.15 K [μmol m⁻² s⁻¹]\nΓ_star\nCO₂ compensation point with the absence of Rd [Pa]\nCO₂_per_electron\nTotal efficiency, incl. photorespiration [mol CO₂ mol⁻¹ e-]\nFm\ndark adapted yield (Kp=0)\nFm′\nlight adapted yield (Kp=0)\nFo\ndark-adapted fluorescence yield (Kp=max)\nFo′\nlight-adapted fluorescence yield in the dark (Kp=max)\nJa\nActual electron transport rate [μmol m⁻² s⁻¹]\nNPQ\nNon-Photochemical quenching\nqQ\nPhotochemical quenching\nqE\nenergy quenching\nφ\nPSII yield\nϕs\nSteady-state (light-adapted) yield (aka Fs)\nAPAR\nAbsorbed photosynthetic active radiation [μmol m⁻² s⁻¹]\nhs\nLeaf hydraulic system\na_max\nMaximal photosynthetic rate [μmol m⁻² s⁻¹]\ne\nFlow rate [mol m⁻² s⁻¹]\nec\nCritical flow rate [mol m⁻² s⁻¹]\nkr_max\nMaximal hydraulic conductance ratio\np_ups\nBase xylem pressre [MPa]\np_old\nBase xylem pressre memory [MPa]\n\n\n\n\n\n","category":"type"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.AirLayer","page":"Photosynthesis","title":"Land.Photosynthesis.AirLayer","text":"struct AirLayer{FT}\n\nStruct to store environmental conditions in each air layer corresponds to one     canopy layer.\n\nFields\n\nt_air\nAir temperature [K]\np_a\nAtmospheric CO₂ partial pressure [Pa]\np_atm\nAtmospheric pressure [Pa]\np_H₂O\nAtmospheric vapor pressure [Pa]\np_O₂\nAtmospheric O₂ partial pressure [Pa]\np_sat\nSaturation vapor pressure [Pa]\nRH\nRelatiev humidity\n\n\n\n\n\n","category":"type"},{"location":"pages/Photosynthesis/#Photosynthesis-Model-1","page":"Photosynthesis","title":"Photosynthesis Model","text":"","category":"section"},{"location":"pages/Photosynthesis/#Temperature-corrections-1","page":"Photosynthesis","title":"Temperature corrections","text":"","category":"section"},{"location":"pages/Photosynthesis/#","page":"Photosynthesis","title":"Photosynthesis","text":"Land.Photosynthesis.arrhenius_correction\nLand.Photosynthesis.photo_TD_from_set\nLand.Photosynthesis.photo_TD_from_val\nLand.Photosynthesis.leaf_jmax!\nLand.Photosynthesis.leaf_kc!\nLand.Photosynthesis.leaf_km!\nLand.Photosynthesis.leaf_ko!\nLand.Photosynthesis.leaf_kpep!\nLand.Photosynthesis.leaf_rd!\nLand.Photosynthesis.leaf_vcmax!\nLand.Photosynthesis.leaf_vpmax!\nLand.Photosynthesis.leaf_Γstar!","category":"page"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.arrhenius_correction","page":"Photosynthesis","title":"Land.Photosynthesis.arrhenius_correction","text":"arrhenius_correction(td_set::AbstractTDParameterSet{FT}, T::FT)\n\nA correction factor based on arrhenius's fitting procedure, given\n\ntd_set ArrheniusTD or ArrheniusPeakTD type struct\nT Leaf temperature in [K]\n\nThe equation used for ArrheniusTD is\n\ncorr = exp left( dfracΔHaR T_0 - dfracΔHaR T_1 right)\n\nThe equations used for ArrheniusPeakTD are\n\ncorr = exp left( dfracΔHaR T_0 - dfracΔHaR T_1 right)\n       cdot\n       dfrac 1 + exp left( dfracS_v T_0 - H_dR T_0 right) \n               1 + exp left( dfracS_v T_1 - H_dR T_1 right) \n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.photo_TD_from_set","page":"Photosynthesis","title":"Land.Photosynthesis.photo_TD_from_set","text":"photo_TD_from_set(td_set::ArrheniusTD{FT}, T::FT)\n\nMake temperature correction from parameter set, given\n\ntd_set ArrheniusTD type parameter set, which has a VAL_25 field\nT Leaf temperature\n\nUseful for Kc, Ko, Kpep, and Γ^*.\n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.photo_TD_from_val","page":"Photosynthesis","title":"Land.Photosynthesis.photo_TD_from_val","text":"photo_TD_from_val(td_set::AbstractTDParameterSet, val::FT, T::FT)\n\nMake temperature correction from a given value, given\n\ntd_set ArrheniusTD or ArrheniusPeakTD type struct\nval Uncorrected value at 298.15 K\nT Leaf temperature\n\nUseful for Vcmax, Vomac, Vpmax, Jmax, and Respiration.\n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.leaf_jmax!","page":"Photosynthesis","title":"Land.Photosynthesis.leaf_jmax!","text":"leaf_jmax!(td_set::AbstractTDParameterSet, leaf::Leaf{FT})\n\nUpdate maximal electron transport rate at leaf temperature, given\n\ntd_set AbstractTDParameterSet type TD parameter set\nleaf Leaf type struct\n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.leaf_kc!","page":"Photosynthesis","title":"Land.Photosynthesis.leaf_kc!","text":"leaf_kc!(td_set::ArrheniusTD{FT}, leaf::Leaf{FT})\n\nUpdate Kc at leaf temperature, given\n\ntd_set ArrheniusTD type TD parameter set\nleaf Leaf type struct\n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.leaf_km!","page":"Photosynthesis","title":"Land.Photosynthesis.leaf_km!","text":"leaf_km!(photo_set::C3ParaSet{FT}, leaf::Leaf{FT}, envir::AirLayer{FT})\n\nUpdate Ko at leaf temperature, given\n\nphoto_set C3ParaSet type photosynthesis parameter set\nleaf Leaf type struct\nenvir AirLayer type struct\n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.leaf_ko!","page":"Photosynthesis","title":"Land.Photosynthesis.leaf_ko!","text":"leaf_ko!(td_set::ArrheniusTD{FT}, leaf::Leaf{FT})\n\nUpdate Ko at leaf temperature, given\n\ntd_set ArrheniusTD type TD parameter set\nleaf Leaf type struct\n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.leaf_kpep!","page":"Photosynthesis","title":"Land.Photosynthesis.leaf_kpep!","text":"leaf_kpep!(td_set::ArrheniusTD{FT}, leaf::Leaf{FT})\n\nUpdate Kpep at leaf temperature, given\n\ntd_set ArrheniusTD type TD parameter set\nleaf Leaf type struct\n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.leaf_rd!","page":"Photosynthesis","title":"Land.Photosynthesis.leaf_rd!","text":"leaf_rd!(td_set::AbstractTDParameterSet, leaf::Leaf)\n\nUpdate leaf dark respiration rate at leaf temperature, given\n\ntd_set AbstractTDParameterSet type TD parameter set\nleaf Leaf type struct\n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.leaf_vcmax!","page":"Photosynthesis","title":"Land.Photosynthesis.leaf_vcmax!","text":"leaf_vcmax!(td_set::AbstractTDParameterSet, leaf::Leaf)\n\nUpdate leaf maximal carboxylation rate at leaf temperature, given\n\ntd_set AbstractTDParameterSet type TD parameter set\nleaf Leaf type struct\n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.leaf_vpmax!","page":"Photosynthesis","title":"Land.Photosynthesis.leaf_vpmax!","text":"leaf_vpmax!(td_set::AbstractTDParameterSet, leaf::Leaf)\n\nUpdate leaf maximal PEP carboxylation rate at leaf temperature, given\n\ntd_set AbstractTDParameterSet type TD parameter set\nleaf Leaf type struct\n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.leaf_Γstar!","page":"Photosynthesis","title":"Land.Photosynthesis.leaf_Γstar!","text":"leaf_Γstar!(td_set::ArrheniusTD{FT}, leaf::Leaf{FT})\n\nUpdate Γ^* at leaf temperature, given\n\ntd_set ArrheniusTD type TD parameter set\nleaf Leaf type struct\n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Photosynthetic-rates-(individual)-1","page":"Photosynthesis","title":"Photosynthetic rates (individual)","text":"","category":"section"},{"location":"pages/Photosynthesis/#","page":"Photosynthesis","title":"Photosynthesis","text":"Land.Photosynthesis.rubisco_limited_rate!\nLand.Photosynthesis.rubisco_limited_rate_glc!\nLand.Photosynthesis.leaf_ETR!\nLand.Photosynthesis.light_limited_rate!\nLand.Photosynthesis.light_limited_rate_glc!\nLand.Photosynthesis.product_limited_rate!\nLand.Photosynthesis.product_limited_rate_glc!\nLand.Photosynthesis.photosynthesis_colimit\nLand.Photosynthesis.leaf_fluorescence!","category":"page"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.rubisco_limited_rate!","page":"Photosynthesis","title":"Land.Photosynthesis.rubisco_limited_rate!","text":"rubisco_limited_rate!(photo_set::C3ParaSet{FT}, leaf::Leaf{FT})\nrubisco_limited_rate!(photo_set::C4ParaSet{FT}, leaf::Leaf{FT})\n\nCalculate the RubisCO limited photosynthetic rate, given\n\nphoto_set C3ParaSet or C4ParaSet type struct\nleaf Leaf type struct\n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.rubisco_limited_rate_glc!","page":"Photosynthesis","title":"Land.Photosynthesis.rubisco_limited_rate_glc!","text":"rubisco_limited_rate_glc!(\n        photo_set::AbstractPhotoModelParaSet,\n        leaf::Leaf{FT},\n        envir::AirLayer{FT})\n\nCalculate the RubisCO limited photosynthetic rate from glc, given\n\nphoto_set C3ParaSet or C4ParaSet type struct\nleaf Leaf type struct\nenvir AirLayer type struct\n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.leaf_ETR!","page":"Photosynthesis","title":"Land.Photosynthesis.leaf_ETR!","text":"leaf_ETR!(photo_set::C3ParaSet{FT}, leaf::Leaf{FT})\nleaf_ETR!(photo_set::C4ParaSet{FT}, leaf::Leaf{FT})\n\nUpdate the electron transport variables in the leaf struct, given\n\nphoto_set C3ParaSet or C4ParaSet type struct\nleaf Leaf type struct\n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.light_limited_rate!","page":"Photosynthesis","title":"Land.Photosynthesis.light_limited_rate!","text":"light_limited_rate!(photo_set::C3ParaSet{FT}, leaf::Leaf{FT})\nlight_limited_rate!(photo_set::C4ParaSet{FT}, leaf::Leaf{FT})\n\nCalculate the Light limited photosynthetic rate, given\n\nphoto_set C3ParaSet or C4ParaSet type struct\nleaf Leaf type struct\n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.light_limited_rate_glc!","page":"Photosynthesis","title":"Land.Photosynthesis.light_limited_rate_glc!","text":"light_limited_rate_glc!(\n        photo_set::AbstractPhotoModelParaSet,\n        leaf::Leaf{FT},\n        envir::AirLayer{FT})\n\nCalculate the Light limited photosynthetic rate from glc, given\n\nphoto_set C3ParaSet or C4ParaSet type struct\nleaf Leaf type struct\nenvir AirLayer type struct\n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.product_limited_rate!","page":"Photosynthesis","title":"Land.Photosynthesis.product_limited_rate!","text":"product_limited_rate!(photo_set::C3ParaSet{FT}, leaf::Leaf{FT})\nproduct_limited_rate!(photo_set::C4ParaSet{FT}, leaf::Leaf{FT})\n\nCalculate the Product limited photosynthetic rate, given\n\nphoto_set C3ParaSet or C4ParaSet type struct\nleaf Leaf type struct\n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.product_limited_rate_glc!","page":"Photosynthesis","title":"Land.Photosynthesis.product_limited_rate_glc!","text":"product_limited_rate_glc!(\n        photo_set::AbstractPhotoModelParaSet,\n        leaf::Leaf{FT},\n        envir::AirLayer{FT})\n\nCalculate the Product limited photosynthetic rate from glc, given\n\nphoto_set C3ParaSet or C4ParaSet type struct\nleaf Leaf type struct\nenvir AirLayer type struct\n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.leaf_fluorescence!","page":"Photosynthesis","title":"Land.Photosynthesis.leaf_fluorescence!","text":"leaf_fluorescence!(fluo_set::FluoParaSet{FT}, leaf::Leaf{FT})\n\nCompute fluorescence yield, Kn, and Kp for leaf, given\n\nfluo_set FluoParaSet type parameter set\nleaf Leaf struct\n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Photosynthetic-rates-1","page":"Photosynthesis","title":"Photosynthetic rates","text":"","category":"section"},{"location":"pages/Photosynthesis/#","page":"Photosynthesis","title":"Photosynthesis","text":"Land.Photosynthesis.leaf_temperature_dependence!\nLand.Photosynthesis.leaf_photo_from_pi!\nLand.Photosynthesis.leaf_photo_from_glc!","category":"page"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.leaf_temperature_dependence!","page":"Photosynthesis","title":"Land.Photosynthesis.leaf_temperature_dependence!","text":"leaf_temperature_dependence!(\n        photo_set::AbstractPhotoModelParaSet,\n        leaf::AbstractLeaf,\n        envir::AirLayer{FT})\n\nUpdate the temperature dependent photosynthesis only, given\n\nphoto_set AbstractPhotoModelParaSet type parameter set\nleaf Leaf type struct\nenvir AirLayer type struct\n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.leaf_photo_from_pi!","page":"Photosynthesis","title":"Land.Photosynthesis.leaf_photo_from_pi!","text":"leaf_photo_from_pi!(\n        photo_set::AbstractPhotoModelParaSet,\n        leaf::AbstractLeaf,\n        envir::AirLayer{FT})\n\nCompute leaf photosynthetic rates, given\n\nphoto_set AbstractPhotoModelParaSet type parameter set\nleaf Leaf type struct\nenvir AirLayer type struct\n\nThe C3 photosynthesis model is from Farquhar et al. (1980) \"A biochemical model     of photosynthetic CO₂ assimilation in leaves of C3 species.\"\n\nThe C4 photosynthesis model is adapted from Collatz et al. (1992) \"Coupled     photosynthesis-stomatal conductance model for leaves of C4 plants.\"\n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.leaf_photo_from_glc!","page":"Photosynthesis","title":"Land.Photosynthesis.leaf_photo_from_glc!","text":"leaf_photo_from_glc!(\n        photo_set::AbstractPhotoModelParaSet,\n        leaf::Leaf{FT},\n        envir::AirLayer{FT})\n\nUpdate leaf photosynthetic rates from a known leaf diffusive conductance, given\n\nphoto_set AbstractPhotoModelParaSet type parameter set\nleaf Leaf type struct\nenvir AirLayer type struct\n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Stomatal-Response-to-Environment-1","page":"Photosynthesis","title":"Stomatal Response to Environment","text":"","category":"section"},{"location":"pages/Photosynthesis/#","page":"Photosynthesis","title":"Photosynthesis","text":"Land.Photosynthesis.empirical_gsw_from_model\nLand.Photosynthesis.envir_diff!\nLand.Photosynthesis.leaf_photo_from_envir!\nLand.Photosynthesis.leaf_gsw_control!\nLand.Photosynthesis.leaf_heat_flux!","category":"page"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.empirical_gsw_from_model","page":"Photosynthesis","title":"Land.Photosynthesis.empirical_gsw_from_model","text":"empirical_gsw_from_model(\n        model::EmpiricalStomatalModel,\n        leaf::Leaf{FT},\n        envir::AirLayer{FT},\n        β::FT)\n\nSteady state gsw from empirical approach given\n\nmodel EmpiricalStomatalModel type empirical model parameter set\nleaf Leaf type struct\nenvir AirLayer type struct\nβ Correction factor over the g1 part of an empirical model\n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.envir_diff!","page":"Photosynthesis","title":"Land.Photosynthesis.envir_diff!","text":"envir_diff!(\n        x::FT,\n        photo_set::AbstractPhotoModelParaSet,\n        leaf::Leaf{FT},\n        envir::AirLayer{FT},\n        sm::AbstractStomatalModel)\n\nCalculate the difference to be minimized for a given\n\nx Assumed leaf diffusive conductance\nphoto_setC3ParaSet or C4ParaSet type parameter set\nleafLeaf type struct\nenvirAirLayer type struct\nsm Stomatal model option (photo_set.Sto)\n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.leaf_photo_from_envir!","page":"Photosynthesis","title":"Land.Photosynthesis.leaf_photo_from_envir!","text":"leaf_photo_from_envir!(\n        photo_set::AbstractPhotoModelParaSet,\n        leaf::Leaf{FT},\n        envir::AirLayer{FT},\n        sm::AbstractStomatalModel)\n\nCalculate steady state gsw and photosynthesis from empirical approach, given\n\nphoto_set C3ParaSet or C4ParaSet type parameter set\nleaf Leaf type struct\nenvir AirLayer type struct\nsm EmpiricalStomatalModel or OptimizationStomatalModel\n\nNote that sm is stored in photo_set.Sto\n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.leaf_gsw_control!","page":"Photosynthesis","title":"Land.Photosynthesis.leaf_gsw_control!","text":"leaf_gsw_control!(\n        photo_set::AbstractPhotoModelParaSet,\n        leaf::Leaf{FT},\n        envir::AirLayer{FT})\n\nmake sure g_sw is in its physiological range limited by diffusion, given\n\nphoto_set C3ParaSet or C4ParaSet type parameter set\nleaf Leaf type struct\nenvir AirLayer type struct\n\n\n\n\n\n","category":"function"},{"location":"pages/Photosynthesis/#Land.Photosynthesis.leaf_heat_flux!","page":"Photosynthesis","title":"Land.Photosynthesis.leaf_heat_flux!","text":"leaf_heat_flux!(leaf::Leaf{FT}, envir::AirLayer{FT})\n\nUpdate leaf sensible and latent fluexes, given\n\nleaf Leaf type struct\nenvir AirLayer type struct\n\nThe sensible heat flux is computed using\n\nH = 2  ρ  c_p  g_b  (T - T_air)\n\nwhere 2 describes the two-sided leaf, ρ is the density of dry air (ρ = dfracp_atm  M_dryairR  T_air, M_dryair is the molar mass of dry air and R is the gas constant), c_p is heat capacity of dry air at constant pressure, g_b is the leaf boundary layer conductance for heat transfer in [m s⁻¹] ([mol m⁻² s⁻¹] times dfracRT_airP_atm gives [m s⁻¹] ), T is leaf temperature, and T_air is air temperature. Thus, the formulation is simplified to\n\nH = 2  c_p  g_bw  (T - T_air)  M_dryair\n\nThe latent heat flux is computed using\n\nLE = LV  E\n\nwhere LV is specific latent heat of evporation in [J mol⁻¹], and E is evaporation rate in [mol m⁻² s⁻¹].\n\n\n\n\n\n","category":"function"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"EditURL = \"https://github.com/CliMA/Land/blob/master/docs/src/tutorial_scripts/Leaf-Photosynthesis-Synthesis.jl\"","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#Leaf-Level-Photosynthesis-1","page":"Leaf Photosynthetic rates","title":"Leaf Level Photosynthesis","text":"","category":"section"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"Here, we will go one step further and look at the entire leaf-level response, including the impact of stomatal conductance as well.","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#Stomatal-Conductance-1","page":"Leaf Photosynthetic rates","title":"Stomatal Conductance","text":"","category":"section"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"Before, we focussed mainly on the demand-driven constraints through Rubisco and RuBP regeneration. Stomatal conductance is highly important as it drives the suppy-side of photosynthesis and interacts with the energy balance and leaf temperature as latent heat fluxes are a major factor in surface cooling.","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"Before, we have derived net rates of photosynthesis A_n, which have to be matched with the supply side through CO_2 diffusion:","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"A_n^diff = g_leafC(C_a-C_c)","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"which can be separated into diffusion from the air to the leaf surface with a boundary layer conductance g_bC, diffusion from the surface to the interstitial air-space with stomatal conductance g_sC and diffusion from the  interstitial air-space to the chloroplast with mesophyll conductance g_mC (the letter C stands for CO2 here, as the diffusion constants vary with species, e.g. H_2O stomatal conductance is a factor 1.6 higher than those for CO_2):","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"A_n^diff = g_bC(C_a-C_s) = g_sC(C_s-C_i) = g_mC(C_i-C_c) = g_leafC(C_a-C_c)","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"g_leafC = left(frac1g_bC+g_sC+g_mCright)^-1","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"The importance of stomatal conductance and its interplay with photosynthesis here is that the supply and demand rates determine C_c. A reduction in C_c reduces the demand-limited rates while it increase the diffusion rates (at a given g). Most models run internal so-called A-C_c iterations to ensure both rates are balanced and in steady-state (partial C_cpartial t=0). We implement this option but also opt to run stomatal conductance prognostically, as stomata don't open and close instantanously but have a response time of around 15 minutes.","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#Empirical-Stomatal-Conductance-models-1","page":"Leaf Photosynthetic rates","title":"Empirical Stomatal Conductance models","text":"","category":"section"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"Currently, we can choose between the widely used Ball-Berry model[1] or the Medlyn approach[2].","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"Ball and Berry derived the following empirical formulation based on leaf level data (RH is relative humidity):","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"g_sw = g_0 + g_1  fracA_n cdot RHC_s","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"Medlyn derived the following equations based on stomatal optimization theory but in a similar form as the BB model:","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"g_sw = g_0 + left(1 + fracg_1sqrtVPDright) fracA_nC_s","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"Both models are proportional to A_n and inversely proportional to C_s, with the main difference in the dependence on either relative humidity in the Ball-Berry model vs. vapor pressure deficit (VPD) in Medlyn et al. In both cases, g_0 is the residual conductivity even if stomata are fully closed and g_1 is related to the marginal water cost of plant carbon gain. Importantly, g_1 can't be inter-changed between the formulations, underlining again that parameters have to be optimized with respect to the model that is eventually being used.","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#Stomatal-Optimization-Theories-1","page":"Leaf Photosynthetic rates","title":"Stomatal Optimization Theories","text":"","category":"section"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"The empirical formulations only hold in well-watered soil and our main goal is to implement stomatal optimization models to take the entire soil-plant-atmosphere continuum into account[3]. Here, we will just use the empirical models and steady-state photosynthesis to show the underlying principles.","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"[1]: Ball, J.T., Woodrow, I.E. and Berry, J.A., 1987. A model predicting stomatal conductance and its contribution to the control of photosynthesis under different environmental conditions. In Progress in photosynthesis research (pp. 221-224). Springer, Dordrecht.","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"[2]: Medlyn, B.E., Duursma, R.A., Eamus, D., Ellsworth, D.S., Prentice, I.C., Barton, C.V., Crous, K.Y., De Angelis, P., Freeman, M. and Wingate, L., 2011. Reconciling the optimal and empirical approaches to modelling stomatal conductance. Global Change Biology, 17(6), pp.2134-2144.","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"[3]: Wang, Y., Sperry, J.S., Anderegg, W.R., Venturas, M.D. and Trugman, A.T., 2020. A theoretical and empirical assessment of stomatal optimization modeling. New Phytologist.","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"# Add usual tools we use:\n##using Revise\nusing BenchmarkTools\nusing PyPlot","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"# load Photosynthesis module:\nusing Land.Photosynthesis","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"# Specify Field Type\nconst FT = Float64","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"# Create a standard leaf with defualt parameters\nleaf3 = Leaf{FT}(APAR=1200, Vcmax25=90, Jmax25=90*1.9, Vpmax25=100, Rd25=1);\nleaf4 = Leaf{FT}(APAR=1200, Vcmax25=90, Jmax25=90*1.9, Vpmax25=100, Rd25=1);\n# Create a standard meteo structure:\nenvir  = AirLayer{FT}();\nnothing #hide","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"# Setting some standard values (dynamic-state=false forces A-Cc iterations)\n##leaf.dynamic_state = false","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#Modular-stucture:-1","page":"Leaf Photosynthetic rates","title":"Modular stucture:","text":"","category":"section"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"The most important step is to define which submodules to use. There might be different implementations for Fluorescence, Photosynthesis (C3,C4,etc), respiration, stomatal conductance (e.g. Ball-Berry, Medlyn), the T-dependence of J_max, V_cmax and Michaelis Menten constants as well as leaf boundary layer resistance (setting it to 0 here to mimic well vented laboratory leaf level measurements) and colimitation.","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"Below, we create two different model setups with a C3 and C4 photosynthesis pathway. Note that we chose the Ball Berry stomatal conductance model with different g_1 for C3 and C4 (C4 typically much lower).","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"# use this as the boundary layer resistance (1/gb)\n# deprecated as there are g_bw and g_bc terms in Leaf struct\n# ra = FT(0.5)\n\n# C3 Photosynthesis","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"Use pre-defined parameter sets","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"modC3 = C3CLM(FT)\nmodC3.Col = Photosynthesis.CurvedColimit{FT}();\nmodC3.Sto = Photosynthesis.ESMBallBerry{FT}(g1 = 16)\n\n# C4 Photosynthesis\nmodC4 = C4CLM(FT)\nmodC4.Col = Photosynthesis.CurvedColimit{FT}();\nmodC4.Sto = Photosynthesis.ESMBallBerry{FT}(g1 = 8)","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#Light-response-curves-1","page":"Leaf Photosynthetic rates","title":"Light response curves","text":"","category":"section"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"Now we can compute light response curves for C3 and C4 photosynthesis","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"##Again, this looks tedious and repetitive but is the easiest way to do this right now:\n\n# Variable I want to save:\nAg_C3 = Float32[]; Ag_C4 = Float32[];\nAn_C3 = Float32[]; An_C4 = Float32[];\nAj_C3 = Float32[]; Aj_C4 = Float32[];\nAp_C3 = Float32[]; Ap_C4 = Float32[];\nAc_C3 = Float32[]; Ac_C4 = Float32[];\nCc_C3 = Float32[]; Cc_C4 = Float32[];\ngs_C3 = Float32[]; gs_C4 = Float32[];\n\nAPAR = collect(FT, 0:10:1700)\nfor _APAR in APAR\n    leaf3.APAR = _APAR;\n    leaf4.APAR = _APAR;\n    # Run C3 photosynthesis (general photosynthesis model):\n    leaf_photo_from_envir!(modC3, leaf3, envir, modC3.Sto);\n    # Save leaf variables:\n    push!(An_C3, leaf3.An); push!(Ag_C3, leaf3.Ag);\n    push!(Aj_C3, leaf3.Aj); push!(Ap_C3, leaf3.Ap);\n    push!(Ac_C3, leaf3.Ac); push!(Cc_C3, leaf3.p_i);\n    push!(gs_C3, leaf3.g_sw);\n\n    # Run C4 photosynthesis:\n    leaf_photo_from_envir!(modC4, leaf4, envir, modC4.Sto);\n    # Save leaf variables:\n    push!(An_C4, leaf4.An); push!(Ag_C4, leaf4.Ag);\n    push!(Aj_C4, leaf4.Aj); push!(Ap_C4, leaf4.Ap);\n    push!(Ac_C4, leaf4.Ac); push!(Cc_C4, leaf4.p_i);\n    push!(gs_C4, leaf4.g_sw);\nend","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"# Testing some times, how long does this take (as we need to run it globally, it has to be efficient)?\n# Slow for now, because of unnecessary allocations\n# Will improve when the structs are cleaned up\n#@btime leaf_photo_from_envir!(modC3, leaf3, envir, modC3.Sto);\n#@btime leaf_photo_from_envir!(modC4, leaf4, envir, modC4.Sto);\nnothing #hide","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#C3-Light-Response-Curve-1","page":"Leaf Photosynthetic rates","title":"C3 Light Response Curve","text":"","category":"section"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"##plot(APAR, An,  label=\"An\")\nfigure()\nplot(APAR, Ag_C3,color=:black,lw=2, alpha=0.7, label=\"Ag C3\")\nplot(APAR, Ac_C3, ls=\"--\", lw=2, label=\"Ac C3\")\nplot(APAR, Aj_C3, ls=\"--\", lw=2, label=\"Aj C3\")\nplot(APAR, Ap_C3, ls=\"--\", lw=2, label=\"Ap C3\" )\nxlabel(\"APAR [μmol/m2/s]\")\nylabel(\"Aᵢ [μmol/m2/s]\")\ntitle(\"C3 photosynthesis light response\")\nlegend()\ngcf()","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#C4-Light-Response-Curve-1","page":"Leaf Photosynthetic rates","title":"C4 Light Response Curve","text":"","category":"section"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"##plot(APAR, An,  label=\"An\")\nfigure()\nplot(APAR, Ag_C4,color=:black, lw=2, alpha=0.7, label=\"Ag C4\")\nplot(APAR, Ac_C4, ls=\"--\", lw=2, label=\"Ac C4\")\nplot(APAR, Aj_C4, ls=\"--\", lw=2, label=\"Aj C4\")\nplot(APAR, Ap_C4, ls=\"--\", lw=2, label=\"Ap C4\" )\nxlabel(\"APAR [μmol/m2/s]\")\nylabel(\"Aᵢ [μmol/m2/s]\")\ntitle(\"C4 photosynthesis light response\")\nlegend()\ngcf()","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#Dependence-of-C_c-on-light-1","page":"Leaf Photosynthetic rates","title":"Dependence of C_c on light","text":"","category":"section"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"Increasing light should result in overall lower C_c concentrations. C4 plants can work with much lower C_c as for C4, the concentration in the bundle sheath cells count, not the mesophyll.","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"figure()\nplot(APAR, Cc_C4/envir.p_a,color=:black ,lw=2, alpha=0.7, label=\"Cc/Ca C4\")\nplot(APAR, Cc_C3/envir.p_a,color=:orange,lw=2, alpha=0.7, label=\"Cc/Ca C3\")\nxlabel(\"APAR [μmol/m²/s]\")\nylabel(\"Cc/Ca [-]\")\nlegend()\ngcf()","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#Dependence-of-stomatal-coductance-g_s-1","page":"Leaf Photosynthetic rates","title":"Dependence of stomatal coductance g_s","text":"","category":"section"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"#This part has been broken by Yuije, please fix it\nfigure()\nplot(APAR, gs_C4,color=:black ,lw=2, alpha=0.7, label=\"gs C4\")\nplot(APAR, gs_C3,color=:orange,lw=2, alpha=0.7, label=\"gs C3\")\nxlabel(\"APAR [μmol/m²/s]\")\nylabel(\"gs\")\nlegend()\ngcf()","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#More-complex-examples:-1","page":"Leaf Photosynthetic rates","title":"More complex examples:","text":"","category":"section"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"##Again, this looks tedious and repetitive but is the easiest way to do this right now:\n\n# Now I want to vary T, APAR and CO2:\n# Start CO2 from 100 ppm to make sure it is higher than Γ*\nAPAR = [100.0, 250.0, 500.0, 1000.0, 1500.0]\nCO2  = collect(100:20:800)\nT    = collect(274:2:310)\n\nn1 = length(APAR);\nn2 = length(CO2);\nn3 = length(T);\n\nAg_C3 = zeros(n1,n2,n3); Ag_C4 = zeros(n1,n2,n3);\nAn_C3 = zeros(n1,n2,n3); An_C4 = zeros(n1,n2,n3);\nAj_C3 = zeros(n1,n2,n3); Aj_C4 = zeros(n1,n2,n3);\nAp_C3 = zeros(n1,n2,n3); Ap_C4 = zeros(n1,n2,n3);\nAc_C3 = zeros(n1,n2,n3); Ac_C4 = zeros(n1,n2,n3);\nCc_C3 = zeros(n1,n2,n3); Cc_C4 = zeros(n1,n2,n3);\ngs_C3 = zeros(n1,n2,n3); gs_C4 = zeros(n1,n2,n3);\nnothing #hide","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"# Run this over all potential 3D dimensions:\n\n# I really like the compact form of nested loops in Julia!\nfor iA in eachindex(APAR), iC in eachindex(CO2), iT in eachindex(T)\n    #println(iA, \"/\", iC, \"/\", iT)\n    envir.p_a  = CO2[iC]/10;\n    leaf3.T    = T[iT];\n    leaf3.APAR = APAR[iA];\n    leaf4.T    = T[iT];\n    leaf4.APAR = APAR[iA];\n\n    # Run C3 photosynthesis:\n    leaf_photo_from_envir!(modC3, leaf3, envir, modC3.Sto);\n\n    # Save leaf variables:\n    An_C3[iA,iC,iT]=leaf3.An;\n    Ag_C3[iA,iC,iT]=leaf3.Ag;\n    Aj_C3[iA,iC,iT]=leaf3.Aj;\n    Ap_C3[iA,iC,iT]=leaf3.Ap;\n    Ac_C3[iA,iC,iT]=leaf3.Ac;\n    Cc_C3[iA,iC,iT]=leaf3.p_i;\n    gs_C3[iA,iC,iT]=leaf3.g_sw;\n\n    # Run C4 photosynthesis:\n    leaf_photo_from_envir!(modC4, leaf4, envir, modC4.Sto);\n\n    # Save leaf variables:\n    An_C4[iA,iC,iT]=leaf4.An;\n    Ag_C4[iA,iC,iT]=leaf4.Ag;\n    Aj_C4[iA,iC,iT]=leaf4.Aj;\n    Ap_C4[iA,iC,iT]=leaf4.Ap;\n    Ac_C4[iA,iC,iT]=leaf4.Ac;\n    Cc_C4[iA,iC,iT]=leaf4.p_i;\n    gs_C4[iA,iC,iT]=leaf4.g_sw;\nend","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#Plotting-2D-contours-of-A_n-vs.-CO_2-and-Temperature-1","page":"Leaf Photosynthetic rates","title":"Plotting 2D contours of A_n vs. CO_2 and Temperature","text":"","category":"section"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"##Let's take one slice in APAR space:\ni = 4\n\n# and plot:\nfigure()\ncontourf(T.-273.15, CO2, An_C3[i,:,:])\nxlabel(\"T [°C]\")\nylabel(\"Ambient CO₂ [ppm]\")\ntitle(\"C3 , An [μmol/m²/s] at APAR=$(APAR[i])\")\ncolorbar()\ngcf()","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"# Same for C4 plants, why is it so different??\n\nfigure()\ncontourf(T.-273.15, CO2, Cc_C4[i,:,:])\nxlabel(\"T [°C]\")\nylabel(\"Ambient CO₂ [ppm]\")\ntitle(\"C4 , Cc [Pa] at APAR=$(APAR[i])\")\ncolorbar()\ngcf()","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"# Same for C4 plants, why is it so different??\n\nfigure()\ncontourf(T.-273.15, CO2, An_C4[i,:,:])\nxlabel(\"T [°C]\")\nylabel(\"Ambient CO₂ [ppm]\")\ntitle(\"C4 , An [μmol/m²/s] at APAR=$(APAR[i])\")\ncolorbar()\ngcf()","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#Ambient-CO_2-response-curves-and-limiting-rates-for-C3-and-C4-1","page":"Leaf Photosynthetic rates","title":"Ambient CO_2 response curves and limiting rates for C3 and C4","text":"","category":"section"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"iA = 4; iT=12\nfigure()\nplot( CO2, Ag_C3[iA,:,iT],color=:black,lw=2, alpha=0.7, label=\"Ag C3\")\nplot(CO2, Ac_C3[iA,:,iT], ls=\"--\", lw=2, label=\"Ac C3\")\nplot(CO2, Aj_C3[iA,:,iT], ls=\"--\", lw=2, label=\"Aj C3\")\nplot(CO2, Ap_C3[iA,:,iT], ls=\"--\", lw=2, label=\"Ap C3\" )\nxlabel(\"CO₂ [ppm]\")\nylabel(\"Aᵢ [μmol/m2/s]\")\ntitle(\"Ambient C3 CO₂ response, T=$(T[iT]-273), APAR=$(APAR[iA])\")\nlegend()\ngcf()","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"iA = 4; iT=12\nfigure()\nplot(CO2, Ag_C4[iA,:,iT],color=:black,lw=2, alpha=0.7, label=\"Ag C4\")\nplot(CO2, Ac_C4[iA,:,iT], ls=\"--\", lw=2, label=\"Ac C4\")\nplot(CO2, Aj_C4[iA,:,iT], ls=\"--\", lw=2, label=\"Aj C4\")\nplot(CO2, Ap_C4[iA,:,iT], ls=\"--\", lw=2, label=\"Ap C4\")\nxlabel(\"CO₂ [ppm]\")\nylabel(\"Aᵢ [μmol/m2/s]\")\ntitle(\"Ambient C4 CO₂ response, T=$(T[iT]-273), APAR=$(APAR[iA])\")\nlegend()\ngcf()","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#Summary:-1","page":"Leaf Photosynthetic rates","title":"Summary:","text":"","category":"section"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"Play around a bit with different parameters. You can also try to change humidity at the leaf level or the boundary layer resistance. There are ## many things that can be tested, and we often like to go to the extremes (T, CO_2, ra) to check for bugs, which most often have to do with the ## A-C_c iterations.","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"Note of caution: we really plotted CO_2 response curves against ambient CO_2. At low C_c, leaves can be a source of CO_2 due to the CO_2 compensation point (i.e. A_g can be negative!). Also, at CO_2=0, stomatal conductance using the empirical formulation goes to infty, which can cause unwanted behavior.","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"Test things out, learn by changing parameters and try to break it!","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"","category":"page"},{"location":"generated/Leaf-Photosynthesis-Synthesis/#","page":"Leaf Photosynthetic rates","title":"Leaf Photosynthetic rates","text":"This page was generated using Literate.jl.","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"EditURL = \"https://github.com/CliMA/Land/blob/master/docs/src/tutorial_scripts/Leaf-Photosynthesis.jl\"","category":"page"},{"location":"generated/Leaf-Photosynthesis/#Leaf-Photosynthesis-Basics-1","page":"Leaf Level Basics","title":"Leaf Photosynthesis Basics","text":"","category":"section"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"This tutorial will walk you through the most basic aspects of how we implement Photosynthesis at the leaf level. Most of the concepts are described in the literature, with the first quantitative approach to modeling photosynthesis given in Farquhar, von Caemmerer and Berry[1] in their seminal 1980 paper for C3 photosynthesis. C4 photosynthesis is largely based on Collatz et al[2] but we approach the photosynthesis modeling with a rather generic approach that facilitates the application of different photosynthesis modeling approaches without changing the core code base. A good overview on the entire process of photosynthesis and different parameterizations can be found in Bonan[3].","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"At the core of both C3 and C4 photosynthesis is an enzyme catalyzed reaction of ribulose-1,5-bisphosphate (RuBP) with CO_2, yielding two 3-carbon compounds (phosphoglycerate (PGA)) as the initial products of photosynthesis. The enzyme RuBP carboxylase/oxygenase (Rubisco) catalyzes this reaction. With the regeneration of the substrate RuBP through the light reactions (using produced ATP and NADPH), the core cycle of photosynthesis is formed. This cycle was discovered in 1950 by Melvin Calvin, James Bassham, and Andrew Benson at the University of California, Berkeley[4][5] by using the radioactive isotope carbon-14.","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"An oxygenation step of RuBP releases half a CO_2. This so called photorespiration process results in inefficiencies in C3 photosynthesis, as both CO_2 and O_2 compete at the Rubisco site. The overall photosynthetic rate of the enzyme-catalyzed turnover rates at the Rubisco site thus determine the overall photosynthesis","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"A_n = V_c - 05V_o - R_d","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"with V_c being the carboxylation rate, V_o the oxygenation rate and R_d the mitochondrial respiration. Both rates follow Michaelis-Menten kinetics, accounting for the competing substrate effects:","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"V_c = fracV_cmaxC_cC_c+K_c(1+O_cK_o)","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"V_o = fracV_omaxO_cO_c+K_o(1+C_cK_c)","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"with K_c and K_o being the Michaelis Menten constants for CO_2 and O_2, C_c and O_c the partial pressures of CO_2 and O_2 at the Rubisco site.","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"The ratio of oxygenation to carboxylation rates is","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"phi = fracV_oV_c = fracV_omaxK_cV_cmaxK_ofracO_cC_c","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"which yields the CO_2 compensation point Gamma_star:","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"Gamma_star = 05fracV_omaxK_cV_cmaxK_oO_c","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"with is the internal CO_2 partial pressure at which oxygenation and carboxylation cancel each other out in terms of CO_2 consumption and production (neglecting R_d).","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"[1]: Farquhar, G.D., von Caemmerer, S.V. and Berry, J.A., 1980. A biochemical model of photosynthetic CO_2 assimilation in leaves of C3 species. Planta, 149(1), pp.78-90.","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"[2]: Collatz, G.J., Ribas-Carbo, M. and Berry, J.A., 1992. Coupled photosynthesis-stomatal conductance model for leaves of C4 plants. Functional Plant Biology, 19(5), pp.519-538.","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"[3]: Bonan, G., 2019. Climate change and terrestrial ecosystem modeling. Cambridge University Press.","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"[4]: Calvin, Melvin, and Andrew Alm Benson. \"The path of carbon in photosynthesis IV: the identity and sequence of the intermediates in sucrose synthesis.\" Science 109, no. 2824 (1949): 140-142.","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"[5]: Benson, A.A., Bassham, J.A., Calvin, M., Goodale, T.C., Haas, V.A. and Stepka, W., 1950. The path of carbon in photosynthesis. v. paper chromatography and radioautography of the products1. Journal of the American Chemical Society, 72(4), pp.1710-1718.","category":"page"},{"location":"generated/Leaf-Photosynthesis/#Rate-Limiting-Steps-for-photosynthesis-1","page":"Leaf Level Basics","title":"Rate Limiting Steps for photosynthesis","text":"","category":"section"},{"location":"generated/Leaf-Photosynthesis/#Rubisco-limited-rates:-1","page":"Leaf Level Basics","title":"Rubisco-limited rates:","text":"","category":"section"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"The net photosynthetic rate limited by Rubisco when RuBP re-generation is not constraining can thus be described as","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"A_n = left(1-fracGamma_starC_cright)V_c-R_d","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"which equals (now denoting A_c as the Rubisco limited rate):","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"A_c = frac(C_c-Gamma_star) V_cmaxC_c+K_c(1+O_cK_o)","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"which is implemented in our routines \"rubiscolimitedrate!\".","category":"page"},{"location":"generated/Leaf-Photosynthesis/#RuBP-regeration-limited-rates-(light-limited):-1","page":"Leaf Level Basics","title":"RuBP-regeration limited rates (light-limited):","text":"","category":"section"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"RuBP is regenerated via the ligh reaction, which generates ATP and NADP to power this part of the Calvin-Benson-Bassham cycle. Without going into details of the NADPH or ATP requirements for regeneration, the rate of RuBP limited photosynthesis through light-powered electron transport J (µmol/m^2/s) is given as","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"A_j = underbracefracC_c-Gamma_starCc_textloss in photorespirationunderbracefracJC_c4C_c+8Gamma_star_textRuBP regeneration = fracJ(C_c-Gamma_star)4C_c+8Gamma_star","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"One can already see what the key difference between C3 and C4 photosynthesis is based on these set of equation for rubisco turnover and RuBP-regeneration limited rates. In C4 photosynthesis, C_c is typically only about 70% of the ambient CO_2 concentration as CO_2 has to diffuse through stomata and the mesophyll. For C4, a carbon accumulation mechanism uses a four-carbon organic acid (hence C4) to transport CO_2 from the mesophyll cells to the bundle sheath cells, where the reaction with Rubisco takes place. This leads to much higher C_c for C4 plants ( than ambient air CO_2), which is often simplified for A_c as the limit of C3 equation with lim_C_c to infty Ac(C3):","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"A_c^C4 = V_cmax","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"Similarly, the RuBP-regeneration limited rate simplifies to:","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"A_j^C4 = alpha J","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"with a slightly lower efficiency alpha for C4 photosynthesis compared to C3 (as the carbon accumulation mechanism also consumes ATP). In reality, the situation is somewhat more complex and there are different approximations for Rubisco and RuBP limited rate constants. A comprehensive overview is described in von Caemmerer [6]. Again, our goal is to provide a flexible framework for photosynthesis modeling, so different implementations of rate limiting steps A_cA_j can be used in a modular framework (achieved through code abstraction and multiple dispatch in Julia).","category":"page"},{"location":"generated/Leaf-Photosynthesis/#Electron-Transport-Rate-J-1","page":"Leaf Level Basics","title":"Electron Transport Rate J","text":"","category":"section"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"The rate of electron transport is driven by absorbed photosynthetically absorbed radiation (APAR, mu molm^2s) by Photosystem II (PSII). With our leaf level optical model, we already compute the efficiency of absorbtion by leaves depending on pigment contents. We define varphi_PSII as the quantum yield of photosystem II (maxima about 0.83) and f_PSII the fraction of light used for PSII (PSII/(PSI+PSII)), typically assume to be 0.5.","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"J_PSII = f_PSII varphi_PSII APAR","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"In most models, a maximum electron transport J_max rate is assumed and the actual electron trapsort rate J_a is defined as the lower root of the quadratic expression","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"Theta_j J_a^2 -(J_PSII+J_max)+ J_PSIIJ_max = 0","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"where Theta_j is a curvature parameter to assure a smooth transition.","category":"page"},{"location":"generated/Leaf-Photosynthesis/#Product-limited-rates:-1","page":"Leaf Level Basics","title":"Product limited rates:","text":"","category":"section"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"Typically, a thrid limitation of photosynthesis is being used as well, which we denote as product limited rate here, even though the processes for C3 and C4 plants differ. Typically, the export of the products of photosynthesis (triose phosphates) in the synthesis of sugars can be rate limiting, which is often parameterized by V_cmax:","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"A_p = a V_cmax","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"where our standard definition for C3 used a=0.5, which rarely limits photosynthesis compared to A_c and A_j.","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"For C4 plants, we use the PEP-carboxylase CO_2 concentration mechanism into the bundle sheath cell as product limited rate step, using Michaelis-Menten kinetics:","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"A_p^C4 = fracV_pmaxC_cC_c + K_p","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"with corresponding Michaelis Menten constant K_p and maximal rates V_pmax.","category":"page"},{"location":"generated/Leaf-Photosynthesis/#Total-rate:-1","page":"Leaf Level Basics","title":"Total rate:","text":"","category":"section"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"The gross photosynthetic rate A_g can then be define as the mininum of all possible limitations:","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"A_g = min(AcAjAp)","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"or, alternatively, using quadratic equations as for J, which provides smoother transitions and co-limitation to some degree (both are options in our setup with a user defined curvature parameter Theta.","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"Net leaf photosynthesis includes mitochondrial respiration as well:","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"A_n = A_g - R_d","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"[6]: Von Caemmerer, S., 2000. Biochemical models of leaf photosynthesis. Csiro publishing.","category":"page"},{"location":"generated/Leaf-Photosynthesis/#Simple-example:-1","page":"Leaf Level Basics","title":"Simple example:","text":"","category":"section"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"We just want to lay out a first simple example as to how our model setup work:","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"# Loading the Photosynthesis model:\nusing Land.Photosynthesis\n# Defining our Field Type (we can easily switch between Double and Float precision this way)\nconst FT = Float32;\nnothing #hide","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"# Create a standard leaf with defualt parameters\nleaf = Leaf{FT}();\n\n# Create a standard meteo structure:\nenvir = AirLayer{FT}();\nnothing #hide","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"How to use the documentation, what do we know about leaf_params, which stores most physiologically relevant parameters. (Not printed here, try in the command line! Type in, do not copy and paste!).","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"##?LeafParams","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"##?MeteoParams","category":"page"},{"location":"generated/Leaf-Photosynthesis/#Defining-the-model-setup-1","page":"Leaf Level Basics","title":"Defining the model setup","text":"","category":"section"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"The most important step is to define which submodules to use. There might be different implementations for Fluorescence, Photosynthesis (C3,C4,etc), respiration, stomatal conductance (e.g. Ball-Berry, Medlyn), the T-dependence of J_max, V_cmax and Michaelis Menten constants as well as leaf boundary layer resistance (setting it to 0 here to mimic well vented laboratory leaf level measurements) and colimitation.","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"##Here, we just have to worry abou the photosynthesis module, which we set here:\n#mod_photo = C3FvCBPhoto()\n\n# All modules here:\nconst photo_set = C3CLM(FT);\nnothing #hide","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"# Set APAR to 250 $\\mu mol/m^2/s$\nleaf.APAR = 250;\n# Set temperature to 290K\nleaf.T = 290;\n# Applying the T-correction for all the rate constants\nleaf_temperature_dependence!(photo_set, leaf, envir);\n@show leaf.Vcmax, leaf.Vcmax25;\nnothing #hide","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"@show leaf.Jmax, leaf.Jmax25;\nnothing #hide","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"# Specify Cc directly here in Pa\nleaf.p_i = 35;\n# update radiation dependent values first, like ETR\nleaf_photo_from_pi!(photo_set, leaf, envir);\n@show leaf.Ac;\nnothing #hide","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"@show leaf.Aj;\nnothing #hide","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"@show leaf.Ap;\nnothing #hide","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"@show leaf.An;\nnothing #hide","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"","category":"page"},{"location":"generated/Leaf-Photosynthesis/#Summary-1","page":"Leaf Level Basics","title":"Summary","text":"","category":"section"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"This was the simplest example to compute A_c, A_j and A_p with a specified C_c and APAR. In reality, C_c is defined by the interplay of photosynthetic demand and the supply through diffusion through stomata and the mesophyll. However, you can easily exchange the photosynthesis model above with C4FvCBPhoto(). You can also play around with leaf temperature T and APAR as well as C_c. But remember to use the right function.","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"#?Leaf","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"","category":"page"},{"location":"generated/Leaf-Photosynthesis/#","page":"Leaf Level Basics","title":"Leaf Level Basics","text":"This page was generated using Literate.jl.","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"EditURL = \"https://github.com/CliMA/Land/blob/master/docs/src/tutorial_scripts/Radiation_Test_BRDF.jl\"","category":"page"},{"location":"generated/Radiation_Test_BRDF/#Canopy-Radiative-Transfer-Example-#1-1","page":"Reflected and Emitted Radiance","title":"Canopy Radiative Transfer Example #1","text":"","category":"section"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"This example will go through the calculations of hemispheric and bidirectional reflectance as well as emission of Solar Induced Chlorophyll Fluorescence (SIF). The sun sensor geometry is defined by the solar zenith angle SZA, the viewing zenith angle VZA (observer, 0degrees=Nadir looking) and the relative azimuth angle between the sun and observer (0 or 180degrees denoting the principal plane).","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"# Use Julia Plots package and switch to plotly js option:\nusing PyPlot","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"First, we include Revise (good for debugging) and Parameters (tools for structures)","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"#using Revise\nusing Parameters","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"Now include the Land modules","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"using Land\nusing Land.CanopyRT","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"and unpack some of the mostly used variables or structure (same as writing CanopyRT.leafbio)","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"#@unpack FT, leafbio, canopy, angles, canOpt, canRad,sunRad,soil, wl, wle, wlf = CanopyRT","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"This extracted a number of structures, which are loaded with default values at startup:","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"leafbio includes all leaf pigment concentrations, such as Chlorophyll, leaf water, Carotenoids and dry matter content. (mutable struct leafbio)\ncanopy includes Canopy properties such as LAI, leaf inclination distribution, clumping factor (mutable struct struct_canopy)\nangles includes SZA, VZA and azimuth (mutable struct struct_angles)\ncanOpt saves a variety of canopy optical properties to be computed (mutable struct struct_canopyOptProps)\ncanRad includes radiation computed within the Canopy RT module (mutable struct struct_canopyRadiation)\nsunRad provides incoming direct and diffuse incoming solar radiation (mutable struct incomingRadiation)\nsoil provides soil albedo and skin temperature","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"as well as some arrays:","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"wl is the wavelength grid (nm) for the solar radiation computation\nwle is the wavelength grid in the photosynthetically active range (a subset of wl, used to define fluorescence excitation and driving photosynthesis)\nwlf is the wavelength grid for SIF (subset of wl). The fluorescence excitation matrices are defined on the basis of wle and wlf.","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"Let us just define our own leaf here, we can construct it using standard values but need to provide all dimensions (will be fixed as variables are saved in MArrays):","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"const FT = Float32\n\nwl_set = create_wl_para_set(FT)\nleaf = create_leaf_bio(FT, wl_set.nwl, wl_set.nWlE, wl_set.nWlF);\ncanopy_rt = Canopy4RT{FT}(nlayers=20, LAI=3)\ncanRad_rt = CanopyRadiation{FT, wl_set.nwl, wl_set.nWlF, length(canopy_rt.litab), length(canopy_rt.lazitab), canopy_rt.nlayers}()\ncanOpt_rt = create_canopy_optical(FT, wl_set.nwl, canopy_rt.nlayers, length(canopy_rt.lazitab), length(canopy_rt.litab); using_marray=false)\nsunRad_rt = create_incoming_radiation(FT, wl_set.swl);\n\n# show leaf Chlorophyll content:\n@show leaf.Cab","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"","category":"page"},{"location":"generated/Radiation_Test_BRDF/#Leaf-Optical-Properties-1","page":"Reflected and Emitted Radiance","title":"Leaf Optical Properties","text":"","category":"section"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"Now we can first run fluspect, which is an extension of the Prospect leaf optical properties program and includes computations of the fluorescence emission responses as well. CanopyRT.optis includes all pigment absorption cross sections as well as refractive index of water to compute leaf optical properties. For details, see:","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"Féret, J.B., Gitelson, A.A., Noble, S.D. and Jacquemoud, S., 2017. PROSPECT-D: Towards modeling leaf optical properties through a complete lifecycle. Remote Sensing of Environment, 193, pp.204-215.","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"Van der Tol, C., Verhoef, W., Timmermans, J., Verhoef, A. and Su, Z., 2009. An integrated model of soil-canopy spectral radiances, photosynthesis, fluorescence, temperature and energy balance. Biogeosciences, 6(12).","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"Vilfan, N., Van der Tol, C., Muller, O., Rascher, U. and Verhoef, W., 2016. Fluspect-B: A model for leaf fluorescence, reflectance and transmittance spectra. Remote sensing of environment, 186, pp.596-615.","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"# Run Fluspect:\nfluspect!(leaf, wl_set);\nnothing #hide","category":"page"},{"location":"generated/Radiation_Test_BRDF/#Fluorescence-excitation-matrices-1","page":"Reflected and Emitted Radiance","title":"Fluorescence excitation matrices","text":"","category":"section"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"Now we can visualize the fluorescence excitatiom matrices, which determine how absorbed photons at a specific wavelength wle incident on the leaf are emitted backwards (in relation to the incident light but hemispherically diffuse here) or forward. Here, we ignore contributions from Photosystem I and just use a fixed shape as input at the chloroplast level for Photosystem II, hence all spectral shapes are determined by the light distribution within the leaf. Several effects can be observed in the plots below: The first SIF peak at 680nm is much weaker in the forward direction than in the backward direction as more the re-absorption within the leaf is much higher for the forward direction. Similarly, blue incident light penetrates the leaf less than at higher wavelengths, so the chlorophyll re-absorption (backwards) is less re-absorbed by chlorophyll as it emanates from less deep layers.","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"# Plot Mb matrix\nfigure()\ncontourf(wl_set.wle, wl_set.wlf, leaf.Mb)\nxlabel(\"Excitation wavelength (nm)\")\nylabel(\"Emission wavelength (nm)\")\ntitle(\"Fluorescence backward (refl) emission (Mb)\")\ngcf()","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"# Plot Mf matrix\nfigure()\ncontourf(wl_set.wle, wl_set.wlf, leaf.Mf)\nxlabel(\"Excitation wavelength (nm)\")\nylabel(\"Emission wavelength (nm)\")\ntitle(\"Fluorescence forward (transmission) emission (Mf)\")\ngcf()","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"# Define a few wavelengths:\nwl_blue = 450.0;\nwl_red = 600.0;\nwl_FarRed = 740.0;\nwl_Red = 685.0;\nind_wle_blue  = argmin(abs.(wl_set.wle .-wl_blue));\nind_wle_red = argmin(abs.(wl_set.wle .-wl_red));\nind_wlf_FR  = argmin(abs.(wl_set.wlf .-wl_FarRed));\nind_wlf_R  = argmin(abs.(wl_set.wlf .-wl_Red));\nind_red = argmin(abs.(wl_set.wl .-wl_Red));\nind_NIR = argmin(abs.(wl_set.wl .-800));\nnothing #hide","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"# Plot some cross section in wle and wlf space:\nfigure()\nplot(wl_set.wlf,leaf.Mf[:,ind_wle_blue], color=:black, lw = 2 , label=\"Forward SIF, excited at $wl_blue nm\")\nplot(wl_set.wlf,leaf.Mb[:,ind_wle_blue],color=:orange, lw = 2 , label=\"Backward SIF, excited at $wl_blue nm\" )\nplot(wl_set.wlf,leaf.Mf[:,ind_wle_red], color=:black,ls=\"--\",lw=2, label=\"Forward SIF, excited at $wl_red nm\" )\nplot(wl_set.wlf,leaf.Mb[:,ind_wle_red], color=:orange,ls=\"--\",lw=2, label=\"Backward SIF, excited at $wl_red nm\" )\nxlabel(\"Wavelength (nm)\")\nylabel(\"Fluorescence\")\nlegend()\ngcf()","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"# Plot some cross section in wle and wlf space:\nfigure()\nplot(wl_set.wle,leaf.Mf[ind_wlf_FR,:], color=:black, lw = 2 , label=\"Forward SIF, emitted at $wl_FarRed nm\")\nplot(wl_set.wle,leaf.Mb[ind_wlf_FR,:],color=:orange, lw = 2 , label=\"Backward SIF, emitted at $wl_FarRed nm\" )\nplot(wl_set.wle,leaf.Mf[ind_wlf_R,:], color=:black,ls=\"--\",lw=2, label=\"Forward SIF, emitted at $wl_Red nm\" )\nplot(wl_set.wle,leaf.Mb[ind_wlf_R,:], color=:orange,ls=\"--\",lw=2, label=\"Backward SIF, emitted at $wl_Red nm\" )\nxlabel(\"Absorbed Wavelength (nm)\")\nylabel(\"Fluorescence\")\nlegend()\ngcf()","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"","category":"page"},{"location":"generated/Radiation_Test_BRDF/#Leaf-reflectance-and-transmission-1","page":"Reflected and Emitted Radiance","title":"Leaf reflectance and transmission","text":"","category":"section"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"Within Fluspect, leaf reflectance and transmission is calculated (this part is actually identical to what PROSPECT is doing and much less involved than the Fluorescence part). The model basically uses a doubling adding routine to solve for the radiative transfer within the leaf using constituent absorption cross sections and constituent abundances in the leaf (assuming vertically homogenous distribution).","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"Here, we just create another leaf with different concentrations to show the impact on leaf reflectance and transmission due to changes in chlorophyll content and liquid water content (mostly in the two liquid water absorption bands at 1400 and 1900nm).","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"# Let's create a leaf with a different Cab and Cw (water) content (<span style=\"color:red\">Try changing other pigment contents, plot leaf reflectance and transmissions and explain where (spectrally) and why reflectance and transmission changes</span>):\nleaf_2 = create_leaf_bio(FT, wl_set.nwl, wl_set.nWlE, wl_set.nWlF);\nleaf_2.Cab = 80\nleaf_2.Cw = 0.012\n# show leaf Chlorophyll content:\n# and Run Fluspect:\nfluspect!(leaf_2, wl_set);\nnothing #hide","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"figure()\nplot(wl_set.wl,1 .-leaf.τ_SW, color=:black, lw = 2 , label=\"Leaf Transmission\")\nplot(wl_set.wl,leaf.ρ_SW,color=:orange, lw = 2 , label=\"Leaf Reflectance\" )\nplot(wl_set.wl,1 .-leaf_2.τ_SW, color=:black, ls=\"--\",lw=2, label=\"Leaf ##2 Transmission\")\nplot(wl_set.wl,leaf_2.ρ_SW,color=:orange, ls=\"--\",lw=2, label=\"Leaf ##2 Reflectance\" )\nxlabel(\"Wavelength (nm)\")\nlegend()\ngcf()","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"","category":"page"},{"location":"generated/Radiation_Test_BRDF/#Moving-from-the-leaf-to-the-entire-canopy-1","page":"Reflected and Emitted Radiance","title":"Moving from the leaf to the entire canopy","text":"","category":"section"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"Our model here is based on mSCOPE[1] and we can prescribe different leaf optical properties within a complex canopy. At the moment, the leaf angular distribution is the same vertically (but could be changed in the future).","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"[1]: Yang, P., Verhoef, W. and van der Tol, C., 2017. The mSCOPE model: A simple adaptation to the SCOPE model to describe reflectance, fluorescence and photosynthesis of vertically heterogeneous canopies. Remote sensing of environment, 201, pp.1-11.","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"# This is to be changed later but at the moment, we need to generate an Array of leaves, basically for each layer of the canopy\n\narrayOfLeaves = [create_leaf_bio(FT, wl_set.nwl, wl_set.nWlE, wl_set.nWlF) for i in 1:canopy_rt.nlayers]\nfor i in 1:canopy_rt.nlayers\n    fluspect!(arrayOfLeaves[i],  wl_set)\nend","category":"page"},{"location":"generated/Radiation_Test_BRDF/#Basic-Steps-for-Canopy-RT:-1","page":"Reflected and Emitted Radiance","title":"Basic Steps for Canopy RT:","text":"","category":"section"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"Below are the basic steps for the canopy radiative transfer (SIF fluxes are dependent on stress levels at each leaf but here we use a standard SIF yield for now):","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"# Set Soil albedo to 0.2\nsoil = SoilOpti{FT}(wl_set.wl, FT(0.2)*ones(FT, length(wl_set.wl)), FT[0.1], FT(290.0))\nangles = SolarAngles{FT}()\n\n# Compute Canopyoptical properties dependend on sun-sensor and leaf angle distributions:\ncompute_canopy_geometry!(canopy_rt, angles, canOpt_rt)\n# Compute RT matrices with leaf reflectance and transmissions folded in:\ncompute_canopy_matrices!(arrayOfLeaves, canOpt_rt);\n# Perform SW radiation transfer:\nsimulate_short_wave!(canopy_rt, canOpt_rt, canRad_rt, sunRad_rt, soil);\n# Compute outgoing SIF flux (using constant fluorescence efficiency at the chloroplast level)\nderive_canopy_fluxes!(canopy_rt, canOpt_rt, canRad_rt, sunRad_rt, soil, arrayOfLeaves, wl_set);\nnothing #hide","category":"page"},{"location":"generated/Radiation_Test_BRDF/#Test-a-VZA-dependence-in-the-principal-plane-1","page":"Reflected and Emitted Radiance","title":"Test a VZA dependence in the principal plane","text":"","category":"section"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"SIF_FR = Float32[]\nSIF_R = Float32[]\nreflVIS = Float32[]\nreflNIR = Float32[]\n\n# Just running the code over all geometries:\n\n# Set sun SZA to 30 degrees\nangles.tts=30\n# Set 0 azimuth (principal plane)\nangles.psi=0\n# LAI of 3:\ncanopy_rt.LAI = 3\n# Define VZA\nVZA=collect(-89.5:0.5:89.5)\n\nfor VZA_ in VZA\n    angles.tto=VZA_\n    compute_canopy_geometry!(canopy_rt, angles, canOpt_rt)\n    compute_canopy_matrices!(arrayOfLeaves, canOpt_rt);\n    simulate_short_wave!(canopy_rt, canOpt_rt, canRad_rt, sunRad_rt, soil);\n    computeSIF_Fluxes!(arrayOfLeaves, canOpt_rt, canRad_rt, canopy_rt, soil, wl_set);\n    # Handpicked indices in\n    push!(reflVIS, canRad_rt.alb_obs[ind_red])\n    push!(reflNIR, canRad_rt.alb_obs[ind_NIR])\n    push!(SIF_R , canRad_rt.SIF_obs[ind_wlf_R])\n    push!(SIF_FR, canRad_rt.SIF_obs[ind_wlf_FR ])\nend","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"# Plots Visible\nfigure()\nplot(VZA, reflVIS, label=\"Red Reflectance\", lw=2)\nplot(VZA, SIF_R/30, label=\"Red SIF (/30)\", lw=2)\nxlabel(\"Viewing Zenith Angle\")\nlegend()\ngcf()","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"# Plot Near Infrared:\nfigure()\nplot(VZA, reflNIR, label=\"NIR Reflectance\", lw=2)\nplot(VZA, SIF_FR/6, label=\"Far Red SIF (/6)\", lw=2)\nxlabel(\"Viewing Zenith Angle\")\ngcf()","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"","category":"page"},{"location":"generated/Radiation_Test_BRDF/#BRDF-sampling-1","page":"Reflected and Emitted Radiance","title":"BRDF sampling","text":"","category":"section"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"By going through viewing and azimuth angles, we can construct a full BRDF for reflectance and SIF emissions at different wavelengths:","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"reflVIS = Float32[]\nreflNIR = Float32[]\nSIF_FR = Float32[]\nSIF_R  = Float32[]\nangles.tts=48\nangles.psi=0\ncanopy_rt.LAI=3.22\nfor psi=0:360\n    angles.psi=psi\n    for VZA=0:1:85\n        angles.tto=VZA\n\n        compute_canopy_geometry!(canopy_rt, angles, canOpt_rt)\n        compute_canopy_matrices!(arrayOfLeaves, canOpt_rt);\n        simulate_short_wave!(canopy_rt, canOpt_rt, canRad_rt, sunRad_rt, soil);\n        computeSIF_Fluxes!(arrayOfLeaves, canOpt_rt, canRad_rt, canopy_rt, soil, wl_set);\n        push!(reflVIS, canRad_rt.alb_obs[28])\n        push!(reflNIR, canRad_rt.alb_obs[52])\n        push!(SIF_R , canRad_rt.SIF_obs[8])\n        push!(SIF_FR, canRad_rt.SIF_obs[20])\n    end\nend","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"A = reshape(reflNIR, ( 86,361));\nB = reshape(reflVIS, ( 86,361));\nSIFFER = reshape(SIF_R, ( 86,361));\nSIFFER_FR = reshape(SIF_FR, ( 86,361));\nnothing #hide","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"##heatmap(A, cmap=)\nfigure()\nsubplot(1,1,1, polar=true)\ngrid(false)\nhm = contourf(deg2rad.(collect((0:360))),collect(0:1:85),  A,  cmap=:viridis)\ntitle(\"NIR reflectance BRDF\")\ncolorbar()\ngcf()","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"##heatmap(A, cmap=)\nfigure()\nsubplot(1,1,1, polar=true)\ngrid(false)\nhm = contourf(deg2rad.(collect((0:360))),collect(0:1:85),  B,  cmap=:viridis)\ntitle(\"VIS reflectance BRDF\")\ncolorbar()\ngcf()","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"figure()\nsubplot(1,1,1, polar=true)\ngrid(false)\nhm = contourf(deg2rad.(collect((0:360))),collect(0:1:85),  SIFFER, cmap=:viridis)\ntitle(\"Red SIF emission BRDF\")\ncolorbar()\ngcf()","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"figure()\nsubplot(1,1,1, polar=true)\ngrid(false)\nhm = contourf(deg2rad.(collect((0:360))),collect(0:1:85),  SIFFER_FR, cmap=:viridis)\ntitle(\"Far Red SIF emission BRDF\")\ncolorbar()\ngcf()","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"This page was generated using Literate.jl.","category":"page"},{"location":"generated/Leaf-Photosynthesis-Rates/#","page":"Enzyme catalysis T-dependence","title":"Enzyme catalysis T-dependence","text":"EditURL = \"https://github.com/CliMA/Land/blob/master/docs/src/tutorial_scripts/Leaf-Photosynthesis-Rates.jl\"","category":"page"},{"location":"generated/Leaf-Photosynthesis-Rates/#Rate-Constants,-T-dependence-1","page":"Enzyme catalysis T-dependence","title":"Rate Constants, T-dependence","text":"","category":"section"},{"location":"generated/Leaf-Photosynthesis-Rates/#","page":"Enzyme catalysis T-dependence","title":"Enzyme catalysis T-dependence","text":"Here, we will just briefly summarize how temperature affects enzymatic rate constants and how much uncertainty there actually is in literature (in terms of how to best define them and how plastic some of the variables are)","category":"page"},{"location":"generated/Leaf-Photosynthesis-Rates/#","page":"Enzyme catalysis T-dependence","title":"Enzyme catalysis T-dependence","text":"# Add usual tools we use:\n#using Revise\nusing BenchmarkTools","category":"page"},{"location":"generated/Leaf-Photosynthesis-Rates/#","page":"Enzyme catalysis T-dependence","title":"Enzyme catalysis T-dependence","text":"Use PyPlot to plot figures","category":"page"},{"location":"generated/Leaf-Photosynthesis-Rates/#","page":"Enzyme catalysis T-dependence","title":"Enzyme catalysis T-dependence","text":"using PyPlot","category":"page"},{"location":"generated/Leaf-Photosynthesis-Rates/#","page":"Enzyme catalysis T-dependence","title":"Enzyme catalysis T-dependence","text":"# load Photosynthesis module:\nusing Land.Photosynthesis","category":"page"},{"location":"generated/Leaf-Photosynthesis-Rates/#","page":"Enzyme catalysis T-dependence","title":"Enzyme catalysis T-dependence","text":"# Specify Field Type\nconst FT = Float32","category":"page"},{"location":"generated/Leaf-Photosynthesis-Rates/#T-dependence-of-V_{c,max}-1","page":"Enzyme catalysis T-dependence","title":"T-dependence of V_cmax","text":"","category":"section"},{"location":"generated/Leaf-Photosynthesis-Rates/#","page":"Enzyme catalysis T-dependence","title":"Enzyme catalysis T-dependence","text":"In literature, there are different implementations of the temperature dependence of enzymatic reaction rates. Common among all of them is a typical Arrhenius formulation with Activation energy E_a, which leads to a temperature dependence of a quantity V given the standard value defined at 25°C as T_ref.","category":"page"},{"location":"generated/Leaf-Photosynthesis-Rates/#","page":"Enzyme catalysis T-dependence","title":"Enzyme catalysis T-dependence","text":"V(T)= V(T_ref) underbraceexpleft(fracE_aRT_ref-fracE_aRTright)_textActivation","category":"page"},{"location":"generated/Leaf-Photosynthesis-Rates/#","page":"Enzyme catalysis T-dependence","title":"Enzyme catalysis T-dependence","text":"Other formulations add de-activation of proteins due to denaturalization at higher temperatures: $V(T)= V(T{ref})\\, \\exp\\left(\\frac{Ea}{RT{ref}}-\\frac{Ea}{RT}\\right) \\underbrace{\\frac{1+\\exp\\left((\\Delta ST{ref}-Hd)/RT{ref}\\right)}{1+\\exp\\left((\\Delta ST-Hd)/RT\\right)}}{\\text{de-activation}} $ which includes an entropy term Delta S and the energy for deactivation Hd$.","category":"page"},{"location":"generated/Leaf-Photosynthesis-Rates/#","page":"Enzyme catalysis T-dependence","title":"Enzyme catalysis T-dependence","text":"To illustrate the differences, we show two different implementations, one only using the activation part based on Bernacchi et al 2001[1] and one with the typical CLM5 implementation.","category":"page"},{"location":"generated/Leaf-Photosynthesis-Rates/#","page":"Enzyme catalysis T-dependence","title":"Enzyme catalysis T-dependence","text":"[1]: Bernacchi, C.J., Singsaas, E.L., Pimentel, C., Portis Jr, A.R. and Long, S.P., 2001. Improved temperature response functions for models of Rubisco‐limited photosynthesis. Plant, Cell & Environment, 24(2), pp.253-259.","category":"page"},{"location":"generated/Leaf-Photosynthesis-Rates/#","page":"Enzyme catalysis T-dependence","title":"Enzyme catalysis T-dependence","text":"# This looks a bit more tedious here than it needs to but in reality\n\nvcmax_Bernacchi = Float32[]\nvcmax_CLM = Float32[]\n\n# Define T-range\nTleaf = collect(FT,260.0:1.0:315.0)\n\n# Run through temperatures and save Vcmax values:\ntd_vc_bernacchi = Photosynthesis.VcmaxTDBernacchi(FT)\ntd_vc_clm       = Photosynthesis.VcmaxTDCLM(FT)\nfor T in Tleaf\n    _Vcmax = Photosynthesis.photo_TD_from_val(td_vc_bernacchi, FT(100.0), T)\n    push!(vcmax_Bernacchi, _Vcmax)\n    _Vcmax = Photosynthesis.photo_TD_from_val(td_vc_clm, FT(100.0), T)\n    push!(vcmax_CLM, _Vcmax)\nend","category":"page"},{"location":"generated/Leaf-Photosynthesis-Rates/#","page":"Enzyme catalysis T-dependence","title":"Enzyme catalysis T-dependence","text":"figure()\nplot(Tleaf .- 273.15, vcmax_Bernacchi, label=\"Bernacchi\", lw=2)\nplot(Tleaf .- 273.15, vcmax_CLM,  label=\"CLM5\", lw=2)\nylabel(\"Vcmax (µmol/m²/s)\")\nxlabel(\"Leaf Temperature (°C)\")\nlegend()\ngcf()","category":"page"},{"location":"generated/Leaf-Photosynthesis-Rates/#CO_2-compensation-point-\\Gamma_\\star-1","page":"Enzyme catalysis T-dependence","title":"CO_2 compensation point Gamma_star","text":"","category":"section"},{"location":"generated/Leaf-Photosynthesis-Rates/#","page":"Enzyme catalysis T-dependence","title":"Enzyme catalysis T-dependence","text":"# Here, we only have one implementation:\nΓ_CLM = Float32[]\nTleaf = collect(FT,260.0:1.0:315.0)\ntd_gamma_clm = Photosynthesis.ΓStarTDCLM(FT)\n\nfor T in Tleaf\n    _ΓStar = Photosynthesis.photo_TD_from_set(td_gamma_clm, T)\n    push!(Γ_CLM, _ΓStar)\nend","category":"page"},{"location":"generated/Leaf-Photosynthesis-Rates/#","page":"Enzyme catalysis T-dependence","title":"Enzyme catalysis T-dependence","text":"figure()\nplot(Tleaf .- 273.15, Γ_CLM, label=\"Γ_CLM\")\nylabel(\"Γ⋆ (Pa)\")\nxlabel(\"Leaf Temperature (°C)\")\nlegend()\ngcf()","category":"page"},{"location":"generated/Leaf-Photosynthesis-Rates/#T-dependence-of-J_{max}-1","page":"Enzyme catalysis T-dependence","title":"T-dependence of J_max","text":"","category":"section"},{"location":"generated/Leaf-Photosynthesis-Rates/#","page":"Enzyme catalysis T-dependence","title":"Enzyme catalysis T-dependence","text":"Jmax_Bernacchi = Float32[]\nJmax_CLM = Float32[]\nTleaf = collect(FT,260.0:1.0:315.0)\n\ntd_j_bernacchi = Photosynthesis.JmaxTDBernacchi(FT)\ntd_j_clm = Photosynthesis.JmaxTDCLM(FT)\n\nfor T in Tleaf\n    _Jmax = Photosynthesis.photo_TD_from_val(td_j_bernacchi, FT(100.0), T)\n    push!(Jmax_Bernacchi, _Jmax)\n    _Jmax = Photosynthesis.photo_TD_from_val(td_j_clm, FT(100.0), T)\n    push!(Jmax_CLM, _Jmax)\nend","category":"page"},{"location":"generated/Leaf-Photosynthesis-Rates/#","page":"Enzyme catalysis T-dependence","title":"Enzyme catalysis T-dependence","text":"figure()\nplot(Tleaf .- 273.15, Jmax_Bernacchi, label=\"Bernacchi\")\nplot(Tleaf .- 273.15, Jmax_CLM,  label=\"CLM5\")\nylabel(\"Jmax (µmol/m2/s)\")\nxlabel(\"Leaf Temperature (°C)\")\nlegend()\ngcf()","category":"page"},{"location":"generated/Leaf-Photosynthesis-Rates/#","page":"Enzyme catalysis T-dependence","title":"Enzyme catalysis T-dependence","text":"","category":"page"},{"location":"generated/Leaf-Photosynthesis-Rates/#Summary-1","page":"Enzyme catalysis T-dependence","title":"Summary","text":"","category":"section"},{"location":"generated/Leaf-Photosynthesis-Rates/#","page":"Enzyme catalysis T-dependence","title":"Enzyme catalysis T-dependence","text":"The way land surface models implement temperature variations in V_cmax is still rather variable and there is no clear consensus in what model is best. In addition, gas exchange datasets performed at different temperatures might actually alias different confounding factors into the V_cmax determination, so that the actually fitted V_cmax strongly depends on the model formulation. E.g. mesophyll conductance is usually ignore in deriving V_cmax but might be temperature dependent, which can cause T-dependent errors in V_cmax.","category":"page"},{"location":"generated/Leaf-Photosynthesis-Rates/#","page":"Enzyme catalysis T-dependence","title":"Enzyme catalysis T-dependence","text":"That said, having the option to use different model forumations and actually using the ones that are implemented in land surface models directly when fitting leaf level measurements seems to be a prudent way to improve models in the future. More leaf level data might help in the future, especially looking at temperature dependencies, mesophyll conductance, and fluorescence yields. So many chemical and phsyical aspects change with temperature that it is hard to isolate impacting factors. Now, at least, we can run the models directly in the REPL, which is great for prototyping anc validating the model on the individual module level without any effort in terms of additional coding.","category":"page"},{"location":"generated/Leaf-Photosynthesis-Rates/#","page":"Enzyme catalysis T-dependence","title":"Enzyme catalysis T-dependence","text":"","category":"page"},{"location":"generated/Leaf-Photosynthesis-Rates/#","page":"Enzyme catalysis T-dependence","title":"Enzyme catalysis T-dependence","text":"This page was generated using Literate.jl.","category":"page"},{"location":"pages/CanopyRT/#CanopyRT-module-for-the-LAND-model-1","page":"CanopyRT","title":"CanopyRT module for the LAND model","text":"","category":"section"},{"location":"pages/CanopyRT/#Canopy-RT-functions-1","page":"CanopyRT","title":"Canopy RT functions","text":"","category":"section"},{"location":"pages/CanopyRT/#","page":"CanopyRT","title":"CanopyRT","text":"These are the functions being used in the Canopy RT module to do all the fun stuff (need to add more text here later)","category":"page"},{"location":"pages/CanopyRT/#","page":"CanopyRT","title":"CanopyRT","text":"Land.CanopyRT.compute_canopy_geometry!\nLand.CanopyRT.compute_canopy_matrices!\nLand.CanopyRT.simulate_short_wave!\nLand.CanopyRT.derive_canopy_fluxes!\nLand.CanopyRT.compute_diffusive_S\nLand.CanopyRT.compute_thermal_fluxes!\nLand.CanopyRT.initialize_rt_module\nLand.CanopyRT.computeSIF_Fluxes!\nLand.CanopyRT.fluspect!\nLand.CanopyRT.calctav","category":"page"},{"location":"pages/CanopyRT/#Land.CanopyRT.compute_canopy_geometry!","page":"CanopyRT","title":"Land.CanopyRT.compute_canopy_geometry!","text":"compute_canopy_geometry!(\n            can::Canopy4RT{FT},\n            angle::SolarAngles{FT},\n            cO::AbstractCanopyOpti)\n\nComputes canopy optical properties (extinction coefficients for direct and diffuse light) based on the SAIL model. Most important input parameters are leaf inclination and azimuth distribution functions and sun-sensor geometry. Canopy clumping Ω is implemented as in Pinty et al (2015).\n\ncan A Canopy4RT type struct, providing canopy structure information\nangle A SolarAngles type struct, defining sun-sensor geometry\ncO An CanopyOptiArray type, where optical properties will be stored\n\n\n\n\n\n","category":"function"},{"location":"pages/CanopyRT/#Land.CanopyRT.compute_canopy_matrices!","page":"CanopyRT","title":"Land.CanopyRT.compute_canopy_matrices!","text":"compute_canopy_matrices!(leaf_array::Array,\n                             cO::AbstractCanopyOpti)\n\nCompute scattering coefficient matrices for direct and diffuse light given geometry dependent overall extinction coefficients and pigment dependent leaf reflectance and transmission (computed via fluspect). This function has to be called before simulate_short_wave! can be used.\n\nleaf_array An array of LeafBioArray type struct (i.e. leaf optical properties can change with canopy height)\ncO An AbstractCanopyOpti type struct, will be updated within this function call.\n\n\n\n\n\n","category":"function"},{"location":"pages/CanopyRT/#Land.CanopyRT.simulate_short_wave!","page":"CanopyRT","title":"Land.CanopyRT.simulate_short_wave!","text":"simulate_short_wave!(can::Canopy4RT{FT},\n                     cO::AbstractCanopyOpti,\n                     cR::CanopyRadiation,\n                     sun::AbstractIncomingRadiation,\n                     sO::SoilOpti)\n\nSimulate the short wave radiation through the canopy, given\n\ncan A Canopy4RT type struct for providing LAI and nlayers and clumping\ncO A CanopyOptiArray struct for providing optical layer properties\ncR A CanopyRadiation struct\nsun An IncomingRadiationArray struct\nsO A SoilOpti type struct for soil optical properties\n\n\n\n\n\n","category":"function"},{"location":"pages/CanopyRT/#Land.CanopyRT.derive_canopy_fluxes!","page":"CanopyRT","title":"Land.CanopyRT.derive_canopy_fluxes!","text":"derive_canopy_fluxes!(can::Canopy4RT{FT},\n                           cO::AbstractCanopyOpti,\n                           cR::CanopyRadiation,\n                           sun::AbstractIncomingRadiation,\n                           so::SoilOpti{FT},\n                           leaf_array::Array,\n                           wl_set::AbstractWLParaSet) where {FT}\n\nComputes a variety of integrated fluxes from the spectrally resolved computations in the short-wave Canopy RT (e.g. absorbed soil radiation, absorbed direct and diffuse PAR by layer (and angles for direct), net direct and diffuse energy balance per layer)\n\ncan A Canopy4RT struct\ncO A CanopyOptiArray struct\ncR A CanopyRadiation struct\nsun An IncomingRadiationArray struct\nsO A SoilOpti type struct for soil optical properties\nleaf_array An array of LeafBioArray type struct (i.e. leaf optical properties can change with canopy height)\nwl_set An WLParaSetArray type struct\n\n\n\n\n\n","category":"function"},{"location":"pages/CanopyRT/#Land.CanopyRT.compute_diffusive_S","page":"CanopyRT","title":"Land.CanopyRT.compute_diffusive_S","text":"compute_diffusive_S(τ_dd::Array,\n                    ρ_dd::Array,\n                    S⁻::Array,\n                    S⁺::Array,\n                    boundary_top::Array,\n                    boundary_bottom::Array,\n                    rsoil::Array)\n\nComputes 2-stream diffusive radiation transport (used for thermal and SIF) given:\n\nτ_dd A 2D Array with layer reflectances\nρ_dd A 2D Array with layer transmissions\nS⁻   A 2D Array with layer source terms in the downwelling direction\nS⁺   A 2D Array with layer source terms in the upwelling direction\nboundary_top    A 1D array with downwelling radiation at the top (top of canopy)\nboundary_bottom A 1D array with upwnwelling radiation at the bottom (soil)\nrsoil A 1D array with soil reflectance\n\n\n\n\n\n","category":"function"},{"location":"pages/CanopyRT/#Land.CanopyRT.compute_thermal_fluxes!","page":"CanopyRT","title":"Land.CanopyRT.compute_thermal_fluxes!","text":"compute_thermal_fluxes!(leaf_array::Array,\n                             cO::AbstractCanopyOpti,\n                             cR::CanopyRadiation,\n                             can::Canopy4RT{FT},\n                             so::SoilOpti{FT},\n                             incLW::Array,\n                             wl_set::AbstractWLParaSet) where {FT}\n\nComputes 2-stream diffusive radiation transport for thermal radiation (calls compute_diffusive_S internally). Layer reflectance and transmission is computed from LW optical properties, layer sources from temperature and Planck law, boundary conditions from the atmosphere and soil emissivity and temperature. Currently only uses Stefan Boltzmann law to compute spectrally integrated LW but can be easily adjusted to be spectrally resolved.\n\nleaf_array An array of LeafBioArray type struct (i.e. leaf optical properties can change with canopy height)\ncO A CanopyOptiArray struct for providing optical layer properties\ncR A CanopyRadiation struct\ncan A Canopy4RT type struct for providing LAI and nlayers and clumping\nsO A SoilOpti type struct for soil optical properties\nincLW A 1D array with incoming long-wave radiation\nwl_set An WLParaSetArray type struct\n\n\n\n\n\n","category":"function"},{"location":"pages/CanopyRT/#Land.CanopyRT.initialize_rt_module","page":"CanopyRT","title":"Land.CanopyRT.initialize_rt_module","text":"initialize_rt_module(; n_layer::Int=20, LAI::FT=FT(3.0), using_marray=false)\n\nInitialize the RT module so as to interface with Plant, given\n\nn_layer Number of canopy layers\nLAI Leaf area index\n\nNote it here that the structcanopy is used in CanopyRT module. This function initializes `canopyrt,canOptrt,canRadrt,arrayOfLeaves` as local variables rather than global variables as in CanopyRT module. See CanopyRT module for further operations on these variables.\n\n\n\n\n\n","category":"function"},{"location":"pages/CanopyRT/#Land.CanopyRT.computeSIF_Fluxes!","page":"CanopyRT","title":"Land.CanopyRT.computeSIF_Fluxes!","text":"computeSIF_Fluxes!(leaf::Array,\n                   cO::AbstractCanopyOpti,\n                   cR::CanopyRadiation,\n                   can::Canopy4RT{FT},\n                   so::SoilOpti{FT},\n                   wl_set::AbstractWLParaSet) where {FT}\n\nComputes 2-stream diffusive radiation transport for SIF radiation (calls compute_diffusive_S internally). Layer reflectance and transmission is computed from SW optical properties, layer sources from absorbed light and SIF efficiencies. Boundary conditions are zero SIF incoming from atmosphere or soil.\n\nleaf_array An array of LeafBioArray type struct (i.e. leaf optical properties can change with canopy height)\ncO A CanopyOptiArray struct for providing optical layer properties\ncR A CanopyRadiation struct\ncan A Canopy4RT type struct for providing LAI and nlayers and clumping\nsO A SoilOpti type struct for soil optical properties\nwl_set An WLParaSetArray type struct\n\n\n\n\n\n","category":"function"},{"location":"pages/CanopyRT/#Land.CanopyRT.fluspect!","page":"CanopyRT","title":"Land.CanopyRT.fluspect!","text":"fluspect!(leaf::AbstractLeafBio,\n          wl_set::AbstractWLParaSet\n\nComputes leaf optical properties (reflectance and transittance) based on pigment concentrations. Also computes Fluorescence excitation matrices. Mostly based on PROSPECT-D for leaf reflectance/transmission and FluSpec for fluorescence.\n\nleaf ALeafBioArray type struct (includes pigment concentrations, water content, leaf structure)\nwl_set An WLParaSetArray type struct, which defines fluoresence excitation and emission wavelengths\n\n\n\n\n\n","category":"function"},{"location":"pages/CanopyRT/#Land.CanopyRT.calctav","page":"CanopyRT","title":"Land.CanopyRT.calctav","text":"calctav(α,nr)\n\nComputes transmission of isotropic radiation across an interface between two dielectrics (Stern F. (1964), Allen W.A. (1973)). From calctav.m in PROSPECT-D\n\nα angle of incidence\nnr Index of refraction\n\n\n\n\n\n","category":"function"},{"location":"pages/CanopyRT/#Canopy-RT-structures-1","page":"CanopyRT","title":"Canopy RT structures","text":"","category":"section"},{"location":"pages/CanopyRT/#Canopy-1","page":"CanopyRT","title":"Canopy","text":"","category":"section"},{"location":"pages/CanopyRT/#","page":"CanopyRT","title":"CanopyRT","text":"Land.CanopyRT.Canopy4RT","category":"page"},{"location":"pages/CanopyRT/#Land.CanopyRT.Canopy4RT","page":"CanopyRT","title":"Land.CanopyRT.Canopy4RT","text":"struct Canopy4RT\n\nA canopy struct for the radiation transfer module\n\nFields\n\nnlayers\nNumber of canopy layers\nLAI\nLeaf Area Index\nΩ\nClumping factor\nclump_a\nStructure factor a\nclump_b\nStructure factor b\nleaf_width\nLeaf width\nhc\nVegetation height\nLIDFa\nLeaf Inclination\nLIDFb\nVariation in leaf inclination\nhot\nHotSpot parameter (still need to check!)\nheight\nCanopy height [m]\nz0m\nCanopy roughness [m]\nz0h\nTree roughtnes [m]\nd\nCanopy displacement height [m]\nCd\nm/sqrt(s) turbulent transfer coefficient\nlitab\nlitab_bnd\nlazitab\nlidf\nxl\ndx\n\n\n\n\n\n","category":"type"},{"location":"pages/CanopyRT/#Canopy-optical-parameters-1","page":"CanopyRT","title":"Canopy optical parameters","text":"","category":"section"},{"location":"pages/CanopyRT/#","page":"CanopyRT","title":"CanopyRT","text":"Land.CanopyRT.AbstractCanopyOpti\nLand.CanopyRT.CanopyOptiArray\nLand.CanopyRT.CanopyOptiMArray\nLand.CanopyRT.create_canopy_optical","category":"page"},{"location":"pages/CanopyRT/#Land.CanopyRT.AbstractCanopyOpti","page":"CanopyRT","title":"Land.CanopyRT.AbstractCanopyOpti","text":"AbstractCanopyOpti\n\nA abstract type for canopy optical properties\n\n\n\n\n\n","category":"type"},{"location":"pages/CanopyRT/#Land.CanopyRT.CanopyOptiArray","page":"CanopyRT","title":"Land.CanopyRT.CanopyOptiArray","text":"struct CanopyOptiArray{FT, nWL, nLayer, nLevel, nAzi, nIncl}\n\nA struct for canopy optical properties using Array\n\nFields\n\nsdb\nSolar -> Diffuse backscatter weight\nsdf\nSolar -> Diffuse forward scatter weight\ndob\nDiffuse -> Directional backscatter weight\ndof\nDiffuse -> Directional forward scatter weight\nddb\nDiffuse -> Diffuse backscatter weight\nddf\nDiffuse -> Diffuse forward scatter weight\nks\nSolar beam extinction coefficient weight\nko\nOutgoing beam extinction coefficient weight\nbf\n?\nsob\nWeight of specular2directional backscatter coefficient\nsof\nWeight of specular2directional forward coefficient\nPs\nProbability of directly viewing a leaf in solar direction\nPo\nProbability of directly viewing a leaf in viewing direction\nPso\nBi-directional probability of directly viewing a leaf (solar->canopy->viewing)\nfs\nconversion factor fs to compute irradiance on inclined leaf\nabsfs\nabs(fs)\nabsfsfo\nabs(fs*fo)\nfsfo\nfs*fo\nfo\nconversion factor fo for angle towards observer (not sun like fs)\ncosΘ_l\nCosine of leaf azimuths\ncos2Θ_l\ncos of leaf azimuth sqared\nsigb\ndiffuse     backscatter scattering coefficient for diffuse  incidence\nsigf\ndiffuse     forward     scattering coefficient for diffuse  incidence\nsb\ndiffuse     backscatter scattering coefficient for specular incidence\nsf\ndiffuse     forward     scattering coefficient for specular incidence\nvb\ndirectional backscatter scattering coefficient for diffuse  incidence\nvf\ndirectional forward     scattering coefficient for diffuse  incidence\nw\nbidirectional scattering coefficent (directional-directional)\na\nattenuation\nXsd\nEffective layer transmittance (direct->diffuse)\nXdd\nEffective layer transmittance (diffuse->diffuse)\nR_sd\nEffective layer reflectance (direct->diffuse)\nR_dd\nEffective layer reflectance (diffuse->diffuse)\nEs_\nSolar direct radiation per layer)\n\n\n\n\n\n","category":"type"},{"location":"pages/CanopyRT/#Land.CanopyRT.CanopyOptiMArray","page":"CanopyRT","title":"Land.CanopyRT.CanopyOptiMArray","text":"struct CanopyOptiMArray{FT, nWL, nLayer, nLevel, nAzi, nIncl, nLayer_nWL, nLev_nWL, nIncl_nAzi}\n\nA struct for canopy optical properties using MArray\n\nFields\n\nsdb\nSolar -> Diffuse backscatter weight\nsdf\nSolar -> Diffuse forward scatter weight\ndob\nDiffuse -> Directional backscatter weight\ndof\nDiffuse -> Directional forward scatter weight\nddb\nDiffuse -> Diffuse backscatter weight\nddf\nDiffuse -> Diffuse forward scatter weight\nks\nSolar beam extinction coefficient weight\nko\nOutgoing beam extinction coefficient weight\nbf\n?\nsob\nWeight of specular2directional backscatter coefficient\nsof\nWeight of specular2directional forward coefficient\nPs\nProbability of directly viewing a leaf in solar direction\nPo\nProbability of directly viewing a leaf in viewing direction\nPso\nBi-directional probability of directly viewing a leaf (solar->canopy->viewing)\nfs\nconversion factor fs to compute irradiance on inclined leaf\nabsfs\nabs(fs)\nabsfsfo\nabs(fs*fo)\nfsfo\nfs*fo\nfo\nconversion factor fo for angle towards observer (not sun like fs)\ncosΘ_l\nCosine of leaf azimuths\ncos2Θ_l\ncos of leaf azimuth sqared\nsigb\ndiffuse     backscatter scattering coefficient for diffuse  incidence\nsigf\ndiffuse     forward     scattering coefficient for diffuse  incidence\nsb\ndiffuse     backscatter scattering coefficient for specular incidence\nsf\ndiffuse     forward     scattering coefficient for specular incidence\nvb\ndirectional backscatter scattering coefficient for diffuse  incidence\nvf\ndirectional forward     scattering coefficient for diffuse  incidence\nw\nbidirectional scattering coefficent (directional-directional)\na\nattenuation\nXsd\nEffective layer transmittance (direct->diffuse)\nXdd\nEffective layer transmittance (diffuse->diffuse)\nR_sd\nEffective layer reflectance (direct->diffuse)\nR_dd\nEffective layer reflectance (diffuse->diffuse)\nEs_\nSolar direct radiation per layer)\n\n\n\n\n\n","category":"type"},{"location":"pages/CanopyRT/#Land.CanopyRT.create_canopy_optical","page":"CanopyRT","title":"Land.CanopyRT.create_canopy_optical","text":"create_canopy_optical(FType, nWL::Int, nLayers::Int, nAzi::Int, nIncl::Int; using_marray=false)\n\nCreate a canopy optical properties struct with an using_marray option, given\n\nFType Floating number type\nnWL Number of wave length\nnLayers Number of canopy layers\nnAzi Number of arimuth angles\nAIncl Number of inclination angles\nusing_marray If true, using MArray; else, using Array\n\n\n\n\n\n","category":"function"},{"location":"pages/CanopyRT/#Canopy-radiation-1","page":"CanopyRT","title":"Canopy radiation","text":"","category":"section"},{"location":"pages/CanopyRT/#","page":"CanopyRT","title":"CanopyRT","text":"Land.CanopyRT.CanopyRadiation\nLand.CanopyRT.AbstractIncomingRadiation\nLand.CanopyRT.IncomingRadiationArray\nLand.CanopyRT.IncomingRadiationMArray\nLand.CanopyRT.create_incoming_radiation","category":"page"},{"location":"pages/CanopyRT/#Land.CanopyRT.CanopyRadiation","page":"CanopyRT","title":"Land.CanopyRT.CanopyRadiation","text":"struct CanopyRadiation{FT, nWl, nWlF, nIncl, nAzi, nLayers}\n\nA struct for canopy radiation information\n\nFields\n\nintEout\nIntegrated TOC outgoing flux [W m⁻²]\nincomingPAR\nIncident spectrally integrated total PAR [mol m⁻² s⁻¹]\nincomingPAR_direct\nIncident spectrally integrated direct PAR [mol m⁻² s⁻¹]\nincomingPAR_diffuse\nIncident spectrally integrated diffuse PAR [mol m⁻² s⁻¹]\nRnSoil_diffuse\nNet radiation of shaded soil [W m⁻²]\nRnSoil_direct\nNet Short-wave radiation of sunlit soil [W m⁻²]\nRnSoil\nNet Short-wave radiation of soil (shaded + sunlit) [W m⁻²]\nRnSoilLW\nNet long-wave radiation of soil (shaded + sunlit) [W m⁻²]\nabsPAR_shade\nNet PAR of shaded leaves [mol m⁻² s⁻¹]\nabsPAR_shadeCab\nNet PAR by Cab+Car of shaded leaves [moles m⁻² s⁻¹]\nintNetSW_sunlit\nSpectrally integrated net absorbed direct radiation in each layer [W m⁻²)]\nintNetSW_shade\nSpectrally integrated net absorbed diffuse radiation in each layer [W m⁻²)]\nintNetLW_sunlit\nSpectrally integrated net absorbed direct radiation in each layer [W m⁻²)]\nintNetLW_shade\nSpectrally integrated net absorbed diffuse radiation in each layer [W m⁻²)]\nT_sun\nLeaf temperature (sunlit) [K]\nT_shade\nLeaf temperature (shaded) [K]\nϕ_shade\nFluorescence yield for shaded leaves\nH_shade\nSensible Heat flux H of shaded leaves [W m⁻²]\nLE_shade\nLatent Heat flux LE of shaded leaves [W m⁻²]\nNPQ_shade\nNPQ of shaded leaves\nGPP_shade\nGPP of shaded leaves [μmol m⁻² s⁻¹]\ngs_shade\ngs of shaded leaves [mol m⁻² s⁻¹]\nψl_shade\nLeaf water potential of shaded leaves [MPa]\nCc_shade\nCc of shaded leaves [µmol/mol]\nPi_shade\ninternal CO₂ concentration of shaded leaves [µmol/mol]\nLo\nShort-wave TOC outgoing radiance in observation direction [mW m⁻² nm⁻¹ sr⁻¹]\nEout\nShort-wave TOC outgoing radiation [mW m⁻² nm⁻¹]\nalb_obs\nShort-wave Albedo in viewing direction\nalb_direct\nShort-wave Albedo for direct incoming radiation\nalb_diffuse\nShort-wave Albedo for diffuse incoming radiation\nE_up\nUpwelling diffuse short-wave radiation within canopy [mW m⁻² nm⁻¹]\nE_down\nDownwelling diffuse short-wave radiation within canopy [mW m⁻² nm⁻¹]\nnetSW_sunlit\nNet absorbed direct radiation in each layer [mW m⁻² nm⁻¹]\nnetSW_shade\nnet absorbed diffuse radiation in each layer [mW m⁻² nm⁻¹]\nabsPAR_sun\nnet PAR of sunlit leaves [mol m⁻² s⁻¹]\nabsPAR_sunCab\nnet PAR by Cab+Car of sunlit leaves [mol m⁻² s⁻¹]\nT_sun3D\nLeaf temperature (sunlit) [K]\nϕ_sun\nFluorescence yield for sunlit leaves\nH_sun\nSensible Heat flux H of sunlit leaves [W m⁻²]\nLE_sun\nLatent Heat flux LE of sunlit leaves [W m⁻²]\nNPQ_sun\nNPQ of sunlit leaves\nGPP_sun\nGPP of sunlit leaves [μmol m⁻² s⁻¹]\ngs_sun\ngs of sunlit leaves [mol m⁻² s⁻¹]\nψl_sun\nLeaf water potential of sunlit leaves [MPa]\nCc_sun\nCc of sunlit leaves [µmol/mol]\nPi_sun\nInternal CO₂ concentration of sunlit leaves [µmol/mol]\nSIF_hemi\nHemispheric total outgoing SIF flux [mW m⁻² nm⁻¹])\nSIF_obs\nObserver-direction outgoing SIF radiance  (mW m⁻² nm⁻¹ sr⁻¹))\nSIF_obs_sunlit\nObserver-direction outgoing SIF radiance, sunlit leaves  (mW m⁻² nm⁻¹ sr⁻¹))\nSIF_obs_shaded\nObserver-direction outgoing SIF radiance, shaded leaves  (mW m⁻² nm⁻¹ sr⁻¹))\nSIF_obs_scattered\nObserver-direction outgoing SIF radiance, scattered   (mW m⁻² nm⁻¹ sr⁻¹))\nSIF_obs_soil\nObserver-direction outgoing SIF radiance, soil-reflected  (mW m⁻² nm⁻¹ sr⁻¹))\nSIF_sum\nTotal SIF sum of layer sources  [mW m⁻² nm⁻¹])\n\n\n\n\n\n","category":"type"},{"location":"pages/CanopyRT/#Land.CanopyRT.AbstractIncomingRadiation","page":"CanopyRT","title":"Land.CanopyRT.AbstractIncomingRadiation","text":"AbstractIncomingRadiation\n\nAbstract leaf biological parameters type\n\n\n\n\n\n","category":"type"},{"location":"pages/CanopyRT/#Land.CanopyRT.IncomingRadiationArray","page":"CanopyRT","title":"Land.CanopyRT.IncomingRadiationArray","text":"struct IncomingRadiationArray{FT}\n\nIncoming radiation information.\n\nFields\n\nwl\nWavelength [nm]\nE_direct\nDirect incoming radiation [mW m⁻² nm⁻¹]\nE_diffuse\nDiffuse incoming radiation [mW m⁻² nm⁻¹]\n\n\n\n\n\n","category":"type"},{"location":"pages/CanopyRT/#Land.CanopyRT.IncomingRadiationMArray","page":"CanopyRT","title":"Land.CanopyRT.IncomingRadiationMArray","text":"struct IncomingRadiationMArray{FT, N}\n\nIncoming radiation information.\n\nFields\n\nwl\nWavelength [nm]\nE_direct\nDirect incoming radiation [mW m⁻² nm⁻¹]\nE_diffuse\nDiffuse incoming radiation [mW m⁻² nm⁻¹]\n\n\n\n\n\n","category":"type"},{"location":"pages/CanopyRT/#Land.CanopyRT.create_incoming_radiation","page":"CanopyRT","title":"Land.CanopyRT.create_incoming_radiation","text":"create_incoming_radiation(FType, swl:Array, file; using_marray=false)\n\nCreate an AbstractIncomingRadiation struct, given\n\nFType Floating number type\nswl Standard wave length\nfile Input file name\nusing_marray If true, use MArray; else, using Array\n\n\n\n\n\n","category":"function"},{"location":"pages/CanopyRT/#Leaf-biological-parameters-1","page":"CanopyRT","title":"Leaf biological parameters","text":"","category":"section"},{"location":"pages/CanopyRT/#","page":"CanopyRT","title":"CanopyRT","text":"Land.CanopyRT.AbstractLeafBio\nLand.CanopyRT.LeafBioArray\nLand.CanopyRT.LeafBioMArray\nLand.CanopyRT.create_leaf_bio","category":"page"},{"location":"pages/CanopyRT/#Land.CanopyRT.AbstractLeafBio","page":"CanopyRT","title":"Land.CanopyRT.AbstractLeafBio","text":"AbstractLeafBio\n\nAbstract leaf biological parameters type\n\n\n\n\n\n","category":"type"},{"location":"pages/CanopyRT/#Land.CanopyRT.LeafBioArray","page":"CanopyRT","title":"Land.CanopyRT.LeafBioArray","text":"struct LeafBioArray{FT, nWl, nWle, nWlf}\n\nA struct of leaf biological parameters using Array\n\nFields\n\nN\nLeaf structure parameter\nCab\nChlorophyll a+b content [µg cm⁻²]\nCar\nCarotenoid content [µg cm⁻²]\nAnt\nAnthocynanin content [µg cm⁻²]\nCs\nSenescent material fraction\nCw\nEquivalent water thickness [cm]\nCm\nDry matter content (dry leaf mass per unit area) [g cm⁻²]\nCx\nFractionation between Zeaxanthin and Violaxanthin in Car (1=all Zeaxanthin) (-)\nρ_LW\nBroadband thermal reflectance (-)\nτ_LW\nBroadband thermal transmission (-)\nfqe\nLeaf fluorescence efficiency (Fo standard)\nρ_SW\nShortwave leaf reflectance\nτ_SW\nShortwave leaf transmission\nkChlrel\nRelative absorbtion by Chlorophyll+Car\nkChlrel_old\nRelative absorbtion by Chlorophyll\nMb\nFluorescence excitation matrix backwards\nMf\nFluorescence excitation matrix forwards\nndub\nDoubling adding layers\n\n\n\n\n\n","category":"type"},{"location":"pages/CanopyRT/#Land.CanopyRT.LeafBioMArray","page":"CanopyRT","title":"Land.CanopyRT.LeafBioMArray","text":"struct LeafBioMArray{FT, nWl, nWle, nWlf, nWLe_nWLf}\n\nA struct of leaf biological parameters using Array\n\nFields\n\nN\nLeaf structure parameter\nCab\nChlorophyll a+b content [µg cm⁻²]\nCar\nCarotenoid content [µg cm⁻²]\nAnt\nAnthocynanin content [µg cm⁻²]\nCs\nSenescent material fraction\nCw\nEquivalent water thickness [cm]\nCm\nDry matter content (dry leaf mass per unit area) [g cm⁻²]\nCx\nFractionation between Zeaxanthin and Violaxanthin in Car (1=all Zeaxanthin)\nρ_LW\nBroadband thermal reflectance\nτ_LW\nBroadband thermal transmission\nfqe\nLeaf fluorescence efficiency (Fo standard)\nρ_SW\nShortwave leaf reflectance\nτ_SW\nShortwave leaf transmission\nkChlrel\nRelative absorbtion by Chlorophyll+Car\nkChlrel_old\nRelative absorbtion by Chlorophyll\nMb\nFluorescence backward excitation matrix\nMf\nFluorescence forward excitation matrix\nndub\nDoubling adding layers\n\n\n\n\n\n","category":"type"},{"location":"pages/CanopyRT/#Land.CanopyRT.create_leaf_bio","page":"CanopyRT","title":"Land.CanopyRT.create_leaf_bio","text":"create_leaf_bio(FT, nWl::Int, nWle::Int, nWlf::Int; using_marray=false)\n\nCreate a leaf biological parameters struct with an using_marray option, given\n\nFType Floating number type\nnWl Number of wave length\nnWle Number of excitation wave length\nnWlf Number of fluorescence wave length\nusing_marray If true, using MArray; else, using Array\n\nReturns a LeafBioMArray or LeafBioArray type struct.\n\n\n\n\n\n","category":"function"},{"location":"pages/CanopyRT/#Leaf-optical-parameters-1","page":"CanopyRT","title":"Leaf optical parameters","text":"","category":"section"},{"location":"pages/CanopyRT/#","page":"CanopyRT","title":"CanopyRT","text":"Land.CanopyRT.AbstractLeafOptiPara\nLand.CanopyRT.LeafOptiParaArray\nLand.CanopyRT.LeafOptiParaMArray\nLand.CanopyRT.create_opti_par","category":"page"},{"location":"pages/CanopyRT/#Land.CanopyRT.AbstractLeafOptiPara","page":"CanopyRT","title":"Land.CanopyRT.AbstractLeafOptiPara","text":"AbstractLeafOptiPara\n\nAbstract leaf optical parameter\n\n\n\n\n\n","category":"type"},{"location":"pages/CanopyRT/#Land.CanopyRT.LeafOptiParaArray","page":"CanopyRT","title":"Land.CanopyRT.LeafOptiParaArray","text":"struct LeafOptiParaArray{FT, N}\n\nStruct for leaf optical properties using Array\n\nFields\n\nnr\nKm\nKab\nKant\nKcar\nKw\nKBrown\nphi\nKcaV\nKcaZ\nlambda\n\n\n\n\n\n","category":"type"},{"location":"pages/CanopyRT/#Land.CanopyRT.LeafOptiParaMArray","page":"CanopyRT","title":"Land.CanopyRT.LeafOptiParaMArray","text":"struct LeafOptiParaMArray{FT, N}\n\nStruct for leaf optical properties using MArray\n\nFields\n\nnr\nKm\nKab\nKant\nKcar\nKw\nKBrown\nphi\nKcaV\nKcaZ\nlambda\n\n\n\n\n\n","category":"type"},{"location":"pages/CanopyRT/#Land.CanopyRT.create_opti_par","page":"CanopyRT","title":"Land.CanopyRT.create_opti_par","text":"create_opti_par(FType, swl::Array, file; using_marray=false)\n\nCreate an AbstractLeafOptiPara struct, given\n\nFType Floating number type\nswl Standard wave length\nfile Input file name\nusing_marray If true, use MArray; else, using Array\n\n\n\n\n\n","category":"function"},{"location":"pages/CanopyRT/#Soil-1","page":"CanopyRT","title":"Soil","text":"","category":"section"},{"location":"pages/CanopyRT/#","page":"CanopyRT","title":"CanopyRT","text":"Land.CanopyRT.SoilOpti","category":"page"},{"location":"pages/CanopyRT/#Land.CanopyRT.SoilOpti","page":"CanopyRT","title":"Land.CanopyRT.SoilOpti","text":"struct SoilOpti{FT}\n\nA struct of soil optical parameters\n\nFields\n\nwl\nWavelength [nm]\nalbedo_SW\nShortwave albedo\nalbedo_LW\nLongwave albedo\nsoil_skinT\nSoil surface temperature [K]\n\n\n\n\n\n","category":"type"},{"location":"pages/CanopyRT/#Solar-angles-1","page":"CanopyRT","title":"Solar angles","text":"","category":"section"},{"location":"pages/CanopyRT/#","page":"CanopyRT","title":"CanopyRT","text":"Land.CanopyRT.SolarAngles","category":"page"},{"location":"pages/CanopyRT/#Land.CanopyRT.SolarAngles","page":"CanopyRT","title":"Land.CanopyRT.SolarAngles","text":"struct SolarAngles{FT}\n\nStruct for observation and solar angles\n\nFields\n\ntts\nSolar Zenith Angle [degree]\ntto\nViewing Zenith Angle in [degree]\npsi\nrelative azimuth in [degree]\n\n\n\n\n\n","category":"type"},{"location":"pages/CanopyRT/#Pre-set-wave-length-settings-1","page":"CanopyRT","title":"Pre-set wave length settings","text":"","category":"section"},{"location":"pages/CanopyRT/#","page":"CanopyRT","title":"CanopyRT","text":"Land.CanopyRT.AbstractWLParaSet\nLand.CanopyRT.WLParaSetArray\nLand.CanopyRT.WLParaSetMArray\nLand.CanopyRT.create_wl_para_set","category":"page"},{"location":"pages/CanopyRT/#Land.CanopyRT.AbstractWLParaSet","page":"CanopyRT","title":"Land.CanopyRT.AbstractWLParaSet","text":"AbstractWLParaSet\n\nAn abstract type for wave length parameter set, which corresponds to the AbstractLeafOptiPara\n\n\n\n\n\n","category":"type"},{"location":"pages/CanopyRT/#Land.CanopyRT.WLParaSetArray","page":"CanopyRT","title":"Land.CanopyRT.WLParaSetArray","text":"struct WLParaSetArray{FT}\n\nStruct for pre-set wave length parameters.\n\nFields\n\nminwlPAR\nMinimal WL for PAR [nm]\nmaxwlPAR\nMaximal WL for PAR [nm]\nminwle\nMinimal WL for SIF excitation [nm]\nmaxwle\nMaximal WL for SIF excitation [nm]\nminwlf\nMinimal WL for SIF emission/fluorescence [nm]\nmaxwlf\nMaximal WL for SIF emission/fluorescence [nm]\nswl\nStandard wave length [nm]\ndwl\nDifferential wavelength\noptis\nLeaf optical parameter set\nwl\nWave length [nm]\nnwl\nLength of wl\nIwle\nIndex of wle in wl\nIwlf\nIndex of wlf in wl\nnWlE\nlength of wle\nnWlF\nlength of wlf\niPAR\nindex of wlPAR in wl\nwle\nexcitation wave length [nm]\nwlf\nFluorescence wave length [nm]\n\n\n\n\n\n","category":"type"},{"location":"pages/CanopyRT/#Land.CanopyRT.WLParaSetMArray","page":"CanopyRT","title":"Land.CanopyRT.WLParaSetMArray","text":"struct WLParaSetMArray{FT}\n\nStruct for pre-set wave length parameters.\n\nTODO add MArray version?\n\nFields\n\nminwlPAR\nMinimal WL for PAR [nm]\nmaxwlPAR\nMaximal WL for PAR [nm]\nminwle\nMinimal WL for SIF excitation [nm]\nmaxwle\nMaximal WL for SIF excitation [nm]\nminwlf\nMinimal WL for SIF emission/fluorescence [nm]\nmaxwlf\nMaximal WL for SIF emission/fluorescence [nm]\nswl\nStandard wave length [nm]\ndwl\nDifferential wavelength\noptis\nLeaf optical parameter set\nwl\nWave length [nm]\nnwl\nLength of wl\nIwle\nIndex of wle in wl\nIwlf\nIndex of wlf in wl\nnWlE\nlength of wle\nnWlF\nlength of wlf\niPAR\nindex of wlPAR in wl\nwle\nexcitation wave length [nm]\nwlf\nFluorescence wave length [nm]\n\n\n\n\n\n","category":"type"},{"location":"pages/CanopyRT/#Land.CanopyRT.create_wl_para_set","page":"CanopyRT","title":"Land.CanopyRT.create_wl_para_set","text":"create_wl_para_set(FType; using_marray::Bool=false)\n\nCreate a pre-set struct of wave length settings, given\n\nFtype Floating number type\nusing_marray If true, use MArray; else, use Array.\n\nTODO add MArray version?\n\n\n\n\n\n","category":"function"},{"location":"pages/Utils/#Utils-for-the-LAND-model-1","page":"Utils","title":"Utils for the LAND model","text":"","category":"section"},{"location":"pages/Utils/#LandParameters-module-1","page":"Utils","title":"LandParameters module","text":"","category":"section"},{"location":"pages/Utils/#","page":"Utils","title":"Utils","text":"Land.LandParameters.EarthParameterSet\nLand.LandParameters.EARTH\nLand.LandParameters.AVOGADRO\nLand.LandParameters.CP_D\nLand.LandParameters.CP_I\nLand.LandParameters.CP_L\nLand.LandParameters.CP_V\nLand.LandParameters.GAS_R\nLand.LandParameters.GRAVITY\nLand.LandParameters.H_PLANCK\nLand.LandParameters.K_0\nLand.LandParameters.K_25\nLand.LandParameters.K_BOLTZMANN\nLand.LandParameters.LH_S0\nLand.LandParameters.LH_V0\nLand.LandParameters.LIGHT_SPEED\nLand.LandParameters.MOLMASS_DRYAIR\nLand.LandParameters.MOLMASS_WATER\nLand.LandParameters.PRESS_TRIPLE\nLand.LandParameters.R_D\nLand.LandParameters.R_V\nLand.LandParameters.T_TRIPLE\nLand.LandParameters.VON_KARMAN_CONST\nLand.LandParameters.WATER_AIR_MRATIO\nLand.LandParameters.ρ_H₂O","category":"page"},{"location":"pages/Utils/#Land.LandParameters.EarthParameterSet","page":"Utils","title":"Land.LandParameters.EarthParameterSet","text":"Define a local struct inherited from AbstractEarthParameterSet  \n\n\n\n\n\n","category":"type"},{"location":"pages/Utils/#Land.LandParameters.EARTH","page":"Utils","title":"Land.LandParameters.EARTH","text":"Earth as EarthParameterSet \n\n\n\n\n\n","category":"constant"},{"location":"pages/Utils/#Land.LandParameters.AVOGADRO","page":"Utils","title":"Land.LandParameters.AVOGADRO","text":"Avogadro's number\n\n\n\n\n\n","category":"constant"},{"location":"pages/Utils/#Land.LandParameters.CP_D","page":"Utils","title":"Land.LandParameters.CP_D","text":"Isobaric specific heat of dry air [J kg⁻¹ K⁻¹] \n\n\n\n\n\n","category":"constant"},{"location":"pages/Utils/#Land.LandParameters.CP_I","page":"Utils","title":"Land.LandParameters.CP_I","text":"Isobaric specific heat of ice [J kg⁻¹ K⁻¹] \n\n\n\n\n\n","category":"constant"},{"location":"pages/Utils/#Land.LandParameters.CP_L","page":"Utils","title":"Land.LandParameters.CP_L","text":"Isobaric specific heat of liquid water [J kg⁻¹ K⁻¹] \n\n\n\n\n\n","category":"constant"},{"location":"pages/Utils/#Land.LandParameters.CP_V","page":"Utils","title":"Land.LandParameters.CP_V","text":"Isobaric specific heat of water vapor vapor [J kg⁻¹ K⁻¹] \n\n\n\n\n\n","category":"constant"},{"location":"pages/Utils/#Land.LandParameters.GAS_R","page":"Utils","title":"Land.LandParameters.GAS_R","text":"Universal gas constant [J K⁻¹ mol⁻¹] \n\n\n\n\n\n","category":"constant"},{"location":"pages/Utils/#Land.LandParameters.GRAVITY","page":"Utils","title":"Land.LandParameters.GRAVITY","text":"Gravitational acceleration [m s⁻²] \n\n\n\n\n\n","category":"constant"},{"location":"pages/Utils/#Land.LandParameters.H_PLANCK","page":"Utils","title":"Land.LandParameters.H_PLANCK","text":"Planck constant [m² kg s⁻¹] \n\n\n\n\n\n","category":"constant"},{"location":"pages/Utils/#Land.LandParameters.K_0","page":"Utils","title":"Land.LandParameters.K_0","text":"Temperature at 0 Celcius [K] \n\n\n\n\n\n","category":"constant"},{"location":"pages/Utils/#Land.LandParameters.K_25","page":"Utils","title":"Land.LandParameters.K_25","text":"Temperature at 25 Celcius [K] \n\n\n\n\n\n","category":"constant"},{"location":"pages/Utils/#Land.LandParameters.K_BOLTZMANN","page":"Utils","title":"Land.LandParameters.K_BOLTZMANN","text":"Stefan-Boltzmann constant (W m⁻² K⁻⁴) \n\n\n\n\n\n","category":"constant"},{"location":"pages/Utils/#Land.LandParameters.LH_S0","page":"Utils","title":"Land.LandParameters.LH_S0","text":"Latent heat sublimation at T_triple [J kg⁻¹] \n\n\n\n\n\n","category":"constant"},{"location":"pages/Utils/#Land.LandParameters.LH_V0","page":"Utils","title":"Land.LandParameters.LH_V0","text":"Latent heat vaporization at T_triple [J kg⁻¹] \n\n\n\n\n\n","category":"constant"},{"location":"pages/Utils/#Land.LandParameters.LIGHT_SPEED","page":"Utils","title":"Land.LandParameters.LIGHT_SPEED","text":"Light speed [m s⁻¹] \n\n\n\n\n\n","category":"constant"},{"location":"pages/Utils/#Land.LandParameters.MOLMASS_DRYAIR","page":"Utils","title":"Land.LandParameters.MOLMASS_DRYAIR","text":"Mole mass of dry air [kg mol⁻¹] \n\n\n\n\n\n","category":"constant"},{"location":"pages/Utils/#Land.LandParameters.MOLMASS_WATER","page":"Utils","title":"Land.LandParameters.MOLMASS_WATER","text":"Mole mass of water [kg mol⁻¹] \n\n\n\n\n\n","category":"constant"},{"location":"pages/Utils/#Land.LandParameters.PRESS_TRIPLE","page":"Utils","title":"Land.LandParameters.PRESS_TRIPLE","text":"Triple point vapor pressure [Pa] \n\n\n\n\n\n","category":"constant"},{"location":"pages/Utils/#Land.LandParameters.R_D","page":"Utils","title":"Land.LandParameters.R_D","text":"Ideal gas constant for dry air [J kg⁻¹ K⁻¹] \n\n\n\n\n\n","category":"constant"},{"location":"pages/Utils/#Land.LandParameters.R_V","page":"Utils","title":"Land.LandParameters.R_V","text":"Ideal gas constant for water vapor [J kg⁻¹ K⁻¹] \n\n\n\n\n\n","category":"constant"},{"location":"pages/Utils/#Land.LandParameters.T_TRIPLE","page":"Utils","title":"Land.LandParameters.T_TRIPLE","text":"Triple point temperature [K] \n\n\n\n\n\n","category":"constant"},{"location":"pages/Utils/#Land.LandParameters.VON_KARMAN_CONST","page":"Utils","title":"Land.LandParameters.VON_KARMAN_CONST","text":"von Karman constant \n\n\n\n\n\n","category":"constant"},{"location":"pages/Utils/#Land.LandParameters.WATER_AIR_MRATIO","page":"Utils","title":"Land.LandParameters.WATER_AIR_MRATIO","text":"Ratio of molecular mass of water and dry air \n\n\n\n\n\n","category":"constant"},{"location":"pages/Utils/#Land.LandParameters.ρ_H₂O","page":"Utils","title":"Land.LandParameters.ρ_H₂O","text":"Density of water [kg m⁻³]\n\n\n\n\n\n","category":"constant"},{"location":"pages/Utils/#MathTools-module-1","page":"Utils","title":"MathTools module","text":"","category":"section"},{"location":"pages/Utils/#","page":"Utils","title":"Utils","text":"Land.MathTools.e2phot\nLand.MathTools.fast∫\nLand.MathTools.lower_quadratic\nLand.MathTools.quadratic\nLand.MathTools.volscatt\nLand.MathTools.weibull_k_ratio","category":"page"},{"location":"pages/Utils/#Land.MathTools.e2phot","page":"Utils","title":"Land.MathTools.e2phot","text":"e2phot(λ::Array{FT},E::Array{FT})\n\nCalculates the number of moles of photons, given\n\nλ An array of wave length in [nm], converted to [m] by _FAC\nE Joules of energy\n\n\n\n\n\n","category":"function"},{"location":"pages/Utils/#Land.MathTools.fast∫","page":"Utils","title":"Land.MathTools.fast∫","text":"fast∫(dx::Vector{FT}, f::Vector{FT})\n\nA fast way of integrating functions, given\n\ndx Delta x for each x\nf f(x) for each x\n\n\n\n\n\n","category":"function"},{"location":"pages/Utils/#Land.MathTools.lower_quadratic","page":"Utils","title":"Land.MathTools.lower_quadratic","text":"lower_quadratic(a::FT, b::FT, c::FT)\n\nReturn the lower quadratic solution or NaN, given\n\na Parameter in a*x^2 + b*x + c = 0\nb Parameter in a*x^2 + b*x + c = 0\nc Parameter in a*x^2 + b*x + c = 0\n\n\n\n\n\n","category":"function"},{"location":"pages/Utils/#Land.MathTools.quadratic","page":"Utils","title":"Land.MathTools.quadratic","text":"quadratic(a::FT, b::FT, c::FT)\n\nReturn a list of quadratic function solutions or an error message, given\n\na Parameter in a*x^2 + b*x + c = 0\nb Parameter in a*x^2 + b*x + c = 0\nc Parameter in a*x^2 + b*x + c = 0\n\n\n\n\n\n","category":"function"},{"location":"pages/Utils/#Land.MathTools.volscatt","page":"Utils","title":"Land.MathTools.volscatt","text":"volscatt(tts::FT, tto::FT, psi::FT, ttl::FT)\n\nCalculate interception parameters (chi_s and chi_s) and leaf reflectance multiplier (frho) and transmittance multiplier (ftau), given\n\ntts Solar zenith angle\ntto Viewing zenith angle\npsi Azimuth angle\nttl Leaf inclination angle\n\n\n\n\n\n","category":"function"},{"location":"pages/Utils/#Land.MathTools.weibull_k_ratio","page":"Utils","title":"Land.MathTools.weibull_k_ratio","text":"weibull_k_ratio(b::FT, c::FT, p_25::FT, vis::FT)\n\nReturns the relative hydraulic conductance, given\n\nb Weibull B in [MPa]\nc Weibull C\np_25 Equivalent xylem pressure at 298.15 K in [MPa]\nvis Relative viscosity\n\n\n\n\n\n","category":"function"},{"location":"pages/Utils/#WaterPhysics-module-1","page":"Utils","title":"WaterPhysics module","text":"","category":"section"},{"location":"pages/Utils/#","page":"Utils","title":"Utils","text":"Land.WaterPhysics.relative_diffusive_coefficient\nLand.WaterPhysics.latent_heat_vapor\nLand.WaterPhysics.saturation_vapor_pressure\nLand.WaterPhysics.saturation_vapor_pressure_slope\nLand.WaterPhysics.surface_tension\nLand.WaterPhysics.relative_surface_tension\nLand.WaterPhysics.viscosity\nLand.WaterPhysics.relative_viscosity","category":"page"},{"location":"pages/Utils/#Land.WaterPhysics.relative_diffusive_coefficient","page":"Utils","title":"Land.WaterPhysics.relative_diffusive_coefficient","text":"relative_diffusive_coefficient(T::FT)\nrelative_diffusive_coefficient(T::Array{FT})\n\nReturns the relative diffusive coefficient of water vapor in air, given\n\nT Water vapor temperature\n\n\n\n\n\n","category":"function"},{"location":"pages/Utils/#Land.WaterPhysics.latent_heat_vapor","page":"Utils","title":"Land.WaterPhysics.latent_heat_vapor","text":"latent_heat_vapor(T::FT)\nlatent_heat_vapor(T::Array{FT})\n\nThe specific latent heat of vaporization, given\n\nT (Array of) temperature\n\n\n\n\n\n","category":"function"},{"location":"pages/Utils/#Land.WaterPhysics.saturation_vapor_pressure","page":"Utils","title":"Land.WaterPhysics.saturation_vapor_pressure","text":"saturation_vapor_pressure(T::FT)\nsaturation_vapor_pressure(T::Array{FT})\n\nReturn the saturation vapor pressure over a plane liquid surface given\n\nT (Array of) temperature\n\n\n\n\n\n","category":"function"},{"location":"pages/Utils/#Land.WaterPhysics.saturation_vapor_pressure_slope","page":"Utils","title":"Land.WaterPhysics.saturation_vapor_pressure_slope","text":"saturation_vapor_pressure_slope(T::FT)\nsaturation_vapor_pressure_slope(T::Array{FT})\n\nReturn the 1st order derivative of saturation vapor pressure over a plane liquid surface, given\n\nT (Array of) temperature\n\nCompute the the 1st order derivative of saturation vapor pressure over a plane surface by integration of the Clausius-Clapeyron relation.\n\nThe re-arranged Clausius-Clapeyron relation\n\nfracP_satT = P_sat  dfrac LH_0 + Δc_p  (T - T_triple)\n                                         R_v  T^2 \n\n\n\n\n\n","category":"function"},{"location":"pages/Utils/#Land.WaterPhysics.surface_tension","page":"Utils","title":"Land.WaterPhysics.surface_tension","text":"surface_tension(T::FT)\nsurface_tension(T::Array{FT})\n\nSurface tension [N m⁻¹] of water against air, given\n\nT (Array of) temperature\n\nThe equation used is\n\nγ = 02358 \n    left( 1 - dfracTT_c right)^1256 \n    left 1 - 0625  left( 1 - dfracTT_c right) right\n\nSee http://www.iapws.org/relguide/Surf-H2O.html\n\n\n\n\n\n","category":"function"},{"location":"pages/Utils/#Land.WaterPhysics.relative_surface_tension","page":"Utils","title":"Land.WaterPhysics.relative_surface_tension","text":"relative_surface_tension(T::FT)\nrelative_surface_tension(T::Array{FT})\n\nRelative surface tension of water against air relative to 298.15 K, given\n\nT (Array of) temperature\n\nThe equation used is\n\nγ = 02358 \n    left( 1 - dfracTT_c right)^1256 \n    left 1 - 0625  left( 1 - dfracTT_c right) right\n\nSee http://www.iapws.org/relguide/Surf-H2O.html\n\nA reference temperature at 298.15 K is used because the hydraulic conductances and vulnerability curves of plants are described at 298.15 K.\n\n\n\n\n\n","category":"function"},{"location":"pages/Utils/#Land.WaterPhysics.viscosity","page":"Utils","title":"Land.WaterPhysics.viscosity","text":"viscosity(T::FT)\nviscosity(T::Array{FT})\n\nViscosity of water [Pa s], given\n\nT (Array of) temperature\n\nEquation used is\n\nυ = A  exp left( dfracBT + CT + DT^2 right)\n\nand the fitting parameters are from Reid, Prausnitz, & Poling (1987), valid through 273-643 K\n\nA = 1.856E-14 # Pa s\nB = 4209      # K\nC = 0.04527   # K⁻¹\nD = -3.376E-5 # K⁻²\n\n\n\n\n\n","category":"function"},{"location":"pages/Utils/#Land.WaterPhysics.relative_viscosity","page":"Utils","title":"Land.WaterPhysics.relative_viscosity","text":"relative_viscosity(T::FT)\nrelative_viscosity(T::Array{FT})\n\nViscosity relative to 25 degree C (298.15 K), given\n\nT Water temperature\n\nEquation used is\n\nυ = A  exp left( dfracBT + CT + DT^2 right)\n\nand the fitting parameters are from Reid, Prausnitz, & Poling (1987), valid through 273-643 K\n\nB = 4209      # K\nC = 0.04527   # K⁻¹\nD = -3.376E-5 # K⁻²\n\n\n\n\n\n","category":"function"},{"location":"pages/Utils/#RootSolvers-extension-1","page":"Utils","title":"RootSolvers extension","text":"","category":"section"},{"location":"pages/Utils/#","page":"Utils","title":"Utils","text":"Land.RootSolversExtension.BisectionMethod\nLand.RootSolversExtension.NewtonBisectionMethod\nLand.RootSolversExtension.if_break\nLand.RootSolversExtension.find_zero_ext","category":"page"},{"location":"pages/Utils/#Land.RootSolversExtension.BisectionMethod","page":"Utils","title":"Land.RootSolversExtension.BisectionMethod","text":"struct BisectionMethod\n\nFields\n\nx_min\nlower bound\nx_max\nupper bound\n\n\n\n\n\n","category":"type"},{"location":"pages/Utils/#Land.RootSolversExtension.NewtonBisectionMethod","page":"Utils","title":"Land.RootSolversExtension.NewtonBisectionMethod","text":"struct NewtonBisectionMethod\n\nFields\n\nx_min\nlower bound\nx_max\nupper bound\n\n\n\n\n\n","category":"type"},{"location":"pages/Utils/#Land.RootSolversExtension.if_break","page":"Utils","title":"Land.RootSolversExtension.if_break","text":"if_break(tol::TOL{FT}, x1::FT, x2::FT, y::FT)\n\nDetermine whether to break, given\n\ntol Tolerance type\nx1 Lower bound of x\nx2 Upper bound of x\ny Residual of y\n\n\n\n\n\n","category":"function"},{"location":"pages/Utils/#Land.RootSolversExtension.find_zero_ext","page":"Utils","title":"Land.RootSolversExtension.find_zero_ext","text":"find_zero_ext(f::F, ms::BisectionMethod{FT}, tol::TOL{FT})\n\nFind the solution, given\n\nf A function to solve\nms BisectionMethod or NewtonBisectionMethod\ntol Solution tolerance\n\n\n\n\n\n","category":"function"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"EditURL = \"https://github.com/CliMA/Land/blob/master/docs/src/tutorial_scripts/RAMI_benchmarking_example.jl\"","category":"page"},{"location":"generated/RAMI_benchmarking_example/##-RAMI-Benchmarking-1","page":"RAMI benchmarking","title":"# RAMI Benchmarking","text":"","category":"section"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"The goal of the RAMI4PILPS experiment[1] is to evaluate different approaches by which Land Surface Models in larger Earth System Models quantify the radiation transfer within vegetation canopies. The RAMI4PILPS can be interpreted as a quality control mechanism used to:","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"quantify the errors in the radiative transfer scheme;\nidentify the impact that structural and spectral sub-grid variability may have on radiative transfer; and\nverify the conservation of energy at the level of the surface, as well as inconsistencies arising from different levels of assumptions/simplifications.","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"This approach involves direct comparison with reference solutions obtained from highly accurate 3D models identified during the third phase of the RAMI benchmarking exercise[2].","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"A set of 3D experiments compares the partitioning of incident solar energy into an absorbed (A) flux, a transmitted (T) flux component and the surface reflectance (R). The overall canopy structure for these test cases is reminiscent of open forest canopies with randomly oriented foliage, confined to spherical volumes located at varying heights above the ground. In here, we use a total of 36 test cases including various canopy density, soil brightness, and illumination conditions for the visible (VIS) (400-700nm) and near infra-red (NIR) (700-3000nm) spectral ranges.","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"[1]: J.L. Widlowski, B. Pinty, M. Clerici, Y. Dai, M. De Kauwe, K. de Ridder, A. Kallel, H. Kobayashi, T. Lavergne, W. Ni-Meister, A. Olchev, T. Quaife, S. Wang, W. Yang, Y. Yang, and H. Yuan (2011), RAMI4PILPS: An intercomparison of formulations for the partitioning of solar radiation in land surface models, Journal of Geophysical Research, 116, G02019, 25, DOI: 10.1029/2010JG001511.","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"[2]: Widlowski, J-L., M. Taberner, B. Pinty, V. Bruniquel-Pinel, M. Disney, R. Fernandes, J.-P. Gastellu-Etchegorry, N. Gobron, A. Kuusk, T. Lavergne, S. Leblanc, P. Lewis, E. Martin, M. Mottus, P. J. R. North, W. Qin, M.Robustelli, N. Rochdi, R.Ruiloba, C.Soler, R.Thompson, W. Verhoef, M. M.Verstraete, and D. Xie (2007), 'The third RAdiation transfer Model Intercomparison (RAMI) exercise: Documenting progress in canopy reflectance modelling', Journal of Geophysical Research, 112, D09111, 28, DOI: 10.1029/2006JD007821.","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"#### Use Julia Plots package and switch to plotly js option:\nusing PyPlot\n\n##----------------------------------------------------------------------------\n\n# First, we include Revise (good for debugging) and Parameters (tools for structures)\n\n##using Revise\nusing Parameters\n##----------------------------------------------------------------------------\n\n# Now include the Land modules\n\nusing Land\nusing Land.CanopyRT\n##----------------------------------------------------------------------------\n\n##Defining all reference values for the Sparse case","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"const FT = Float32\n\nwl_set = create_wl_para_set(FT)\nleaf = create_leaf_bio(FT, wl_set.nwl, wl_set.nWlE, wl_set.nWlF);\ncanopy_rt = Canopy4RT{FT}(nlayers=20, LAI=3)\ncanRad_rt = CanopyRadiation{FT, wl_set.nwl, wl_set.nWlF, length(canopy_rt.litab), length(canopy_rt.lazitab), canopy_rt.nlayers}()\ncanOpt_rt = create_canopy_optical(FT, wl_set.nwl, canopy_rt.nlayers, length(canopy_rt.lazitab), length(canopy_rt.litab); using_marray=false)\nsunRad_rt = create_incoming_radiation(FT, wl_set.swl);\n\nsoil = SoilOpti{FT}(wl_set.wl, FT(0.2)*ones(FT, length(wl_set.wl)), FT[0.1], FT(290.0))\nangles = SolarAngles{FT}()\n\narrayOfLeaves = [create_leaf_bio(FT, wl_set.nwl, wl_set.nWlE, wl_set.nWlF) for i in 1:canopy_rt.nlayers]\nfor i in 1:canopy_rt.nlayers\n    fluspect!(arrayOfLeaves[i], wl_set)\nend","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"RAMI_SZA = [27.,60.,83.]\n\nRAMI_fabsRed_050_BLK =  [0.09380509999999999, 0.16259713, 0.53931207]\nRAMI_frefRed_050_BLK =  [0.00330673, 0.00517598, 0.01626682]\nRAMI_ftranRed_050_BLK =  [0.90288817, 0.83222689, 0.44442110999999995]\n\nRAMI_fabsRed_050_MED =  [0.10897124, 0.17760124000000002, 0.54764719]\nRAMI_frefRed_050_MED =  [0.09759354, 0.09107608, 0.06177913]\nRAMI_ftranRed_050_MED =  [0.90337609, 0.83265704, 0.44469279]\n\nRAMI_fabsRed_050_SNW =  [0.21471034, 0.28200132, 0.60564705]\nRAMI_frefRed_050_SNW =  [0.7526521700000001, 0.6879087300000001, 0.37825442000000004]\nRAMI_ftranRed_050_SNW =  [0.90659694, 0.83583194, 0.44718138]","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"function RAMI_case(LAI, soil_albedo, clumping_index)\n\n  soil.albedo_SW[:] .=soil_albedo;\n  ##Clumping index\n  canopy_rt.Ω = 1.0\n  ##Viewing Zenith Angle in degrees\n  angles.tto=0.0\n  ##Leaf Area index\n  canopy_rt.LAI=LAI\n\n  reflRed_SZA = []\n  absRed_SZA = []\n  transRed_SZA = []\n\n  for SZA=0.0:1:85\n    angles.tts=SZA\n\n    fluspect!(leaf, wl_set);\n    compute_canopy_geometry!(canopy_rt, angles, canOpt_rt)\n    compute_canopy_matrices!(arrayOfLeaves, canOpt_rt);\n\n   # leaf reflectance RED\n   leaf.ρ_SW[28] = 0.0735\n   # leaf transmittance\n   leaf.τ_SW[28]= 0.0566\n\n    ##Setting all diffuse to zero\n    sunRad_rt.E_diffuse[28] = 0.0\n\n    simulate_short_wave!(canopy_rt, canOpt_rt, canRad_rt, sunRad_rt, soil);\n    push!(reflRed_SZA, canRad_rt.alb_direct[28])\n    push!(absRed_SZA, (sum(canRad_rt.netSW_shade,dims=2)[28,1].+sum(canRad_rt.netSW_sunlit,dims=2)[28,1])./(sunRad_rt.E_diffuse[28].+sunRad_rt.E_direct[28]))\n    push!(transRed_SZA,  (canOpt_rt.Es_[28,end] .+ canRad_rt.E_down[28,end])./(sunRad_rt.E_diffuse[28].+sunRad_rt.E_direct[28]))\n  end\n\n  ######## Clumped Case\n\n  reflRed_clump_SZA = []\n  absRed_clump_SZA = []\n  transRed_clump_SZA = []\n\n\n  ##Clumping index\n  canopy_rt.Ω = clumping_index\n\n  for SZA=0.0:1:85\n    angles.tts=SZA\n\n    fluspect!(leaf, wl_set);\n    compute_canopy_geometry!(canopy_rt, angles, canOpt_rt)\n    compute_canopy_matrices!(arrayOfLeaves, canOpt_rt);\n\n    simulate_short_wave!(canopy_rt, canOpt_rt, canRad_rt, sunRad_rt, soil);\n    push!(reflRed_clump_SZA, canRad_rt.alb_direct[28])\n    push!(absRed_clump_SZA, (sum(canRad_rt.netSW_shade,dims=2)[28,1].+sum(canRad_rt.netSW_sunlit,dims=2)[28,1])./(sunRad_rt.E_diffuse[28].+sunRad_rt.E_direct[28]))\n    push!(transRed_clump_SZA,  (canOpt_rt.Es_[28,end] .+ canRad_rt.E_down[28,end])./(sunRad_rt.E_diffuse[28].+sunRad_rt.E_direct[28]))\n\n  end\n\n  return reflRed_SZA,absRed_SZA,transRed_SZA,reflRed_clump_SZA,absRed_clump_SZA,transRed_clump_SZA\n\nend;\nnothing #hide","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"#TODO nest those into a loop!\n\n##Sparse case with black soil\nreflRed_SZA,absRed_SZA,transRed_SZA,reflRed_clump_SZA,absRed_clump_SZA,transRed_clump_SZA=RAMI_case(0.50265, 0.0, 0.365864235);\nnothing #hide","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"SZA=0:1:85\n\nfigure(figsize=(10,5))\n\nsubplot(1,2,1)\nplot(SZA, reflRed_SZA,label=[\"reflectance\"])\nplot(SZA, absRed_SZA ,label=[\"absorptance\"])\nplot(SZA, transRed_SZA,label=[\"transmittance\"])\nscatter(RAMI_SZA, RAMI_frefRed_050_BLK)\nscatter(RAMI_SZA, RAMI_fabsRed_050_BLK)\nscatter(RAMI_SZA, RAMI_ftranRed_050_BLK)\ntitle(\"050_BLK - Default\")\nylabel(\"Radiation Partitioning\")\nxlabel(\"Sun Zenith Angle\")\nxlim(0.0, 90.)\nylim(-0.05, 1.0)\nxticks(0:20:91.)\nyticks(0:0.2:1.0)\n\nsubplot(1,2,2)\nplot(SZA, reflRed_clump_SZA,label=[\"reflectance\"])\nplot(SZA, absRed_clump_SZA ,label=[\"absorptance\"])\nplot(SZA,transRed_clump_SZA,label=[\"transmittance\"])\nscatter(RAMI_SZA, RAMI_frefRed_050_BLK,label=\"RAMI reflectance\")\nscatter(RAMI_SZA, RAMI_fabsRed_050_BLK,label=\"RAMI absorptance\")\nscatter(RAMI_SZA, RAMI_ftranRed_050_BLK,label=\"RAMI transmittance\")\ntitle(\"Clumping\")\nylabel(\"Radiation Partitioning\")\nxlabel(\"Sun Zenith Angle\")\nxlim(0.0, 90.)\nylim(-0.05, 1.0)\nxticks(0:20:91.)\nyticks(0:0.2:1.0)\n\nlegend()\ngcf()","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"##Sparse case with medium soil\nreflRed_SZA,absRed_SZA,transRed_SZA,reflRed_clump_SZA,absRed_clump_SZA,transRed_clump_SZA=RAMI_case(0.50265, 0.1217, 0.365864235);\nnothing #hide","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"SZA=0:1:85\n\nfigure(figsize=(10,5))\n\nsubplot(1,2,1)\nplot(SZA, reflRed_SZA,label=[\"reflectance\"])\nplot(SZA, absRed_SZA ,label=[\"absorptance\"])\nplot(SZA, transRed_SZA,label=[\"transmittance\"])\nscatter(RAMI_SZA, RAMI_frefRed_050_MED)\nscatter(RAMI_SZA, RAMI_fabsRed_050_MED)\nscatter(RAMI_SZA, RAMI_ftranRed_050_MED)\ntitle(\"050_MED - Default\")\nylabel(\"Radiation Partitioning\")\nxlabel(\"Sun Zenith Angle\")\nxlim(0.0, 90.)\nylim(-0.05, 1.0)\nxticks(0:20:91.)\nyticks(0:0.2:1.0)\n\nsubplot(1,2,2)\nplot(SZA, reflRed_clump_SZA,label=[\"reflectance\"])\nplot(SZA, absRed_clump_SZA ,label=[\"absorptance\"])\nplot(SZA,transRed_clump_SZA,label=[\"transmittance\"])\nscatter(RAMI_SZA, RAMI_frefRed_050_MED,label=\"RAMI reflectance\")\nscatter(RAMI_SZA, RAMI_fabsRed_050_MED,label=\"RAMI absorptance\")\nscatter(RAMI_SZA, RAMI_ftranRed_050_MED,label=\"RAMI transmittance\")\ntitle(\"Clumping\")\nylabel(\"Radiation Partitioning\")\nxlabel(\"Sun Zenith Angle\")\nxlim(0.0, 90.)\nylim(-0.05, 1.0)\nxticks(0:20:91.)\nyticks(0:0.2:1.0)\n\nlegend()\ngcf()","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"##Sparse case with snowy soil\nreflRed_SZA,absRed_SZA,transRed_SZA,reflRed_clump_SZA,absRed_clump_SZA,transRed_clump_SZA=RAMI_case(0.50265, 0.9640, 0.365864235);\nnothing #hide","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"SZA=0:1:85\n\nfigure(figsize=(10,5))\n\nsubplot(1,2,1)\nplot(SZA, reflRed_SZA,label=[\"reflectance\"])\nplot(SZA, absRed_SZA ,label=[\"absorptance\"])\nplot(SZA, transRed_SZA,label=[\"transmittance\"])\nscatter(RAMI_SZA, RAMI_frefRed_050_SNW)\nscatter(RAMI_SZA, RAMI_fabsRed_050_SNW)\nscatter(RAMI_SZA, RAMI_ftranRed_050_SNW)\ntitle(\"050_SNW - Default\")\nylabel(\"Radiation Partitioning\")\nxlabel(\"Sun Zenith Angle\")\nxlim(0.0, 90.)\nylim(-0.05, 1.0)\nxticks(0:20:91.)\nyticks(0:0.2:1.0)\n\nsubplot(1,2,2)\nplot(SZA, reflRed_clump_SZA,label=[\"reflectance\"])\nplot(SZA, absRed_clump_SZA ,label=[\"absorptance\"])\nplot(SZA,transRed_clump_SZA,label=[\"transmittance\"])\nscatter(RAMI_SZA, RAMI_frefRed_050_SNW,label=\"RAMI reflectance\")\nscatter(RAMI_SZA, RAMI_fabsRed_050_SNW,label=\"RAMI absorptance\")\nscatter(RAMI_SZA, RAMI_ftranRed_050_SNW,label=\"RAMI transmittance\")\ntitle(\"Clumping\")\nylabel(\"Radiation Partitioning\")\nxlabel(\"Sun Zenith Angle\")\nxlim(0.0, 90.)\nylim(-0.05, 1.0)\nxticks(0:20:91.)\nyticks(0:0.2:1.0)\n\nlegend()\ngcf()","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"##Defining all reference values for the Medium case\n\nRAMI_SZA = [27.,60.,83.]\n\n\nRAMI_fabsRed_150_BLK =  [0.28137804, 0.46514268999999997, 0.89063486]\nRAMI_frefRed_150_BLK =  [0.00923676, 0.01379672, 0.02970703]\nRAMI_ftranRed_150_BLK =  [0.7093851999999999, 0.52106059, 0.07965811]\n\nRAMI_fabsRed_150_MED =  [0.31403827, 0.49003033, 0.89432051]\nRAMI_frefRed_150_MED =  [0.06195053, 0.05151941, 0.03561715]\nRAMI_ftranRed_150_MED =  [0.7104761399999999, 0.52197456, 0.07977039000000001]\n\nRAMI_fabsRed_150_SNW =  [0.5431621799999999, 0.66519762, 0.9201217300000001]\nRAMI_frefRed_150_SNW =  [0.43100610000000006, 0.31581022999999997, 0.07698033]\nRAMI_ftranRed_150_SNW =  [0.71754777, 0.52755972, 0.08049832999999999]","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"##Medium case with black soil\nreflRed_SZA,absRed_SZA,transRed_SZA,reflRed_clump_SZA,absRed_clump_SZA,transRed_clump_SZA=RAMI_case(1.5017, 0.0, 0.405417644);\nnothing #hide","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"SZA=0:1:85\n\nfigure(figsize=(10,5))\n\nsubplot(1,2,1)\nplot(SZA, reflRed_SZA,label=[\"reflectance\"])\nplot(SZA, absRed_SZA ,label=[\"absorptance\"])\nplot(SZA, transRed_SZA,label=[\"transmittance\"])\nscatter(RAMI_SZA, RAMI_frefRed_150_BLK)\nscatter(RAMI_SZA, RAMI_fabsRed_150_BLK)\nscatter(RAMI_SZA, RAMI_ftranRed_150_BLK)\ntitle(\"150_BLK - Default\")\nylabel(\"Radiation Partitioning\")\nxlabel(\"Sun Zenith Angle\")\nxlim(0.0, 90.)\nylim(-0.05, 1.0)\nxticks(0:20:91.)\nyticks(0:0.2:1.0)\n\nsubplot(1,2,2)\nplot(SZA, reflRed_clump_SZA,label=[\"reflectance\"])\nplot(SZA, absRed_clump_SZA ,label=[\"absorptance\"])\nplot(SZA,transRed_clump_SZA,label=[\"transmittance\"])\nscatter(RAMI_SZA, RAMI_frefRed_150_BLK,label=\"RAMI reflectance\")\nscatter(RAMI_SZA, RAMI_fabsRed_150_BLK,label=\"RAMI absorptance\")\nscatter(RAMI_SZA, RAMI_ftranRed_150_BLK,label=\"RAMI transmittance\")\ntitle(\"Clumping\")\nylabel(\"Radiation Partitioning\")\nxlabel(\"Sun Zenith Angle\")\nxlim(0.0, 90.)\nylim(-0.05, 1.0)\nxticks(0:20:91.)\nyticks(0:0.2:1.0)\n\nlegend()\ngcf()","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"##Medium case with medium soil\nreflRed_SZA,absRed_SZA,transRed_SZA,reflRed_clump_SZA,absRed_clump_SZA,transRed_clump_SZA=RAMI_case(1.5017, 0.1217, 0.405417644);\nnothing #hide","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"SZA=0:1:85\n\nfigure(figsize=(10,5))\n\nsubplot(1,2,1)\nplot(SZA, reflRed_SZA,label=[\"reflectance\"])\nplot(SZA, absRed_SZA ,label=[\"absorptance\"])\nplot(SZA, transRed_SZA,label=[\"transmittance\"])\nscatter(RAMI_SZA, RAMI_frefRed_150_MED)\nscatter(RAMI_SZA, RAMI_fabsRed_150_MED)\nscatter(RAMI_SZA, RAMI_ftranRed_150_MED)\ntitle(\"150_MED - Default\")\nylabel(\"Radiation Partitioning\")\nxlabel(\"Sun Zenith Angle\")\nxlim(0.0, 90.)\nylim(-0.05, 1.0)\nxticks(0:20:91.)\nyticks(0:0.2:1.0)\n\nsubplot(1,2,2)\nplot(SZA, reflRed_clump_SZA,label=[\"reflectance\"])\nplot(SZA, absRed_clump_SZA ,label=[\"absorptance\"])\nplot(SZA,transRed_clump_SZA,label=[\"transmittance\"])\nscatter(RAMI_SZA, RAMI_frefRed_150_MED,label=\"RAMI reflectance\")\nscatter(RAMI_SZA, RAMI_fabsRed_150_MED,label=\"RAMI absorptance\")\nscatter(RAMI_SZA, RAMI_ftranRed_150_MED,label=\"RAMI transmittance\")\ntitle(\"Clumping\")\nylabel(\"Radiation Partitioning\")\nxlabel(\"Sun Zenith Angle\")\nxlim(0.0, 90.)\nylim(-0.05, 1.0)\nxticks(0:20:91.)\nyticks(0:0.2:1.0)\n\nlegend()\ngcf()","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"##Medium case with black soil\nreflRed_SZA,absRed_SZA,transRed_SZA,reflRed_clump_SZA,absRed_clump_SZA,transRed_clump_SZA=RAMI_case(1.5017, 0.9640, 0.405417644);\nnothing #hide","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"SZA=0:1:85\n\nfigure(figsize=(10,5))\n\nsubplot(1,2,1)\nplot(SZA, reflRed_SZA,label=[\"reflectance\"])\nplot(SZA, absRed_SZA ,label=[\"absorptance\"])\nplot(SZA, transRed_SZA,label=[\"transmittance\"])\nscatter(RAMI_SZA, RAMI_frefRed_150_SNW)\nscatter(RAMI_SZA, RAMI_fabsRed_150_SNW)\nscatter(RAMI_SZA, RAMI_ftranRed_150_SNW)\ntitle(\"150_SNW - Default\")\nylabel(\"Radiation Partitioning\")\nxlabel(\"Sun Zenith Angle\")\nxlim(0.0, 90.)\nylim(-0.05, 1.0)\nxticks(0:20:91.)\nyticks(0:0.2:1.0)\n\nsubplot(1,2,2)\nplot(SZA, reflRed_clump_SZA,label=[\"reflectance\"])\nplot(SZA, absRed_clump_SZA ,label=[\"absorptance\"])\nplot(SZA,transRed_clump_SZA,label=[\"transmittance\"])\nscatter(RAMI_SZA, RAMI_frefRed_150_SNW,label=\"RAMI reflectance\")\nscatter(RAMI_SZA, RAMI_fabsRed_150_SNW,label=\"RAMI absorptance\")\nscatter(RAMI_SZA, RAMI_ftranRed_150_SNW,label=\"RAMI transmittance\")\ntitle(\"Clumping\")\nylabel(\"Radiation Partitioning\")\nxlabel(\"Sun Zenith Angle\")\nxlim(0.0, 90.)\nylim(-0.05, 1.0)\nxticks(0:20:91.)\nyticks(0:0.2:1.0)\n\nlegend()\ngcf()","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"##Defining all reference values for the Dense case\n\nRAMI_SZA = [27.,60.,83.]\n\n\nRAMI_fabsRed_250_BLK =  [0.46852539, 0.70426097, 0.9461774300000001]\nRAMI_frefRed_250_BLK =  [0.01445858, 0.02016963, 0.03477486]\nRAMI_ftranRed_250_BLK =  [0.51701603, 0.2755694, 0.01904771]\n\nRAMI_fabsRed_250_MED =  [0.50540545, 0.72429659, 0.94742381]\nRAMI_frefRed_250_MED =  [0.03953053, 0.03315039, 0.03580858]\nRAMI_ftranRed_250_MED =  [0.51811911, 0.27616192, 0.01909098]\n\nRAMI_fabsRed_250_SNW =  [0.76512258, 0.86538802, 0.9562473199999999]\nRAMI_frefRed_250_SNW =  [0.21595537, 0.124503, 0.043056080000000004]\nRAMI_ftranRed_250_SNW =  [0.5256125, 0.280805, 0.01935]","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"##Dense case with black soil\nreflRed_SZA,absRed_SZA,transRed_SZA,reflRed_clump_SZA,absRed_clump_SZA,transRed_clump_SZA=RAMI_case(2.5007, 0.0, 0.45946608);\nnothing #hide","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"SZA=0:1:85\n\nfigure(figsize=(10,5))\n\nsubplot(1,2,1)\nplot(SZA, reflRed_SZA,label=[\"reflectance\"])\nplot(SZA, absRed_SZA ,label=[\"absorptance\"])\nplot(SZA, transRed_SZA,label=[\"transmittance\"])\nscatter(RAMI_SZA, RAMI_frefRed_250_BLK)\nscatter(RAMI_SZA, RAMI_fabsRed_250_BLK)\nscatter(RAMI_SZA, RAMI_ftranRed_250_BLK)\ntitle(\"250_BLK - Default\")\nylabel(\"Radiation Partitioning\")\nxlabel(\"Sun Zenith Angle\")\nxlim(0.0, 90.)\nylim(-0.05, 1.0)\nxticks(0:20:91.)\nyticks(0:0.2:1.0)\n\nsubplot(1,2,2)\nplot(SZA, reflRed_clump_SZA,label=[\"reflectance\"])\nplot(SZA, absRed_clump_SZA ,label=[\"absorptance\"])\nplot(SZA,transRed_clump_SZA,label=[\"transmittance\"])\nscatter(RAMI_SZA, RAMI_frefRed_250_BLK,label=\"RAMI reflectance\")\nscatter(RAMI_SZA, RAMI_fabsRed_250_BLK,label=\"RAMI absorptance\")\nscatter(RAMI_SZA, RAMI_ftranRed_250_BLK,label=\"RAMI transmittance\")\ntitle(\"Clumping\")\nylabel(\"Radiation Partitioning\")\nxlabel(\"Sun Zenith Angle\")\nxlim(0.0, 90.)\nylim(-0.05, 1.0)\nxticks(0:20:91.)\nyticks(0:0.2:1.0)\n\nlegend()\ngcf()","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"##Medium case with medium soil\nreflRed_SZA,absRed_SZA,transRed_SZA,reflRed_clump_SZA,absRed_clump_SZA,transRed_clump_SZA=RAMI_case(2.5007, 0.1217, 0.45946608);\nnothing #hide","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"SZA=0:1:85\n\nfigure(figsize=(10,5))\n\nsubplot(1,2,1)\nplot(SZA, reflRed_SZA,label=[\"reflectance\"])\nplot(SZA, absRed_SZA ,label=[\"absorptance\"])\nplot(SZA, transRed_SZA,label=[\"transmittance\"])\nscatter(RAMI_SZA, RAMI_frefRed_250_MED)\nscatter(RAMI_SZA, RAMI_fabsRed_250_MED)\nscatter(RAMI_SZA, RAMI_ftranRed_250_MED)\ntitle(\"250_MED - Default\")\nylabel(\"Radiation Partitioning\")\nxlabel(\"Sun Zenith Angle\")\nxlim(0.0, 90.)\nylim(-0.05, 1.0)\nxticks(0:20:91.)\nyticks(0:0.2:1.0)\n\nsubplot(1,2,2)\nplot(SZA, reflRed_clump_SZA,label=[\"reflectance\"])\nplot(SZA, absRed_clump_SZA ,label=[\"absorptance\"])\nplot(SZA,transRed_clump_SZA,label=[\"transmittance\"])\nscatter(RAMI_SZA, RAMI_frefRed_250_MED,label=\"RAMI reflectance\")\nscatter(RAMI_SZA, RAMI_fabsRed_250_MED,label=\"RAMI absorptance\")\nscatter(RAMI_SZA, RAMI_ftranRed_250_MED,label=\"RAMI transmittance\")\ntitle(\"Clumping\")\nylabel(\"Radiation Partitioning\")\nxlabel(\"Sun Zenith Angle\")\nxlim(0.0, 90.)\nylim(-0.05, 1.0)\nxticks(0:20:91.)\nyticks(0:0.2:1.0)\n\nlegend()\ngcf()","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"##Dense case with snowy soil\nreflRed_SZA,absRed_SZA,transRed_SZA,reflRed_clump_SZA,absRed_clump_SZA,transRed_clump_SZA=RAMI_case(2.5007, 0.9640, 0.45946608);\nnothing #hide","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"SZA=0:1:85\n\nfigure(figsize=(10,5))\n\nsubplot(1,2,1)\nplot(SZA, reflRed_SZA,label=[\"reflectance\"])\nplot(SZA, absRed_SZA ,label=[\"absorptance\"])\nplot(SZA, transRed_SZA,label=[\"transmittance\"])\nscatter(RAMI_SZA, RAMI_frefRed_250_SNW)\nscatter(RAMI_SZA, RAMI_fabsRed_250_SNW)\nscatter(RAMI_SZA, RAMI_ftranRed_250_SNW)\ntitle(\"250_SNW - Default\")\nylabel(\"Radiation Partitioning\")\nxlabel(\"Sun Zenith Angle\")\nxlim(0.0, 90.)\nylim(-0.05, 1.0)\nxticks(0:20:91.)\nyticks(0:0.2:1.0)\n\nsubplot(1,2,2)\nplot(SZA, reflRed_clump_SZA,label=[\"reflectance\"])\nplot(SZA, absRed_clump_SZA ,label=[\"absorptance\"])\nplot(SZA,transRed_clump_SZA,label=[\"transmittance\"])\nscatter(RAMI_SZA, RAMI_frefRed_250_SNW,label=\"RAMI reflectance\")\nscatter(RAMI_SZA, RAMI_fabsRed_250_SNW,label=\"RAMI absorptance\")\nscatter(RAMI_SZA, RAMI_ftranRed_250_SNW,label=\"RAMI transmittance\")\ntitle(\"Clumping\")\nylabel(\"Radiation Partitioning\")\nxlabel(\"Sun Zenith Angle\")\nxlim(0.0, 90.)\nylim(-0.05, 1.0)\nxticks(0:20:91.)\nyticks(0:0.2:1.0)\n\nlegend()\ngcf()","category":"page"},{"location":"generated/RAMI_benchmarking_example/####-Test-a-VZA-dependence-in-the-principal-plane-with-clumping-1","page":"RAMI benchmarking","title":"### Test a VZA dependence in the principal plane with clumping","text":"","category":"section"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"# Define a few wavelengths:\nwl_blue = 450.0;\nwl_red = 600.0;\nwl_FarRed = 740.0;\nwl_Red = 685.0;\nind_wle_blue  = argmin(abs.(wl_set.wle .-wl_blue));\nind_wle_red = argmin(abs.(wl_set.wle .-wl_red));\nind_wlf_FR  = argmin(abs.(wl_set.wlf .-wl_FarRed));\nind_wlf_R  = argmin(abs.(wl_set.wlf .-wl_Red));\nind_red = argmin(abs.(wl_set.wl .-wl_Red));\nind_NIR = argmin(abs.(wl_set.wl .-800));\nnothing #hide","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"SIF_FR = Float32[]\nSIF_R = Float32[]\nreflVIS = Float32[]\nreflNIR = Float32[]\n\n#### Just running the code over all geometries:\n##MED\nsoil.albedo_SW[:] .=0.1217;\n#### Set sun SZA to 27 degrees\nangles.tts=27.\n#### Set 0 azimuth (principal plane)\nangles.psi=0\n\n##Adding clumping\ncanopy_rt.Ω = 1.0\n#### LAI of 3:\ncanopy_rt.LAI = 2.5007\n#### Define VZA\nVZA=collect(-89.5:0.5:89.5)\n\nfor VZA_ in VZA\n    angles.tto=VZA_\n    compute_canopy_geometry!(canopy_rt, angles, canOpt_rt)\n    compute_canopy_matrices!(arrayOfLeaves, canOpt_rt);\n    simulate_short_wave!(canopy_rt, canOpt_rt, canRad_rt, sunRad_rt, soil);\n    computeSIF_Fluxes!(arrayOfLeaves, canOpt_rt, canRad_rt, canopy_rt, soil, wl_set);\n    #### Handpicked indices in\n    push!(reflVIS, canRad_rt.alb_obs[ind_red])\n    push!(reflNIR, canRad_rt.alb_obs[ind_NIR])\n    push!(SIF_R , canRad_rt.SIF_obs[ind_wlf_R])\n    push!(SIF_FR, canRad_rt.SIF_obs[ind_wlf_FR ])\nend\n\n\n##Adding clumping\ncanopy_rt.Ω = 0.45946608\n\nSIF_FR_clump = Float32[]\nSIF_R_clump = Float32[]\nreflVIS_clump = Float32[]\nreflNIR_clump = Float32[]\n\n\nfor VZA_ in VZA\n    angles.tto=VZA_\n    compute_canopy_geometry!(canopy_rt, angles, canOpt_rt)\n    compute_canopy_matrices!(arrayOfLeaves, canOpt_rt);\n    simulate_short_wave!(canopy_rt, canOpt_rt, canRad_rt, sunRad_rt, soil);\n    computeSIF_Fluxes!(arrayOfLeaves, canOpt_rt, canRad_rt, canopy_rt, soil, wl_set);\n    #### Handpicked indices in\n    push!(reflVIS_clump, canRad_rt.alb_obs[ind_red])\n    push!(reflNIR_clump, canRad_rt.alb_obs[ind_NIR])\n    push!(SIF_R_clump , canRad_rt.SIF_obs[ind_wlf_R])\n    push!(SIF_FR_clump, canRad_rt.SIF_obs[ind_wlf_FR ])\nend","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"#### Plots Visible\nfigure()\nplot(VZA, reflVIS, color=:black,label=\"Red Reflectance\", lw=2)\nplot(VZA, SIF_R/30, color=:orange,label=\"Red SIF (/30)\", lw=2)\nplot(VZA, reflVIS_clump, color=:black, ls=\"--\", lw=2,label=\"Red Reflectance w/ Clumping\")\nplot(VZA, SIF_R_clump/30, color=:orange, ls=\"--\", lw=2,label=\"Red SIF (/30) w/ Clumping\")\nxlabel(\"Viewing Zenith Angle\")\nlegend()\ngcf()","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"#### Plots Visible\nfigure()\nplot(VZA, reflNIR, color=:black,label=\"NIR Reflectance\", lw=2)\nplot(VZA, SIF_FR/6, color=:orange,label=\"Far Red SIF (/6)\", lw=2)\nplot(VZA, reflNIR_clump, color=:black, ls=\"--\", lw=2,label=\"NIR Reflectance w/ Clumping\")\nplot(VZA, SIF_FR_clump/6, color=:orange, ls=\"--\", lw=2,label=\"Far Red SIF (/6) w/ Clumping\")\nxlabel(\"Viewing Zenith Angle\")\nlegend()\ngcf()","category":"page"},{"location":"generated/RAMI_benchmarking_example/###-BRDF-sampling-1","page":"RAMI benchmarking","title":"## BRDF sampling","text":"","category":"section"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"By going through viewing and azimuth angles, we can construct a full BRDF for reflectance and SIF emissions at different wavelengths:","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"reflVIS = Float32[]\nreflNIR = Float32[]\nSIF_FR = Float32[]\nSIF_R  = Float32[]\n\n##MED\nsoil.albedo_SW[:] .=0.1217;\nangles.tts=27.\nangles.psi=0\ncanopy_rt.LAI=2.5007\ncanopy_rt.Ω = 1.0\nfor psi=0:360\n    angles.psi=psi\n    for VZA=0:1:85\n        angles.tto=VZA\n\n        compute_canopy_geometry!(canopy_rt, angles, canOpt_rt)\n        compute_canopy_matrices!(arrayOfLeaves, canOpt_rt);\n        simulate_short_wave!(canopy_rt, canOpt_rt, canRad_rt, sunRad_rt, soil);\n        computeSIF_Fluxes!(arrayOfLeaves, canOpt_rt, canRad_rt, canopy_rt, soil, wl_set);\n        push!(reflVIS, canRad_rt.alb_obs[28])\n        push!(reflNIR, canRad_rt.alb_obs[52])\n        push!(SIF_R , canRad_rt.SIF_obs[8])\n        push!(SIF_FR, canRad_rt.SIF_obs[20])\n    end\nend\n\n##Adding clumping\ncanopy_rt.Ω = 0.45946608\n\nSIF_FR_clump = Float32[]\nSIF_R_clump = Float32[]\nreflVIS_clump = Float32[]\nreflNIR_clump = Float32[]\n\nfor psi=0:360\n    angles.psi=psi\n    for VZA=0:1:85\n        angles.tto=VZA\n\n        compute_canopy_geometry!(canopy_rt, angles, canOpt_rt)\n        compute_canopy_matrices!(arrayOfLeaves, canOpt_rt);\n        simulate_short_wave!(canopy_rt, canOpt_rt, canRad_rt, sunRad_rt, soil);\n        computeSIF_Fluxes!(arrayOfLeaves, canOpt_rt, canRad_rt, canopy_rt, soil, wl_set);\n        push!(reflVIS_clump, canRad_rt.alb_obs[28])\n        push!(reflNIR_clump, canRad_rt.alb_obs[52])\n        push!(SIF_R_clump , canRad_rt.SIF_obs[8])\n        push!(SIF_FR_clump, canRad_rt.SIF_obs[20])\n    end\nend","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"A = reshape(reflNIR, ( 86,361));\nB = reshape(reflVIS, ( 86,361));\nSIFFER = reshape(SIF_R, ( 86,361));\nSIFFER_FR = reshape(SIF_FR, ( 86,361));\n\nA_clump = reshape(reflNIR_clump, ( 86,361));\nB_clump = reshape(reflVIS_clump, ( 86,361));\nSIFFER_clump = reshape(SIF_R_clump, ( 86,361));\nSIFFER_FR_clump = reshape(SIF_FR_clump, ( 86,361));\nnothing #hide","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"figure(figsize=(10,5))\nsubplot(1,2,1, polar=true)\ngrid(false)\nhm = contourf(deg2rad.(collect((0:360))),collect(0:1:85),  A,  cmap=:viridis, levels=collect(0.25:0.012:0.5))\ntitle(\"NIR reflectance BRDF\")\nyticks([])\ncolorbar()\nsubplot(1,2,2, polar=true)\ngrid(false)\nhm = contourf(deg2rad.(collect((0:360))),collect(0:1:85),  A_clump,  cmap=:viridis, levels=collect(0.25:0.012:0.5))\ntitle(\"Clumping\")\nyticks([])\ncolorbar()\ngcf()","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"figure(figsize=(10,5))\nsubplot(1,2,1, polar=true)\ngrid(false)\nhm = contourf(deg2rad.(collect((0:360))),collect(0:1:85),  B,  cmap=:viridis, levels=collect(0.0:0.005:0.045))\ntitle(\"Red reflectance BRDF\")\nyticks([])\ncolorbar()\nsubplot(1,2,2, polar=true)\ngrid(false)\nhm = contourf(deg2rad.(collect((0:360))),collect(0:1:85),  B_clump,  cmap=:viridis, levels=collect(0.0:0.005:0.045))\ntitle(\"Clumping\")\nyticks([])\ncolorbar()\ngcf()","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"figure(figsize=(10,5))\nsubplot(1,2,1, polar=true)\ngrid(false)\nhm = contourf(deg2rad.(collect((0:360))),collect(0:1:85),  SIFFER,  cmap=:viridis, levels=collect(0.3:0.05:0.8))\ntitle(\"Red SIF emission BRDF\")\nyticks([])\ncolorbar()\nsubplot(1,2,2, polar=true)\ngrid(false)\nhm = contourf(deg2rad.(collect((0:360))),collect(0:1:85),  SIFFER_clump,  cmap=:viridis, levels=collect(0.3:0.05:0.8))\ntitle(\"Clumping\")\nyticks([])\ncolorbar()\ngcf()","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"figure(figsize=(10,5))\nsubplot(1,2,1, polar=true)\ngrid(false)\nhm = contourf(deg2rad.(collect((0:360))),collect(0:1:85),  SIFFER_FR,  cmap=:viridis, levels=collect(1.:0.1:3.5))\ntitle(\"Far-Red SIF emission BRDF\")\nyticks([])\ncolorbar()\nsubplot(1,2,2, polar=true)\ngrid(false)\nhm = contourf(deg2rad.(collect((0:360))),collect(0:1:85),  SIFFER_FR_clump,  cmap=:viridis, levels=collect(1.:0.1:3.5))\ntitle(\"Clumping\")\nyticks([])\ncolorbar()\ngcf()","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"","category":"page"},{"location":"generated/RAMI_benchmarking_example/#","page":"RAMI benchmarking","title":"RAMI benchmarking","text":"This page was generated using Literate.jl.","category":"page"},{"location":"pages/Tips/#Git-and-Julia-Tips-for-CliMA.Land-1","page":"Tips","title":"Git and Julia Tips for CliMA.Land","text":"","category":"section"},{"location":"pages/Tips/#Instantiate-the-project-1","page":"Tips","title":"Instantiate the project","text":"","category":"section"},{"location":"pages/Tips/#","page":"Tips","title":"Tips","text":"The Land project\ncd .../Land to the home directory of the project\njulia --project\nusing Pkg\nPkg.instantiate()\nDelete the file Manifest.toml when encountering errors\nRedo Pkg.instantiate()\nThe docs/ project\ncd .../Land/docs\njulia --project\nusing Pkg\nPkg.instantiate()\nDelete the file Manifest.toml when encountering erros\nDelete the line Land=\"*\" in the Project.toml\nType ] in the julia REPL to enter the pkg environment\ndev .. or add .. to add the Land project\nRedo Pkg.instantiate()","category":"page"},{"location":"pages/Tips/#Run-local-tests-before-merging-into-master-1","page":"Tips","title":"Run local tests before merging into master","text":"","category":"section"},{"location":"pages/Tips/#","page":"Tips","title":"Tips","text":"Optional: load the Land project\ncd .../Land to the home directory of the project\njulia --project\nusing Land to make sure the project can be loaded\nOptional: disable the tutorial to save some time\nchange generate_tutorials = true to generate_tutorials = false in file docs/list_of_tutorials.jl\nchange the line back to generate_tutorials = true before commiting the changes\nOptional: initialize the project\ncd .../Land to the home directory of the project\njulia --project -e \"using Pkg; Pkg.instantiate(); Pkg.build(); Pkg.precompile();\"\njulia --project=docs/ -e \"using Pkg; Pkg.instantiate(); Pkg.build(); Pkg.precompile();\"\nTest the documentation project\njulia --project=docs/ docs/make.jl\nFix errors and warnings associated with Land project\nTest the Land project\njulia --project -e \"using Pkg; Pkg.test();\"\nResolve failed tests","category":"page"},{"location":"pages/Tips/#Rebase-the-commits-before-merging-into-master-1","page":"Tips","title":"Rebase the commits before merging into master","text":"","category":"section"},{"location":"pages/Tips/#","page":"Tips","title":"Tips","text":"Switch to the feature branch and make sure you have a clean workspace\ngit checkout FeatureBranch\ngit status to confirm zero uncommitted changes\nBackup current branch to avoid unexpected errors\ngit checkout -b FeatureBranch_Backup\nSync the master branch\ngit checkout master\ngit pull\nSwitch to the feature branch and merge master into it\ngit checkout FeatureBranch\ngit status to confirm zero uncommitted changes\ngit merge master\nResolve conflicts and commit them if any\nReabse the feature branch\ngit reset origin/master to rewrite history\ngit diff (optional) would show all the changes\ngit add --all to add local changes on top of master\ngit commit -m \"Single commit message\"\ngit push -f to force push because of the re-written history\nCreate a Pull Request\nThrough the web\nRemove local unnecessary branch (e.g., FeatureBranch_backup)\ngit branch -d FeatureBranch_Backup\ngit branch -D FeatureBranch_Backup to force remove","category":"page"},{"location":"pages/Hydraulics/#Hydraulics-module-for-the-LAND-model-1","page":"Hydraulics","title":"Hydraulics module for the LAND model","text":"","category":"section"},{"location":"pages/Hydraulics/#Types-1","page":"Hydraulics","title":"Types","text":"","category":"section"},{"location":"pages/Hydraulics/#","page":"Hydraulics","title":"Hydraulics","text":"Land.Hydraulics.AbstractHydraulicSystem\nLand.Hydraulics.LeafHydraulics\nLand.Hydraulics.RootHydraulics\nLand.Hydraulics.StemHydraulics","category":"page"},{"location":"pages/Hydraulics/#Land.Hydraulics.AbstractHydraulicSystem","page":"Hydraulics","title":"Land.Hydraulics.AbstractHydraulicSystem","text":"type AbstractHydraulicSystem\n\nHierarchy of AbstractHydraulicSystem\n\nLeafHydraulics\nRootHydraulics\nStemHydraulics\n\n\n\n\n\n","category":"type"},{"location":"pages/Hydraulics/#Land.Hydraulics.LeafHydraulics","page":"Hydraulics","title":"Land.Hydraulics.LeafHydraulics","text":"struct LeafHydraulics{FT<:AbstractFloat}\n\nA struct that contains leaf hydraulics information.\n\nFields\n\nb\nWeibull function (k = k_max * exp( -(-p/B)^C )) parameter B [MPa]\nc\nWeibull function (k = k_max * exp( -(-p/B)^C )) parameter C\nk_ox\nMaximal extra-xylary hydraulic conductance [mol s⁻¹ MPa⁻¹ m⁻²]\nk_sla\nMaximal leaf hydraulic conductance per leaf area [mol s⁻¹ MPa⁻¹ m⁻²]\np_crt\nCritical xylem pressure [MPa]\nflow\nFlow rate in the xylem [mol s⁻¹]\np_dos\nLeaf xylem water pressure at the downstream end of leaf xylem [MPa]\np_leaf\nLeaf end water pressure at air-water interface [MPa]\np_ups\nLeaf xylem water pressure at the leaf base (upstream) [MPa]\nk_element\nList of leaf k_max per element [mol s⁻¹ MPa⁻¹ m⁻²]\nk_history\nList of leaf kr history per element\np_element\nList of xylem water pressure [MPa]\np_history\nList of xylem water pressure history (normalized to 298.15 K) [MPa]\nf_st\nRelative surface tension\nf_vis\nRelative viscosity\nT_sap\nUpstream sap temperature [K]\n\n\n\n\n\n","category":"type"},{"location":"pages/Hydraulics/#Land.Hydraulics.RootHydraulics","page":"Hydraulics","title":"Land.Hydraulics.RootHydraulics","text":"struct RootHydraulics{FT<:AbstractFloat}\n\nA struct that contains root hydraulics information.\n\nFields\n\narea\nRoot cross-section area [m²]\nb\nWeibull function (k = k_max * exp( -(-p/B)^C )) parameter B [MPa]\nc\nWeibull function (k = k_max * exp( -(-p/B)^C )) parameter C\nk_max\nMaximal hydraulic conductance [mol s⁻¹ MPa⁻¹]\nk_s\nMaximal xylem hydraulic conductivity [mol s⁻¹ MPa⁻¹ m⁻²]\nΔh\nRoot z difference [m]\nk_rhiz\nRhizosphere  conductance [mol s⁻¹ MPa⁻¹]\nsoil_type\nSoil type\nsoil_α\nα is related to the inverse of the air entry suction, α > 0\nsoil_n\nMeasure of the pore-size distribution\nsoil_m\n1 - 1/n\nflow\nFlow rate in the xylem [mol s⁻¹]\np_dos\nXylem water pressure at the downstream end of xylem [MPa]\np_rhiz\nXylem-rhizosphere interface water pressure [MPa]\np_ups\nSoil matrix potential [MPa]\nk_element\nList of k_max per element [mol s⁻¹ MPa⁻¹ m⁻²]\nk_history\nList of kr history per element\np_element\nList of xylem water pressure [MPa]\np_gravity\nList of pressure drop caused by gravity [MPa]\np_history\nList of xylem water pressure history (normalized to 298.15 K) [MPa]\nf_st\nRelative surface tension\nf_vis\nRelative viscosity\nT_sap\nUpstream sap temperature [K]\n\n\n\n\n\n","category":"type"},{"location":"pages/Hydraulics/#Land.Hydraulics.StemHydraulics","page":"Hydraulics","title":"Land.Hydraulics.StemHydraulics","text":"struct StemHydraulics{FT<:AbstractFloat}\n\nA struct that contains stem hydraulics information.\n\nFields\n\narea\nStem cross-section area [m²]\nb\nWeibull function (k = k_max * exp( -(-p/B)^C )) parameter B [MPa]\nc\nWeibull function (k = k_max * exp( -(-p/B)^C )) parameter C\nk_max\nMaximal hydraulic conductance [mol s⁻¹ MPa⁻¹]\nk_s\nMaximal xylem hydraulic conductivity [mol s⁻¹ MPa⁻¹ m⁻²]\nΔh\nStem height difference [m]\np_dos\nXylem water pressure at the downstream end of xylem [MPa]\np_ups\nXylem water pressure at the base (upstream) [MPa]\nk_element\nList of k_max per element [mol s⁻¹ MPa⁻¹ m⁻²]\nk_history\nList of kr history per element\np_element\nList of xylem water pressure [MPa]\np_gravity\nList of pressure drop caused by gravity [MPa]\np_history\nList of xylem water pressure history (normalized to 298.15 K) [MPa]\nf_st\nRelative surface tension\nf_vis\nRelative viscosity\nT_sap\nUpstream sap temperature [K]\n\n\n\n\n\n","category":"type"},{"location":"pages/Hydraulics/#Xylem-Hydraulics-1","page":"Hydraulics","title":"Xylem Hydraulics","text":"","category":"section"},{"location":"pages/Hydraulics/#","page":"Hydraulics","title":"Hydraulics","text":"Land.Hydraulics.xylem_p_from_flow\nLand.Hydraulics.hydraulic_p_profile!","category":"page"},{"location":"pages/Hydraulics/#Land.Hydraulics.xylem_p_from_flow","page":"Hydraulics","title":"Land.Hydraulics.xylem_p_from_flow","text":"xylem_p_from_flow(hs::LeafHydraulics{FT}, flow::FT)\n\nReturn the xylen end pressure from flow rate, given\n\nhs AbstractHydraulicSystem type struct\nflow Flow rate (per leaf area)\n\nNote, gravity is accounted for in root and stem; rhizosphere conductance is     accounted for in root; extra-xylary conductance is not accounted for in     leaf here because it calculates xylem end pressure.\n\n\n\n\n\n","category":"function"},{"location":"pages/Hydraulics/#Land.Hydraulics.hydraulic_p_profile!","page":"Hydraulics","title":"Land.Hydraulics.hydraulic_p_profile!","text":"hydraulic_p_profile!(hs::LeafHydraulics{FT}, flow::FT)\n\nUpdate the pressure profile, given\n\nhs AbstractHydraulicSystem type struct\nflow Flow rate (per leaf area)\n\n\n\n\n\n","category":"function"},{"location":"pages/Hydraulics/#Leaf-Hydraulics-1","page":"Hydraulics","title":"Leaf Hydraulics","text":"","category":"section"},{"location":"pages/Hydraulics/#","page":"Hydraulics","title":"Hydraulics","text":"Land.Hydraulics.leaf_xylem_risk\nLand.Hydraulics.leaf_e_crit","category":"page"},{"location":"pages/Hydraulics/#Land.Hydraulics.leaf_xylem_risk","page":"Hydraulics","title":"Land.Hydraulics.leaf_xylem_risk","text":"leaf_xylem_risk(hs::LeafHydraulics{FT}, flow::FT)\n\nEvaluate the hydraulic risk at the end of leaf xylem, given\n\nhs AbstractHydraulicSystem type struct\nflow Flow rate (per leaf area)\n\n\n\n\n\n","category":"function"},{"location":"pages/Hydraulics/#Land.Hydraulics.leaf_e_crit","page":"Hydraulics","title":"Land.Hydraulics.leaf_e_crit","text":"leaf_e_crit(hs::LeafHydraulics{FT})\n\nCalculate the critical flow rate (K ≈ 0), given\n\nhs AbstractHydraulicSystem type struct\n\nNote, for the safety of no NaN, update e_crit when ΔP >= -0.01\n\n\n\n\n\n","category":"function"},{"location":"pages/Hydraulics/#Root-Hydraulics-1","page":"Hydraulics","title":"Root Hydraulics","text":"","category":"section"},{"location":"pages/Hydraulics/#","page":"Hydraulics","title":"Hydraulics","text":"Land.Hydraulics.root_q_from_pressure\nLand.Hydraulics.q_diff\nLand.Hydraulics.root_qs_p_from_q","category":"page"},{"location":"pages/Hydraulics/#Land.Hydraulics.root_q_from_pressure","page":"Hydraulics","title":"Land.Hydraulics.root_q_from_pressure","text":"root_q_from_pressure(root::RootHydraulics, pressure::FT, ini::FT)\n\nCalculate the flow rate from a given tree base pressure, given\n\nroot RootHydraulics type struct\npressure Given tree base pressure in [MPa]\nini Start point for RootSolvers\n\n\n\n\n\n","category":"function"},{"location":"pages/Hydraulics/#Land.Hydraulics.q_diff","page":"Hydraulics","title":"Land.Hydraulics.q_diff","text":"q_diff(roots::Array{RootHydraulics{FT},1}, pressure::FT, target::FT)\n\nFunction to calculate the flow rate difference to find solution pressure, given\n\nroot RootHydraulics type struct\npressure Given tree base pressure in [MPa]\ntarget Target flow rate in [mol s⁻¹]\n\n\n\n\n\n","category":"function"},{"location":"pages/Hydraulics/#Land.Hydraulics.root_qs_p_from_q","page":"Hydraulics","title":"Land.Hydraulics.root_qs_p_from_q","text":"root_qs_p_from_q(roots::Array{RootHydraulics{FT},1}, flow::FT, ini::FT)\n\nSolve for the flow rates in each root layer and root pressure, given\n\nroots Array of RootHydraulics struts\nflow Total flow rates\nini Initial guess of plant base pressure in [MPa]\n\n\n\n\n\n","category":"function"},{"location":"#CliMA-Land-Model-1","page":"Home","title":"CliMA Land Model","text":"","category":"section"},{"location":"#Use-Land-model-1","page":"Home","title":"Use Land model","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"julia> using Pkg\njulia> Pkg.add(PackageSpec(url=\"https://github.com/CliMA/Land.git\"))\njulia> using Land\njulia> using Land.Photosynthesis","category":"page"},{"location":"#Pages-description-1","page":"Home","title":"Pages description","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"Tips           -- docs/src/pages/Tips.md\nHydraulics     -- docs/src/pages/Hydraulics.md\nPhotosynthesis -- docs/src/pages/Photosynthesis.md\nCanopyRT       -- docs/src/pages/CanopyRT.md\nUtils          -- docs/src/pages/Utils.md\nTutorials      -- docs/src/tutorial_scripts/*.jl","category":"page"},{"location":"#Deprecated-(to-be-deleted?)-1","page":"Home","title":"Deprecated (to be deleted?)","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"Leaf  -- docs/src/pages/Leaf.md\nPlant -- docs/src/pages/Plant.md","category":"page"},{"location":"#To-do-lists-1","page":"Home","title":"To do lists","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"Add more docs to the sub-modules","category":"page"}]
}
