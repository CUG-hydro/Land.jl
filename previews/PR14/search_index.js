var documenterSearchIndex = {"docs":
[{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"EditURL = \"https://github.com/CliMA/Land/blob/master/notebooks/Radiation_Test_BRDF.jl\"","category":"page"},{"location":"generated/Radiation_Test_BRDF/#Canopy-Radiative-Transfer-Example-#1-1","page":"Reflected and Emitted Radiance","title":"Canopy Radiative Transfer Example #1","text":"","category":"section"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"This example will go through the calculations of hemispheric and bidirectional reflectance as well as emission of Solar Induced Chlorophyll Fluorescence (SIF). The sun sensor geometry is defined by the solar zenith angle SZA, the viewing zenith angle VZA (observer, 0degrees=Nadir looking) and the relative azimuth angle between the sun and observer (0 or 180degrees denoting the principal plane).","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"# Use Julia Plots package and switch to plotly js option:\nusing Plots\nusing Conda\nConda.add(\"matplotlib\")\n\npyplot()\n#plotlyjs()","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"First, we include Revise (good for debugging) and Parameters (tools for structures)","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"#using Revise\nusing Parameters","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"Now include the Land modules","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"using Land\nusing Land.CanopyRT","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"and unpack some of the mostly used variables or structure (same as writing CanopyRT.leafbio)","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"#@unpack FT, leafbio, canopy, angles, canOpt, canRad,sunRad,soil, wl, wle, wlf = CanopyRT","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"This extracted a number of structures, which are loaded with default values at startup:","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"leafbio includes all leaf pigment concentrations, such as Chlorophyll, leaf water, Carotenoids and dry matter content. (mutable struct leafbio)\ncanopy includes Canopy properties such as LAI, leaf inclination distribution, clumping factor (mutable struct struct_canopy)\nangles includes SZA, VZA and azimuth (mutable struct struct_angles)\ncanOpt saves a variety of canopy optical properties to be computed (mutable struct struct_canopyOptProps)\ncanRad includes radiation computed within the Canopy RT module (mutable struct struct_canopyRadiation)\nsunRad provides incoming direct and diffuse incoming solar radiation (mutable struct incomingRadiation)\nsoil provides soil albedo and skin temperature","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"as well as some arrays:","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"wl is the wavelength grid (nm) for the solar radiation computation\nwle is the wavelength grid in the photosynthetically active range (a subset of wl, used to define fluorescence excitation and driving photosynthesis)\nwlf is the wavelength grid for SIF (subset of wl). The fluorescence excitation matrices are defined on the basis of wle and wlf.","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"Let us just define our own leaf here, we can construct it using standard values but need to provide all dimensions (will be fixed as variables are saved in MArrays):","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"leaf = leafbio{FT, length(wl), length(wle), length(wlf),length(wle)*length(wlf)}();\n# show leaf Chlorophyll content:\n@show leaf.Cab","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"","category":"page"},{"location":"generated/Radiation_Test_BRDF/#Leaf-Optical-Properties-1","page":"Reflected and Emitted Radiance","title":"Leaf Optical Properties","text":"","category":"section"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"Now we can first run fluspect, which is an extension of the Prospect leaf optical properties program and includes computations of the fluorescence emission responses as well. CanopyRT.optis includes all pigment absorption cross sections as well as refractive index of water to compute leaf optical properties. For details, see:","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"FÃ©ret, J.B., Gitelson, A.A., Noble, S.D. and Jacquemoud, S., 2017. PROSPECT-D: Towards modeling leaf optical properties through a complete lifecycle. Remote Sensing of Environment, 193, pp.204-215.","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"Van der Tol, C., Verhoef, W., Timmermans, J., Verhoef, A. and Su, Z., 2009. An integrated model of soil-canopy spectral radiances, photosynthesis, fluorescence, temperature and energy balance. Biogeosciences, 6(12).","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"Vilfan, N., Van der Tol, C., Muller, O., Rascher, U. and Verhoef, W., 2016. Fluspect-B: A model for leaf fluorescence, reflectance and transmittance spectra. Remote sensing of environment, 186, pp.596-615.","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"# Run Fluspect:\nCanopyRT.fluspect!(leaf, CanopyRT.optis);\nnothing #hide","category":"page"},{"location":"generated/Radiation_Test_BRDF/#Fluorescence-excitation-matrices-1","page":"Reflected and Emitted Radiance","title":"Fluorescence excitation matrices","text":"","category":"section"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"Now we can visualize the fluorescence excitatiom matrices, which determine how absorbed photons at a specific wavelength wle incident on the leaf are emitted backwards (in relation to the incident light but hemispherically diffuse here) or forward. Here, we ignore contributions from Photosystem I and just use a fixed shape as input at the chloroplast level for Photosystem II, hence all spectral shapes are determined by the light distribution within the leaf. Several effects can be observed in the plots below: The first SIF peak at 680nm is much weaker in the forward direction than in the backward direction as more the re-absorption within the leaf is much higher for the forward direction. Similarly, blue incident light penetrates the leaf less than at higher wavelengths, so the chlorophyll re-absorption (backwards) is less re-absorbed by chlorophyll as it emanates from less deep layers.","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"# Plot Mb matrix\ncontourf(wle, wlf, leaf.Mb)\nxlabel!(\"Excitation wavelength (nm)\")\nylabel!(\"Emission wavelength (nm)\")\ntitle!(\"Fluorescence backward (refl) emission (Mb)\")","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"# Plot Mf matrix\ncontourf(wle, wlf, leaf.Mf)\nxlabel!(\"Excitation wavelength (nm)\")\nylabel!(\"Emission wavelength (nm)\")\ntitle!(\"Fluorescence forward (transmission) emission (Mf)\")","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"# Define a few wavelengths:\nwl_blue = 450.0;\nwl_red = 600.0;\nwl_FarRed = 740.0;\nwl_Red = 685.0;\nind_wle_blue  = argmin(abs.(wle .-wl_blue));\nind_wle_red = argmin(abs.(wle .-wl_red));\nind_wlf_FR  = argmin(abs.(wlf .-wl_FarRed));\nind_wlf_R  = argmin(abs.(wlf .-wl_Red));\nind_red = argmin(abs.(wl .-wl_Red));\nind_NIR = argmin(abs.(wl .-800));\nnothing #hide","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"# Plot some cross section in wle and wlf space:\nplot(wlf,leaf.Mf[:,ind_wle_blue], color=[:black], lw = 2 , label=\"Forward SIF, excited at $wl_blue nm\")\nplot!(wlf,leaf.Mb[:,ind_wle_blue],color=[:orange], lw = 2 , label=\"Backward SIF, excited at $wl_blue nm\" )\nplot!(wlf,leaf.Mf[:,ind_wle_red], color=[:black],line=(:dash,2), label=\"Forward SIF, excited at $wl_red nm\" )\nplot!(wlf,leaf.Mb[:,ind_wle_red], color=[:orange],line=(:dash,2), label=\"Backward SIF, excited at $wl_red nm\" )\nxlabel!(\"Wavelength (nm)\")\nylabel!(\"Fluorescence\")","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"# Plot some cross section in wle and wlf space:\nplot(wle,leaf.Mf[ind_wlf_FR,:], color=[:black], lw = 2 , label=\"Forward SIF, emitted at $wl_FarRed nm\")\nplot!(wle,leaf.Mb[ind_wlf_FR,:],color=[:orange], lw = 2 , label=\"Backward SIF, emitted at $wl_FarRed nm\" )\nplot!(wle,leaf.Mf[ind_wlf_R,:], color=[:black],line=(:dash,2), label=\"Forward SIF, emitted at $wl_Red nm\" )\nplot!(wle,leaf.Mb[ind_wlf_R,:], color=[:orange],line=(:dash,2), label=\"Backward SIF, emitted at $wl_Red nm\" )\nxlabel!(\"Absorbed Wavelength (nm)\")\nylabel!(\"Fluorescence\")","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"","category":"page"},{"location":"generated/Radiation_Test_BRDF/#Leaf-reflectance-and-transmission-1","page":"Reflected and Emitted Radiance","title":"Leaf reflectance and transmission","text":"","category":"section"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"Within Fluspect, leaf reflectance and transmission is calculated (this part is actually identical to what PROSPECT is doing and much less involved than the Fluorescence part). The model basically uses a doubling adding routine to solve for the radiative transfer within the leaf using constituent absorption cross sections and constituent abundances in the leaf (assuming vertically homogenous distribution).","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"Here, we just create another leaf with different concentrations to show the impact on leaf reflectance and transmission due to changes in chlorophyll content and liquid water content (mostly in the two liquid water absorption bands at 1400 and 1900nm).","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"# Let's create a leaf with a different Cab and Cw (water) content (<span style=\"color:red\">Try changing other pigment contents, plot leaf reflectance and transmissions and explain where (spectrally) and why reflectance and transmission changes</span>):\nleaf_2 = leafbio{FT, length(wl), length(wle), length(wlf),length(wle)*length(wlf)}();\nleaf_2.Cab = 80\nleaf_2.Cw = 0.012\n# show leaf Chlorophyll content:\n# and Run Fluspect:\nCanopyRT.fluspect!(leaf_2, CanopyRT.optis);\nnothing #hide","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"plot(wl,1 .-leaf.Ï_SW, color=[:black], lw = 2 , label=\"Leaf Transmission\")\nplot!(wl,leaf.Ï_SW,color=[:orange], lw = 2 , label=\"Leaf Reflectance\" )\nplot!(wl,1 .-leaf_2.Ï_SW, color=[:black], line=(:dash,2), label=\"Leaf ##2 Transmission\")\nplot!(wl,leaf_2.Ï_SW,color=[:orange], line=(:dash,2), label=\"Leaf ##2 Reflectance\" )\nxlabel!(\"Wavelength (nm)\")","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"","category":"page"},{"location":"generated/Radiation_Test_BRDF/#Moving-from-the-leaf-to-the-entire-canopy-1","page":"Reflected and Emitted Radiance","title":"Moving from the leaf to the entire canopy","text":"","category":"section"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"Our model here is based on mSCOPE[1] and we can prescribe different leaf optical properties within a complex canopy. At the moment, the leaf angular distribution is the same vertically (but could be changed in the future).","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"[1]: Yang, P., Verhoef, W. and van der Tol, C., 2017. The mSCOPE model: A simple adaptation to the SCOPE model to describe reflectance, fluorescence and photosynthesis of vertically heterogeneous canopies. Remote sensing of environment, 201, pp.1-11.","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"# This is to be changed later but at the moment, we need to generate an Array of leaves, basically for each layer of the canopy\narrayOfLeaves = Array{leafbio{FT,length(wl), length(wle), length(wlf),length(wle)*length(wlf)}, 1}(undef, CanopyRT.canopy.nlayers)\nfor i = 1:CanopyRT.canopy.nlayers\n    ##@show i\n    arrayOfLeaves[i] = leafbio{FT, length(wl), length(wle), length(wlf),length(wle)*length(wlf)}()\n    CanopyRT.fluspect!(arrayOfLeaves[i], CanopyRT.optis)\nend","category":"page"},{"location":"generated/Radiation_Test_BRDF/#Basic-Steps-for-Canopy-RT:-1","page":"Reflected and Emitted Radiance","title":"Basic Steps for Canopy RT:","text":"","category":"section"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"Below are the basic steps for the canopy radiative transfer (SIF fluxes are dependent on stress levels at each leaf but here we use a standard SIF yield for now):","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"# Set Soil albedo to 0.2\nCanopyRT.soil.albedo_SW[:] .=0.2;\n# Compute Canopyoptical properties dependend on sun-sensor and leaf angle distributions:\nCanopyRT.computeCanopyGeomProps!(canopy, angles,canOpt);\n# Compute RT matrices with leaf reflectance and transmissions folded in:\nCanopyRT.computeCanopyMatrices!(arrayOfLeaves,canOpt);\n# Perform SW radiation transfer:\nCanopyRT.RTM_SW!(canopy, canOpt, canRad,sunRad, CanopyRT.soil);\n# Compute outgoing SIF flux (using constant fluorescence efficiency at the chloroplast level)\nCanopyRT.computeSIF_Fluxes!(arrayOfLeaves, canOpt, canRad, canopy, CanopyRT.soil);\nnothing #hide","category":"page"},{"location":"generated/Radiation_Test_BRDF/#Test-a-VZA-dependence-in-the-principal-plane-1","page":"Reflected and Emitted Radiance","title":"Test a VZA dependence in the principal plane","text":"","category":"section"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"SIF_FR = Float32[]\nSIF_R = Float32[]\nreflVIS = Float32[]\nreflNIR = Float32[]\n\n# Just running the code over all geometries:\n\n# Set sun SZA to 30 degrees\nCanopyRT.angles.tts=30\n# Set 0 azimuth (principal plane)\nCanopyRT.angles.psi=0\n# LAI of 3:\nCanopyRT.canopy.LAI = 3\n# Define VZA\nVZA=collect(-89.5:0.5:89.5)\n\nfor VZA_ in VZA\n    CanopyRT.angles.tto=VZA_\n    CanopyRT.computeCanopyGeomProps!(canopy, angles,canOpt);\n    CanopyRT.computeCanopyMatrices!(arrayOfLeaves,canOpt);\n    CanopyRT.RTM_SW!(canopy, canOpt, canRad,sunRad, CanopyRT.soil);\n    CanopyRT.computeSIF_Fluxes!(arrayOfLeaves, canOpt, canRad, canopy, CanopyRT.soil);\n    # Handpicked indices in\n    push!(reflVIS, canRad.alb_obs[ind_red])\n    push!(reflNIR, canRad.alb_obs[ind_NIR])\n    push!(SIF_R , canRad.SIF_obs[ind_wlf_R])\n    push!(SIF_FR, canRad.SIF_obs[ind_wlf_FR ])\nend","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"# Plots Visible\nplot(VZA, reflVIS, label=\"Red Reflectance\", lw=2)\nplot!(VZA, SIF_R/30, label=\"Red SIF (/30)\", lw=2)\nxlabel!(\"Viewing Zenith Angle\")","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"# Plot Near Infrared:\nplot(VZA, reflNIR, label=\"NIR Reflectance\", lw=2)\nplot!(VZA, SIF_FR/6, label=\"Far Red SIF (/6)\", lw=2)\nxlabel!(\"Viewing Zenith Angle\")","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"","category":"page"},{"location":"generated/Radiation_Test_BRDF/#BRDF-sampling-1","page":"Reflected and Emitted Radiance","title":"BRDF sampling","text":"","category":"section"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"By going through viewing and azimuth angles, we can construct a full BRDF for reflectance and SIF emissions at different wavelengths:","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"reflVIS = Float32[]\nreflNIR = Float32[]\nSIF_FR = Float32[]\nSIF_R  = Float32[]\nCanopyRT.angles.tts=48\nCanopyRT.angles.psi=0\nCanopyRT.canopy.LAI=3.22\nfor psi=0:360\n    CanopyRT.angles.psi=psi\n    for VZA=0:1:85\n        CanopyRT.angles.tto=VZA\n\n        CanopyRT.computeCanopyGeomProps!(canopy, angles,canOpt);\n        CanopyRT.computeCanopyMatrices!(arrayOfLeaves,canOpt);\n        CanopyRT.RTM_SW!(canopy, canOpt, canRad,sunRad, CanopyRT.soil);\n        CanopyRT.computeSIF_Fluxes!(arrayOfLeaves, canOpt, canRad, canopy, CanopyRT.soil);\n        push!(reflVIS, canRad.alb_obs[28])\n        push!(reflNIR, canRad.alb_obs[52])\n        push!(SIF_R , canRad.SIF_obs[8])\n        push!(SIF_FR, canRad.SIF_obs[20])\n    end\nend","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"A = reshape(reflNIR, ( 86,361));\nB = reshape(reflVIS, ( 86,361));\nSIFFER = reshape(SIF_R, ( 86,361));\nSIFFER_FR = reshape(SIF_FR, ( 86,361));\nnothing #hide","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"##heatmap(A, cmap=)\nhm = contourf(deg2rad.(collect((0:360))),collect(0:1:85),  A,  proj=:polar, color=:viridis, alpha=0.5)\ntitle!(\"NIR reflectance BRDF\")","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"##heatmap(A, cmap=)\nhm = contourf(deg2rad.(collect((0:360))),collect(0:1:85),  B,  proj=:polar, color=:viridis)\ntitle!(\"VIS reflectance BRDF\")","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"hm = contourf(deg2rad.(collect((0:360))),collect(0:1:85),  SIFFER, proj=:polar, color=:viridis)\ntitle!(\"Red SIF emission BRDF\")","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"hm = contourf(deg2rad.(collect((0:360))),collect(0:1:85),  SIFFER_FR, proj=:polar, color=:viridis)\ntitle!(\"Far Red SIF emission BRDF\")","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"","category":"page"},{"location":"generated/Radiation_Test_BRDF/#","page":"Reflected and Emitted Radiance","title":"Reflected and Emitted Radiance","text":"This page was generated using Literate.jl.","category":"page"},{"location":"characters/#Unicode-characters-for-quick-reference-1","page":"Unicode characters for quick reference","title":"Unicode characters for quick reference","text":"","category":"section"},{"location":"characters/#Greek-1","page":"Unicode characters for quick reference","title":"Greek","text":"","category":"section"},{"location":"characters/#","page":"Unicode characters for quick reference","title":"Unicode characters for quick reference","text":"Î    Î± Î    Î² Î    Î³ Î    Î´ Î    Îµ Î    Î¶ Î    Î· Î    Î¸ Î    Î¹ Î    Îº Î    Î» Î    Î¼ Î    Î½ Î    Î¾ Î    Î¿ Î     Ï Î¡    Ï Î£    Ï/Ï Î¤    Ï Î¥    Ï Î¦    Ï Î§    Ï Î¨    Ï Î©    Ï","category":"page"},{"location":"characters/#sub-and-sup-scripts-1","page":"Unicode characters for quick reference","title":"sub- and sup-scripts","text":"","category":"section"},{"location":"characters/#","page":"Unicode characters for quick reference","title":"Unicode characters for quick reference","text":"1    Â¹    â 2    Â²    â 3    Â³    â 4    â´    â 5    âµ    â 6    â¶    â 7    â·    â 8    â¸    â 9    â¹    â 0    â° \t  â .    Ë    ?","category":"page"},{"location":"characters/#","page":"Unicode characters for quick reference","title":"Unicode characters for quick reference","text":"â»    â\nâº    â","category":"page"},{"location":"characters/#","page":"Unicode characters for quick reference","title":"Unicode characters for quick reference","text":"â»Â¹ â»Â² â»Â³","category":"page"},{"location":"characters/#degree-1","page":"Unicode characters for quick reference","title":"degree","text":"","category":"section"},{"location":"characters/#","page":"Unicode characters for quick reference","title":"Unicode characters for quick reference","text":"Â°C Â°","category":"page"},{"location":"#Land-model-1","page":"Home","title":"Land model","text":"","category":"section"},{"location":"#Example-Documentation-1","page":"Home","title":"Example Documentation","text":"","category":"section"},{"location":"#Canopy-RT-module-1","page":"Home","title":"Canopy RT module","text":"","category":"section"},{"location":"#Leaf-Bio-Structure:-1","page":"Home","title":"Leaf Bio Structure:","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"Land.CanopyRT.leafbio","category":"page"},{"location":"#Land.CanopyRT.leafbio","page":"Home","title":"Land.CanopyRT.leafbio","text":"leafbio\n\nFields\n\nN\nLeaf structure parameter (-)\nCab\nChlorophyll a+b content (Âµg cm-2)\nCar\nCarotenoid content (Âµg cm-2)\nAnt\nAnthocynanin content (Âµg cm-2)\nCs\nSenescent material fraction (-)\nCw\nEquivalent water thickness (cm)\nCm\nDry matter content (dry leaf mass per unit area) (g cm-2)\nCx\nFractionation between Zeaxanthin and Violaxanthin in Car (1=all Zeaxanthin) (-)\nÏ_LW\nBroadband thermal reflectance (-)\nÏ_LW\nBroadband thermal transmission (-)\nfqe\nLeaf fluorescence efficiency (Fo standard)\nÏ_SW\nshortwave leaf reflectance (-)\nÏ_SW\nshortwave leaf transmission (-)\nkChlrel\nrelative absorbtion by Chlorophyll+Car (-)\nkChlrel_old\nrelative absorbtion by Chlorophyll (-)\nMb\nFluorescence excitation matrix backwards (-)\nMf\nFluorescence excitation matrix forwards (-)\n\n\n\n\n\n","category":"type"},{"location":"#Canopy-Structure-1","page":"Home","title":"Canopy Structure","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"Land.CanopyRT.struct_canopy","category":"page"},{"location":"#Land.CanopyRT.struct_canopy","page":"Home","title":"Land.CanopyRT.struct_canopy","text":"struct_canopy\n\nFields\n\nnlayers\nnumber of canopy layers\nLAI\nLeaf Area Index\nÎ©\nClumping factor\nclump_a\nStructure factor a\nclump_b\nStructure factor b\nleafwidth\nLeaf width\nhc\nVegetation height\nLIDFa\nLeaf Inclination\nLIDFb\nVariation in leaf inclination\nhot\nHotSpot parameter (still need to check!)\nheight\nCanopy height (m)\nz0m\nCanopy roughness (m)\nz0h\nd\nCanopy displacement height (m)\nCd\nm/sqrt(s) turbulent transfer coefficient\nlazitab\nlidf\nxl\ndx\n\n\n\n\n\n","category":"type"},{"location":"#Canopy-Radiation-Structure-1","page":"Home","title":"Canopy Radiation Structure","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"Land.CanopyRT.struct_canopyRadiation","category":"page"},{"location":"#Land.CanopyRT.struct_canopyRadiation","page":"Home","title":"Land.CanopyRT.struct_canopyRadiation","text":"struct_canopyRadiation\n\nFields\n\nintEout\nintegrated TOC outgoing flux (W m^-2)\nincomingPAR\nincident spectrally integrated total PAR (moles m^-2 s^-1)\nincomingPAR_direct\nincident spectrally integrated direct PAR (moles m^-2 s^-1)\nincomingPAR_diffuse\nincident spectrally integrated diffuse PAR (moles m^-2 s^-1)\nRnSoil_diffuse\nnet radiation of shaded soil (W m^-2)\nRnSoil_direct\nnet Short-wave radiation of sunlit soil (W m^-2)\nRnSoil\nnet Short-wave radiation of soil (shaded + sunlit) (W m^-2)\nRnSoilLW\nnet long-wave radiation of soil (shaded + sunlit) (W m^-2)\nabsPAR_shade\nnet PAR of shaded leaves (moles m^-2 s^-1)\nabsPAR_shadeCab\nnet PAR by Cab+Car of shaded leaves (moles m^-2 s^-1)\nLo\nShort-wave TOC outgoing radiance in observation direction (mW m^-2 Î¼m^-1 sr^-1)\nEout\nShort-wave TOC outgoing radiation (mW m^-2 Î¼m^-1)\nalb_obs\nShort-wave Albedo in viewing direction\nalb_direct\nShort-wave Albedo for direct incoming radiation\nalb_diffuse\nShort-wave Albedo for diffuse incoming radiation\nE_up\nupwelling diffuse short-wave radiation within canopy (mW m^-2 Î¼m^-1)\nE_down\ndownwelling diffuse short-wave radiation within canopy (mW m^-2 Î¼m^-1)\nnetSW_sunlit\nnet absorbed direct radiation in each layer (mW m^-2 Î¼m^-1)\nnetSW_shade\nnet absorbed diffuse radiation in each layer (mW m^-2 Î¼m^-1)\nintNetSW_sunlit\nspectrally integrated net absorbed direct radiation in each layer (W m^-2)\nintNetSW_shade\nspectrally integrated net absorbed diffuse radiation in each layer (W m^-2)\nintNetLW_sunlit\nspectrally integrated net absorbed direct radiation in each layer (W m^-2)\nintNetLW_shade\nspectrally integrated net absorbed diffuse radiation in each layer (W m^-2)\nabsPAR_sun\nnet PAR of sunlit leaves moles m^-2 s^-1\nabsPAR_sunCab\nnet PAR by Cab+Car of sunlit leaves moles m^-2 s^-1\nT_sun3D\nLeaf temperature (sunlit) (K)\nT_sun\nLeaf temperature (sunlit) (K)\nÏ_sun\nFluorescence yield for sunlit leaves\nT_shade\nLeaf temperature (shaded) (K)\nÏ_shade\nFluorescence yield for shaded leaves\nGPP_sun\nGPP of sunlit leaves Î¼moles m^-2 s^-1\nGPP_shade\nGPP of shaded leaves Î¼moles m^-2 s^-1\nSIF_hemi\nHemispheric total outgoing SIF flux (mW m^-2 Î¼m^-1))\nSIF_obs\nObserver-direction outgoing SIF radiance  (mW m^-2 Î¼m^-1 sr^-1))\nSIF_obs_sunlit\nObserver-direction outgoing SIF radiance, sunlit leaves  (mW m^-2 Î¼m^-1 sr^-1))\nSIF_obs_shaded\nObserver-direction outgoing SIF radiance, shaded leaves  (mW m^-2 Î¼m^-1 sr^-1))\nSIF_obs_scattered\nObserver-direction outgoing SIF radiance, scattered   (mW m^-2 Î¼m^-1 sr^-1))\nSIF_obs_soil\nObserver-direction outgoing SIF radiance, soil-reflected  (mW m^-2 Î¼m^-1 sr^-1))\nSIF_sum\nTotal SIF sum of layer sources  (mW m^-2 Î¼m^-1))\n\n\n\n\n\n","category":"type"},{"location":"#Canopy-Optical-Property-Structure-1","page":"Home","title":"Canopy Optical Property Structure","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"Land.CanopyRT.struct_canopyOptProps","category":"page"},{"location":"#Land.CanopyRT.struct_canopyOptProps","page":"Home","title":"Land.CanopyRT.struct_canopyOptProps","text":"struct_canopyRadiation\n\nFields\n\nsdb\nSolar -> Diffuse backscatter weight\nsdf\nSolar -> Diffuse forward scatter weight\ndob\nDiffuse -> Directional backscatter weight\ndof\nDiffuse -> Directional forward scatter weight\nddb\nDiffuse -> Diffuse backscatter weight\nddf\nDiffuse -> Diffuse forward scatter weight\nks\nSolar beam extinction coefficient weight\nko\nOutgoing beam extinction coefficient weight\nbf\n\nsob\nweight of specular2directional backscatter coefficient\nsof\nweight of specular2directional forward coefficient\nfs\nconversion factor fs to compute irradiance on inclined leaf\nabsfs\nabs(fs)\nabsfsfo\nabs(fs*fo)\nfsfo\nfs*fo\nfo\nconversion factor fo for angle towards observer (not sun like fs)\ncosÎ_l\nCosine of leaf azimuths\ncos2Î_l\ncos of leaf azimuth sqared\nPs\nProbability of directly viewing a leaf in solar direction\nPo\nProbability of directly viewing a leaf in viewing direction\nPso\nBi-directional probability of directly viewing a leaf (solar->canopy->viewing)\nsigb\ndiffuse     backscatter scattering coefficient for diffuse  incidence\nsigf\ndiffuse     forward     scattering coefficient for diffuse  incidence\nsb\ndiffuse     backscatter scattering coefficient for specular incidence\nsf\ndiffuse     forward     scattering coefficient for specular incidence\nvb\ndirectional backscatter scattering coefficient for diffuse  incidence\nvf\ndirectional forward     scattering coefficient for diffuse  incidence\nw\nbidirectional scattering coefficent (directional-directional)\na\nattenuation\nXsd\nEffective layer transmittance (direct->diffuse)\nXdd\nEffective layer transmittance (diffuse->diffuse)\nR_sd\nEffective layer reflectance (direct->diffuse)\nR_dd\nEffective layer reflectance (diffuse->diffuse)\nEs_\nSolar direct radiation per layer)\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis-module-1","page":"Home","title":"Photosynthesis module","text":"","category":"section"},{"location":"#Leaf-Params:-1","page":"Home","title":"Leaf Params:","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"Land.Photosynthesis.leaf_params","category":"page"},{"location":"#Land.Photosynthesis.leaf_params","page":"Home","title":"Land.Photosynthesis.leaf_params","text":"leaf_params\nStructure with all parameter temperature dependencies of a Leaf (largely based on Bonan's Photosynthesis model but exported as struct)\n\nFields\n\nÎ±\nÎµ\nLMA\nDRY leaf mass area\nRWC\nleaf relative water content\nCleaf\nleaf specific heat (J/kg/K)\nChloroplast_rel_volume\nPSII_frac\nFraction of  absorbed light used by PSII ETR\nKf\nRate constant for fluorescence (const)\nKd\nRate constant for thermal dissipation\nKp\nRate constant for photochemistry (all reaction centers open)\nKn\nNPQ rate constant\nKn_ss\nmaxPSII\nmax PSII yield\nFo\ndark-adapted fluorescence yield Fo\nFoâ²\nlight-adapted fluorescence yield in the dark Fo'\nFm\ndark adapted Fm yield\nFmâ²\nlight adapted Fm' yield\nÏs\nsteady-state (light-adapted) yield Ft (aka Fs)\nÏ\nPSII yield\nqQ\nPhotochemical quenching\nqE\nNPQ\nNon-Photochemical quenching\ndynamic_state\nDynamic Steady state boolean\neffcon\nCO2_per_electron\nJa\nActual electron transport rate (Î¼mol m-2 s-1)\nC3\nC3 or C4 plant boolean\nuse_colim\ngstyp\noâ\nO2 (mol/mol)\nT\nLeaf temperature (K)\nT_old\nOld Leaf temperature (K)\nesat\ndesat\nÎ¸_j\nvpd_min\ngleaf\ntotal leaf conductance (Î¼mol/m2/s)\ngm\nMesophyll conductance (Î¼mol/m2/s/)\ngs\nStomatal conductance (Î¼mol/m2/s)\ngs_ss\nSteady state Stomatal conductance (Î¼mol/m2/s)\nppm_to_Pa\nppm to Pa conversion\nAg\nAn\nAi\nAc\nAj\nAp\nH\nLE\nRn\nSap\nAPAR\nAPAR\nKc\nMichaelis-Menten constant for COâ (Pa)\nKo\nMichaelis-Menten constant for Oâ (Pa)\nKpep\nMichaelis-Menten constant for PEP carboxylase (Pa)\nÎstar\nCOâ compensation point (Pa)\nVcmax25\nLeaf maximum carboxylation rate at 25C (Î¼mol/m2/s)\nVpmax25\nLeaf maximum PEP carboxylation rate at 25C (Î¼mol/m2/s)\nJmax25\nMaximum electron transport rate at 25C (Î¼mol/m2/s)\nRd25\nLeaf respiration rate at 25C (Î¼mol CO2/m2/s)\nVcmax\nActual Leaf maximum carboxylation rate (Î¼mol/m2/s)\nVpmax\nActual Leaf maximum PEP carboxylase rate (Î¼mol/m2/s)\nJmax\nActual Maximum electron transport rate (Î¼mol/m2/s)\nRd\nActual Leaf respiration rate (Î¼mol CO2/m2/s)\nCs\nCO2 concentration at leaf surface (ppm)\nCc\nCO2 concentration in chloroplast (ppm)\nCc_Pa\nCO2 concentration in chloroplast (Pa)\nRH\nrelative humidity at the surface of the leaf\nVPD\nVapor pressure difference across leaf interface (kPa)\nJe\nElectron transport rate (Î¼mol m-2 s-1), light limited only\nJe_pot\nPotential ETR\nheight\nz0m\nz0h\nd\ndleaf\nLAI\nCd\npsi_l\npsi_l50\nkmax\nkx\nkleaf\nck\nCtree\n\n\n\n\n\n","category":"type"},{"location":"#Plant-module-1","page":"Home","title":"Plant module","text":"","category":"section"},{"location":"#Plant-structure-1","page":"Home","title":"Plant structure","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"Land.Plant.Tree\nLand.Plant.Root\nLand.Plant.RootLayer\nLand.Plant.Stem\nLand.Plant.Branch\nLand.Plant.Canopy\nLand.Plant.CanopyLayer\nLand.Plant.Leaf","category":"page"},{"location":"#Land.Plant.Tree","page":"Home","title":"Land.Plant.Tree","text":"Tree{FT<:AbstractFloat}\n\nA Tree type which, by default, includes\n\n5 root layers\na trunk\n20 branches\n20 canopy layers\n\nFields\n\nage\nAge [year]\nba\nBasal area [mÂ²]\nga\nGround area [mÂ²]\nh\nTree height [m]\nroots\nRoot which contains 5 RootLayer by default\ntrunk\nTrunk using type Stem\nbranch\nBranch which contains 20 Stem by default\ncanopy\nCanopy which contains 20 CanopyLayer by default\n\n\n\n\n\n","category":"type"},{"location":"#Land.Plant.Root","page":"Home","title":"Land.Plant.Root","text":"Root{FT<:AbstractFloat,n}\n\nA Root Struct which contains, by default, 5 even RootLayer.\n\nFields\n\nroot_frac\nList of root fraction\nroot_zs\nList of root z lower boundary\nroot_list\nList of RootLayer\n\n\n\n\n\n","category":"type"},{"location":"#Land.Plant.RootLayer","page":"Home","title":"Land.Plant.RootLayer","text":"RootLayer{FT<:AbstractFloat}\n\nA RootLayer type which contains root hydraulics information, including rhizosphere conductance.\n\nFields\n\nz_hi\nUpper root depth [m]\nz_lo\nLower root depth [m]\nr_layer\nAverage horizental root length [m]\nf_layer\nFraction of biomass and k_max\nb\nWeibull function (k = k_max * exp( -(-p/B)^C )) parameter B [MPa]\nc\nWeibull function (k = k_max * exp( -(-p/B)^C )) parameter C\nk_max\nMaximal hydraulic conductance, default at 2700.0 Kg hâ»Â¹ MPaâ»Â¹ mâ»Â² basal area [mol sâ»Â¹ MPaâ»Â¹]\nk_s\nMaximal hydraulic conductivity per cross section basal area per root depth [mol sâ»Â¹ MPaâ»Â¹ mâ»Â²]\nk_rhiz\nMaximal rhizosphere conductance, default at 9.72e12 Kg hâ»Â¹ MPaâ»Â¹ mmâ»Â² basal area [mol sâ»Â¹ MPaâ»Â¹]\np_ups\nSoil water potential (upstream) [MPa]\nsoil_a\nSoil texture parameter\nsoil_m\nSoil texture parameter, 1 - 1/n\nsoil_n\nSoil texture parameter\nsoil_msc\nMaximal soil volumatric water content, vary with rock fraction\nsoil_rwc\nRelative soil volumatric water content\nsoil_vwc\nSoil volumatric water content\nt_soil\nSoil temperature [K]\nsoil_type\nSoil texture\np_rhiz\nWater potential at the root-rhizosphere interface [MPa]\np_dos\nXylem water pressure at the tree base (downstream) [MPa]\nq\nFlow rate in the root layer [mol sâ»Â¹]\nk_element\nList of k_max per element [mol sâ»Â¹ MPaâ»Â¹]\np_element\nList of xylem water pressure per element [MPa]\np_history\nList of xylem water pressure history (normalized to 298.15 K) per element [MPa]\nt_element\nList of water temperature per element [K]\nz_element\nList of height per element to account for gravity [m]\n\n\n\n\n\n","category":"type"},{"location":"#Land.Plant.Stem","page":"Home","title":"Land.Plant.Stem","text":"Stem{FT<:AbstractFloat}\n\nA Stem type which contains hydraulic information, including drought history profile. The Stem type is used for creating a trunk and a list of branches.\n\nFields\n\nr_layer\nHorizental radius of the layer [m]\nz_hi\nUpper height from the ground (trunk-branch joint for trunk, stem-leaf joint for branch) [m]\nz_lo\nLower height from the ground (0 for trunk, trunk-branch joint for branch) [m]\nb\nWeibull function (k = k_max * exp( -(-p/B)^C )) parameter B [MPa]\nc\nWeibull function (k = k_max * exp( -(-p/B)^C )) parameter C\nk_max\nMaximal hydraulic conductance, = 5400.0 * 8/3 Kg hâ»Â¹ MPaâ»Â¹ mâ»Â² basal area [mol sâ»Â¹ MPaâ»Â¹]\nk_s\nMaximal hydraulic conductivity per cross section area per tree height [mol sâ»Â¹ MPaâ»Â¹ mâ»Â²]\np_ups\nXylem water pressure at the tree basa (upstream) [MPa]\np_dos\nXylem water pressure at the trunk-stem or stem-leaf joint (downstream) [MPa]\nq\nFlow rate in the xylem [mol sâ»Â¹]\nk_element\nList of stem k_max per element [mol sâ»Â¹ MPaâ»Â¹]\np_element\nList of stem xylem pressure per element [MPa]\np_history\nList of stem xylem pressure history (normalized to 298.15 K) per element [MPa]\nt_element\nList of stem temperature for each element [K]\nz_element\nList of stem height per element to account for gravity [m]\n\n\n\n\n\n","category":"type"},{"location":"#Land.Plant.Branch","page":"Home","title":"Land.Plant.Branch","text":"Branch{FT<:AbstractFloat, n}\n\nA Branch type which constains n Stem in response to n CanopyLayer\n\nFields\n\nbranch_list\nList of Stem\n\n\n\n\n\n","category":"type"},{"location":"#Land.Plant.Canopy","page":"Home","title":"Land.Plant.Canopy","text":"Canopy{FT<:AbstractFloat,n, n_total}\n\nA Canopy type which contains n CanopyLayer.\n\nFields\n\nn_layer\nCanopy layer number\ncanopy_list\nList of CanopyLayer\n\n\n\n\n\n","category":"type"},{"location":"#Land.Plant.CanopyLayer","page":"Home","title":"Land.Plant.CanopyLayer","text":"CanopyLayer{FT<:AbstractFloat, n_total}\n\nA CanopyLayer type, which constains environemntal conditions and leaf-level fluxes for n_total Leaf. The n_total is the sum of n_Ari * n_Incli sunlit leaves and 1 shaded leaves.\n\nFields\n\nf_layer\nLeaf area fraction in the canopy\nf_view\nFraction of the sunlit leaves\nla\nLeaf area in the layer [mÂ²]\nwidth\nLeaf width [m]\np_a\nAtmospheric COâ partial pressure in the layer [Pa]\np_atm\nAtmospheric pressure [Pa]\np_Oâ\nAtmospheric Oâ partial presssure [Pa]\np_HâO\nAtmospheric HâO partial pressure [Pa]\nt_air\nAir temperature [K]\nwind\nWind speed [m sâ»Â¹]\ng_ias_c\nMesophyll conductance correction factor: multiplier\ng_ias_e\nMesophyll conductance correction factor: exponent\ng_max\nMaximal leaf diffusive conductance for HâO at 298.15 K [mol mâ»Â² sâ»Â¹]\nÎ_star\nCOâ compensation point with the absence of dark respiration [Pa]\ngs_nssf\nNon-steady state factor (use it by multiplying the âA/âE - âÎ/âE)\nj_max\nMaximal electron transport rate at 298.15 K [Î¼mol mâ»Â² sâ»Â¹]\nr_25\nLeaf respiration rate at 298.15 K [Î¼mol mâ»Â² sâ»Â¹]\nv_max\nMaximal carboxylation rate at 298.15 K [Î¼mol mâ»Â² sâ»Â¹]\nleaf_list\nList of Leaf\nag_list\nList of gross photosynthetic rate for n_total leaves [Î¼mol mâ»Â² sâ»Â¹]\nan_list\nList of net photosynthetic rate [Î¼mol mâ»Â² sâ»Â¹]\nd_list\nList of leaf-to-air vapor pressure deficit [unitless]\ne_list\nList of flow rate per leaf area [mol mâ»Â² sâ»Â¹]\nec_list\nList of critical flow rate (when leaf xylem pressure induces desiccation) per leaf area [mol mâ»Â² sâ»Â¹]\ngsc_list\nList of effective leaf diffusive conductance for COâ [mol mâ»Â² sâ»Â¹]\ngsw_list\nList of leaf diffusive conductance for HâO [mol mâ»Â² sâ»Â¹]\nla_list\nList of leaf area per leaf [mÂ²]\npar_list\nList of PAR for each leaf\npi_list\nList of leaf internal COâ partial pressure [Pa]\nq_list\nList of flow rate [mol sâ»Â¹]\nr_list\nList of leaf respiration rate [Î¼mol mâ»Â² sâ»Â¹]\nt_list\nList of leaf temperature [K]\n\n\n\n\n\n","category":"type"},{"location":"#Land.Plant.Leaf","page":"Home","title":"Land.Plant.Leaf","text":"Leaf{FT<:AbstractFloat}\n\nA Leaf type which contains leaf hydraulics information.\n\nFields\n\nangle_locat\ndirection from the tree trunk to the leaf, 0 for east, 270 for south, and 180 for west [Â°]\nangle_incli\ndirection of leave, 0 for flat and 90 for vertical [Â°]\nb\nWeibull function (k = k_max * exp( -(-p/B)^C )) parameter B [MPa]\nc\nWeibull function (k = k_max * exp( -(-p/B)^C )) parameter C\nk_sla\nMaximal leaf hydraulic conductance per leaf area [mol sâ»Â¹ MPaâ»Â¹ mâ»Â²]\np_ups\nLeaf xylem water pressure (different from leaf water potential) at the leaf base (upstream) [MPa]\np_dos\nLeaf xylem water pressure at the downstream end of leaf xylem [MPa]\nk_element\nList of leaf k_max per element (mol sâ»Â¹ MPaâ»Â¹)\np_element\nList of xylem water pressure per element [MPa]\np_history\nList of xylem water pressure history (normalized to 298.15 K) per element [MPa]\nt_element\nList of xylem water temperature per element [K]\nz_element\nList of leaf element height change to account for gravity, default = 0 [m]\n\n\n\n\n\n","category":"type"},{"location":"#Plant-hydraulics-1","page":"Home","title":"Plant hydraulics","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"Land.Plant.get_struct_p_end_from_q\nLand.Plant.get_q_layer_from_p_base\nLand.Plant.get_p_base_q_list_from_q\nLand.Plant.update_struct_from_q!\nLand.Plant.update_tree_e_crit!","category":"page"},{"location":"#Land.Plant.get_struct_p_end_from_q","page":"Home","title":"Land.Plant.get_struct_p_end_from_q","text":"get_struct_from_q(root_layer, flow; p_ini)\n\nEnd pressure p_end (in MPa) for RootLayer, including impacts from rhizosphere conductance and gravity, given\n\nroot_layer One RootLayer in Root in Tree\nflow Flow rate (in mol sâ»Â¹) in the given RootLayer\np_ini Upstream soil water potential if p_ini is given, otherwise (Inf) root_layer.p_ups will be used\n\n\n\n\n\nget_struct_from_q(stem, flow; p_ini)\n\nEnd pressure p_end (in MPa) for stem Stem, including impact from gravity, given\n\nstem Stem as Trunk in Tree or Stem as side branch in Branch in Tree\nflow Flow rate (in mol sâ»Â¹) in the given Stem\np_ini Upstream xylem pressure if p_ini is given, otherwise (Inf) stem.p_ups will be used\n\n\n\n\n\nget_struct_from_q(leaf, flow; p_ini)\n\nEnd pressure p_end (in MPa) for leaf leaf, including impact from gravity, given\n\nleaf Leaf in CanopyLayer in Canopy in Tree\nflow Flow rate per leaf area (mol mâ»Â² sâ»Â¹) in the given Leaf\np_ini Upstream xylem pressure if p_ini is given, otherwise (Inf) leaf.p_ups will be used\n\n\n\n\n\n","category":"function"},{"location":"#Land.Plant.get_q_layer_from_p_base","page":"Home","title":"Land.Plant.get_q_layer_from_p_base","text":"get_q_layer_from_p_base(root_layer, p_base)\n\nFlow rate in a root layer q_layer, given\n\nroot_layer One RootLayer in Root in Tree\np_base Xylem water pressure at the tree base\n\nThis function use Newton Raphson combined with Bi-section to get q_layer. A warning message will display if total iterations exceed 50 times.\n\n\n\n\n\n","category":"function"},{"location":"#Land.Plant.get_p_base_q_list_from_q","page":"Home","title":"Land.Plant.get_p_base_q_list_from_q","text":"get_p_base_q_list_from_q(tree, flow)\n\nTree base pressyre p_base and a list of flow rate in each root layer q_list, given\n\ntree A Tree type\nflow Flow rate for the whole tree [mol sâ»Â¹]\n\nThis function returns the p_base from total transpiration rate using Newton Raphson. A warning will display if total iterations is beyond 50 times.\n\n\n\n\n\n","category":"function"},{"location":"#Land.Plant.update_struct_from_q!","page":"Home","title":"Land.Plant.update_struct_from_q!","text":"update_struct_from_q!(root_layer, flow; p_ini)\n\nUpdate root hydraulic information considering the impact from rhizosphere conductance and gravity, given\n\nroot_layer One RootLayer in Root in Tree\nflow Flow rate in the given root layer\np_ini Upstream soil water potential if p_ini is given, otherwise (Inf) root_layer.p_ups will be used\n\n\n\n\n\nupdate_struct_from_q!(stem, flow; p_ini)\n\nUpdate the stem hydraulic information considering the impact from gravity, given\n\nstem Stem as trunk in a Tree or as side branch in Branch in Tree\nflow::FT Flow rate in the given stem\np_ini::FT Upstream xylem pressure if p_ini is given, otherwise (Inf) stem.p_ups will be used\n\n\n\n\n\nupdate_struct_from_q!(leaf, flow; p_ini)\n\nUpdate the leaf hydraulic information considering the impact from gravity, given\n\nleaf Leaf type in CanopyLayer in a Tree\nflow Flow rate per leaf area in the given leaf\np_ini Upstream xylem pressure if p_ini is given, otherwise (Inf) leaf.p_ups will be used\n\n\n\n\n\n","category":"function"},{"location":"#Land.Plant.update_tree_e_crit!","page":"Home","title":"Land.Plant.update_tree_e_crit!","text":"update_tree_e_crit!(tree; displaying)\n\nUpdate the critical transpiration rate information, given\n\ntree A Tree type\ndisplaying If true, messages of how e_crit evolves step-by-step will display\n\nThis function update e_crit for each layer (sunlit and shaded). The e_crit for each leaf is either increased or decreased so that p_leaf is in the range -Inf to -20.0 MPa. The e_crit increases by 1e-6 mol mâ»Â² sâ»Â¹ if p_leaf is less negative than -20 MPa. The e_crit decreases by 1e-7 mol mâ»Â² sâ»Â¹ if p_leaf is -Inf.\n\n\n\n\n\n","category":"function"},{"location":"#Stoma-dynamics-1","page":"Home","title":"Stoma dynamics","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"Land.Plant.get_marginal_gain\nLand.Plant.get_marginal_penalty_wang\nLand.Plant.update_tree_with_time!","category":"page"},{"location":"#Land.Plant.get_marginal_gain","page":"Home","title":"Land.Plant.get_marginal_gain","text":"get_marginal_gain(canopyi, indx)\n\nMarginal water use efficiency âA/âE for a leaf in a canopy layer, given\n\ncanopyi A CanopyLayer in Canopy in a Tree\nindx indx'th Leaf in the canopyi.leaf_list\n\n\n\n\n\nget_marginal_gain(canopyi, indx)\n\nA list of marginal water use efficiency for all the leaves, given\n\ncanopyi A CanopyLayer in Canopy in a Tree\n\n\n\n\n\n","category":"function"},{"location":"#Land.Plant.get_marginal_penalty_wang","page":"Home","title":"Land.Plant.get_marginal_penalty_wang","text":"get_marginal_penalty_wang(canopyi, indx)\n\nMarginal water penalty (âÎ/âE) for opening the stomata for a leaf in canopy layer, given\n\ncanopyi A CanopyLayer in Canopy in a Tree\nindx indx'th Leaf in the canopyi.leaf_list\n\nThis function uses the Wang 2020 model. âÎ/âE = A / (e_crit - e_leaf), unit [mol molâ»Â¹]. Should be updated to Abstract Type once more models are added\n\n\n\n\n\nget_marginal_penalty_wang(canopyi, indx)\n\nList of marginal water penalty for all the leaves, given\n\ncanopyi A CanopyLayer in Canopy in a Tree\n\nThis function uses the Wang 2020 model. âÎ/âE = A / (e_crit - e_leaf), unit [mol molâ»Â¹]. Should be updated to Abstract Type once more models are added\n\n\n\n\n\n","category":"function"},{"location":"#Land.Plant.update_tree_with_time!","page":"Home","title":"Land.Plant.update_tree_with_time!","text":"update_tree_with_time!(tree, Ît; scheme=\"Wang2020\", updating=false)\n\nUpdate the tree flux information and hydraulic parameters, given\n\ntree One Tree type\nÎt Ît\nscheme Optimization model option, default is \"Wang2020\nupdating If true, plant hydraulic parameters will be updated for the Tree\n\nThe function updates the stomatal conductance via a Îgsw = factor * (âA/âE - âÎ/âE). The âA/âE is the same for every stomatal control model, but âÎ/âE differs among models.\n\n\n\n\n\n","category":"function"},{"location":"#Interfaces-1","page":"Home","title":"Interfaces","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"Land.Plant.update_canopy_from_rt_module!","category":"page"},{"location":"#Land.Plant.update_canopy_from_rt_module!","page":"Home","title":"Land.Plant.update_canopy_from_rt_module!","text":"update_canopy_from_rt_module!(tree)\n\nUpdates canopy information from the RT module, given\n\ntree A Tree type\n\nThis interface function is pending...\n\n\n\n\n\n","category":"function"}]
}
