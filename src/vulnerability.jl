#######################################################################################################################################################################################################
#
# Changes to the function
# General
#     2022-Feb-01: migrate function to version v0.3
#     2022-Feb-01: add documentation
#
#######################################################################################################################################################################################################
"""
This function return the hydraulic conductance ralative to maximum at the reference temperature (25 Â°C). The supported methods are

$(METHODLIST)

"""
function xylem_k_ratio end


#######################################################################################################################################################################################################
#
# Changes to the method
# General
#     2022-Feb-01: add method for ClimaCache.LogisticVC
#     2022-Feb-01: add documentation
#
#######################################################################################################################################################################################################
"""

    xylem_k_ratio(vc::LogisticVC{FT}, p_25::FT, vis::FT = FT(1)) where {FT<:AbstractFloat}

Return the hydraulic conductance ralative to maximum at reference temperature, given
- `vc` `ClimaCache.LogisticVC` type vulnerability curve
- `p_25` Equivalent xylem water pressure at 298.15 K in `[MPa]` (surface tension correction made)
- `vis` Relative viscosity (viscosity correction to make), default is 1

---
# Examples
```julia
vc = LogisticVC{Float64}(2, 2);
k1 = xylem_k_ratio(vc, -2.0);
k2 = xylem_k_ratio(vc, -2.0, 0.95);
```
"""
xylem_k_ratio(vc::LogisticVC{FT}, p_25::FT, vis::FT = FT(1)) where {FT<:AbstractFloat} = (
    if p_25 >= 0
        return 1 / vis
    end;

    @unpack A, B = vc;

    return max( eps(FT), (1 - 1/(1 + A * exp(B * p_25))) * (A+1)/A ) / vis
);
