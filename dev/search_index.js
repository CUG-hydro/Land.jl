var documenterSearchIndex = {"docs":
[{"location":"tips/#Git-and-Julia-Tips-for-CliMA.Land","page":"Tips","title":"Git and Julia Tips for CliMA.Land","text":"","category":"section"},{"location":"tips/#Instantiate-the-project","page":"Tips","title":"Instantiate the project","text":"","category":"section"},{"location":"tips/","page":"Tips","title":"Tips","text":"The Land project\ncd .../Land to the home directory of the project\njulia --project\nusing Pkg\nPkg.instantiate()\nDelete the file Manifest.toml when encountering errors\nRedo Pkg.instantiate()\nThe docs/ project\ncd .../Land/docs\njulia --project\nusing Pkg\nPkg.instantiate()\nDelete the file Manifest.toml when encountering erros\nDelete the line Land=\"*\" in the Project.toml\nType ] in the julia REPL to enter the pkg environment\ndev .. or add .. to add the Land project\nRedo Pkg.instantiate()","category":"page"},{"location":"tips/#Run-local-tests-before-merging-into-main","page":"Tips","title":"Run local tests before merging into main","text":"","category":"section"},{"location":"tips/","page":"Tips","title":"Tips","text":"Optional: load the Land project\ncd .../Land to the home directory of the project\njulia --project\nusing Land to make sure the project can be loaded\nOptional: disable the tutorial to save some time\nchange generate_tutorials = true to generate_tutorials = false in file docs/list_of_tutorials.jl\nchange the line back to generate_tutorials = true before commiting the changes\nOptional: initialize the project\ncd .../Land to the home directory of the project\njulia --project -e \"using Pkg; Pkg.instantiate(); Pkg.build(); Pkg.precompile();\"\njulia --project=docs/ -e \"using Pkg; Pkg.instantiate(); Pkg.build(); Pkg.precompile();\"\nTest the documentation project\njulia --project=docs/ docs/make.jl\nFix errors and warnings associated with Land project\nTest the Land project\njulia --project -e \"using Pkg; Pkg.test();\"\nResolve failed tests","category":"page"},{"location":"tips/#Rebase-the-commits-before-merging-into-main","page":"Tips","title":"Rebase the commits before merging into main","text":"","category":"section"},{"location":"tips/","page":"Tips","title":"Tips","text":"Switch to the feature branch and make sure you have a clean workspace\ngit checkout FeatureBranch\ngit status to confirm zero uncommitted changes\nBackup current branch to avoid unexpected errors\ngit checkout -b FeatureBranch_Backup\nSync the main branch\ngit checkout main\ngit pull\nSwitch to the feature branch and merge main into it\ngit checkout FeatureBranch\ngit status to confirm zero uncommitted changes\ngit merge main\nResolve conflicts and commit them if any\nReabse the feature branch\ngit reset origin/main to rewrite history\ngit diff (optional) would show all the changes\ngit add --all to add local changes on top of main\ngit commit -m \"Single commit message\"\ngit push -f to force push because of the re-written history\nCreate a Pull Request\nThrough the web\nRemove local unnecessary branch (e.g., FeatureBranch_backup)\ngit branch -d FeatureBranch_Backup\ngit branch -D FeatureBranch_Backup to force remove","category":"page"},{"location":"StomataModels/#StomtaModels-API","page":"StomataModels","title":"StomtaModels API","text":"","category":"section"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"CurrentModule = Land.StomataModels","category":"page"},{"location":"StomataModels/#Stomatal-model-schemes","page":"StomataModels","title":"Stomatal model schemes","text":"","category":"section"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"The StomataModels module relies mainly on Photosynthesis and PlantHydraulics     modules to predict stomatal behavior from plant physiology. This module has     both empirical and optimal stomatal models. These stomatal models are     abstractized to an abstract AbstractStomatalModel, which further     has subtypes EmpiricalStomatalModel and     OptimizationStomatalModel.","category":"page"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"AbstractStomatalModel\nEmpiricalStomatalModel\nOptimizationStomatalModel","category":"page"},{"location":"StomataModels/#Land.StomataModels.AbstractStomatalModel","page":"StomataModels","title":"Land.StomataModels.AbstractStomatalModel","text":"type AbstractStomatalModel\n\nHierarchy of the AbstractStomatalModel:\n\nEmpiricalStomatalModel\nOptimizationStomatalModel\n\n\n\n\n\n","category":"type"},{"location":"StomataModels/#Land.StomataModels.EmpiricalStomatalModel","page":"StomataModels","title":"Land.StomataModels.EmpiricalStomatalModel","text":"type EmpiricalStomatalModel\n\nHierarchy of the EmpiricalStomatalModel:\n\nESMBallBerry\nESMGentine\nESMLeuning\nESMMedlyn\n\n\n\n\n\n","category":"type"},{"location":"StomataModels/#Land.StomataModels.OptimizationStomatalModel","page":"StomataModels","title":"Land.StomataModels.OptimizationStomatalModel","text":"type OptimizationStomatalModel\n\nHierarchy of the OptimizationStomatalModel:\n\nOSMEller\nOSMSperry\nOSMWang\nOSMWAP\nOSMWAPMod\n\n\n\n\n\n","category":"type"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"Currently, the StomataModels module has four empirical model schemes, and they     are","category":"page"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"ESMBallBerry\nESMGentine\nESMLeuning\nESMMedlyn","category":"page"},{"location":"StomataModels/#Land.StomataModels.ESMBallBerry","page":"StomataModels","title":"Land.StomataModels.ESMBallBerry","text":"struct ESMBallBerry{FT}\n\nAn empirical model parameter set type for Ball-Berry type model. The equation used for Ball-Berry type model is\n\ngs = g0 + g1  RH  dfracACs\n\nFields\n\ng0\nminimal stomatal conductance g0 [mol m⁻² s⁻¹]\ng1\nslope of conductance-photosynthesis correlation [unitless]\n\n\n\n\n\n","category":"type"},{"location":"StomataModels/#Land.StomataModels.ESMGentine","page":"StomataModels","title":"Land.StomataModels.ESMGentine","text":"struct ESMGentine{FT}\n\nAn empirical model parameter set type for Gentine type model. The equation used for Gentine type model is\n\ngs = g0 + g1  dfrack_leafk_max  dfracACa\n\nNote it that the Gentine model does not require for a β function to tune the     soil drought response, but the use of k_leaf also does not permit     post-drought stomatal response unless k_leaf can be recovered.\n\nFields\n\ng0\nminimal stomatal conductance g0 [mol m⁻² s⁻¹]\ng1\nslope of conductance-photosynthesis correlation [unitless]\n\n\n\n\n\n","category":"type"},{"location":"StomataModels/#Land.StomataModels.ESMLeuning","page":"StomataModels","title":"Land.StomataModels.ESMLeuning","text":"struct ESMLeuning{FT}\n\nAn empirical model parameter set type for Leuning type model. The equation used for Leuning type model is\n\ngs = g0 + g1  dfracACs - Γ^*  dfrac11 + dfracVPDd0\n\nFields\n\ng0\nminimal stomatal conductance g0 [mol m⁻² s⁻¹]\ng1\nslope of conductance-photosynthesis correlation [unitless]\nd0\nfitting parameter of d/d0 below the fraction, same unit as vpd [Pa]\n\n\n\n\n\n","category":"type"},{"location":"StomataModels/#Land.StomataModels.ESMMedlyn","page":"StomataModels","title":"Land.StomataModels.ESMMedlyn","text":"struct ESMMedlyn{FT}\n\nAn empirical model parameter set type for Medlyn type model. The equation used in Medlyn type model is\n\ngs = g0 + 16  left( 1 + dfracg1sqrtVPD right)  dfracACa\n\nFields\n\ng0\nminimal stomatal conductance g0 [mol m⁻² s⁻¹]\ng1\nslope of conductance-photosynthesis correlation [Pa⁽⁵⁾]\n\n\n\n\n\n","category":"type"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"All the empirical models rely on beta functions to make corrections over     stomatal conductance to account for the stomatal closure with drier soil.     We have the following prescribed beta function types, and they are:","category":"page"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"AbstractBetaFunction","category":"page"},{"location":"StomataModels/#Land.StomataModels.AbstractBetaFunction","page":"StomataModels","title":"Land.StomataModels.AbstractBetaFunction","text":"abstract type AbstractBetaFunction{FT}\n\nHierachy of AbstractBetaFunction:\n\nAbstractBetaG\nBetaGLinearPleaf\nBetaGLinearPsoil\nBetaGLinearSWC\nAbstractBetaV\nBetaVLinearPleaf\nBetaVLinearPsoil\nBetaVLinearSWC\n\n\n\n\n\n","category":"type"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"Some beta functions make correction over the g1 parameter as in the empitical     models, and they are:","category":"page"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"AbstractBetaG\nBetaGLinearPleaf\nBetaGLinearPsoil\nBetaGLinearSWC","category":"page"},{"location":"StomataModels/#Land.StomataModels.AbstractBetaG","page":"StomataModels","title":"Land.StomataModels.AbstractBetaG","text":"abstract type AbstractBetaG{FT}\n\nHierachy of AbstractBetaG:\n\nBetaGLinearPleaf\nBetaGLinearPsoil\nBetaGLinearSWC\n\n\n\n\n\n","category":"type"},{"location":"StomataModels/#Land.StomataModels.BetaGLinearPleaf","page":"StomataModels","title":"Land.StomataModels.BetaGLinearPleaf","text":"mutable struct BetaGLinearPleaf{FT}\n\nLinear β function for g1 based on soil water potential.\n\nFields\n\np_max\nUpper bound of Pleaf [MPa]\np_min\nLower bound of Pleaf [MPa]\n\n\n\n\n\n","category":"type"},{"location":"StomataModels/#Land.StomataModels.BetaGLinearPsoil","page":"StomataModels","title":"Land.StomataModels.BetaGLinearPsoil","text":"mutable struct BetaGLinearPsoil{FT}\n\nLinear β function for g1 based on soil water potential.\n\nFields\n\np_max\nUpper bound of Psoil [MPa]\np_min\nLower bound of Psoil [MPa]\n\n\n\n\n\n","category":"type"},{"location":"StomataModels/#Land.StomataModels.BetaGLinearSWC","page":"StomataModels","title":"Land.StomataModels.BetaGLinearSWC","text":"mutable struct BetaGLinearSWC{FT}\n\nLinear β function for g1 based on soil water content.\n\nFields\n\nswc_max\nUpper bound of SWC\nswc_min\nLower bound of SWC\n\n\n\n\n\n","category":"type"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"Some beta functions make correction over the photosynthetic capacity as in the     Photosynthesis module, and they are:","category":"page"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"AbstractBetaV\nBetaVLinearPleaf\nBetaVLinearPsoil\nBetaVLinearSWC","category":"page"},{"location":"StomataModels/#Land.StomataModels.AbstractBetaV","page":"StomataModels","title":"Land.StomataModels.AbstractBetaV","text":"abstract type AbstractBetaV{FT}\n\nHierachy of AbstractBetaV:\n\nBetaVLinearPleaf\nBetaVLinearPsoil\nBetaVLinearSWC\n\n\n\n\n\n","category":"type"},{"location":"StomataModels/#Land.StomataModels.BetaVLinearPleaf","page":"StomataModels","title":"Land.StomataModels.BetaVLinearPleaf","text":"mutable struct BetaVLinearPleaf{FT}\n\nLinear β function for g1 based on soil water potential.\n\nFields\n\np_max\nUpper bound of Pleaf [MPa]\np_min\nLower bound of Pleaf [MPa]\n\n\n\n\n\n","category":"type"},{"location":"StomataModels/#Land.StomataModels.BetaVLinearPsoil","page":"StomataModels","title":"Land.StomataModels.BetaVLinearPsoil","text":"mutable struct BetaVLinearPsoil{FT}\n\nLinear β function for Vcmax based on soil water potential.\n\nFields\n\np_max\nUpper bound of Psoil [MPa]\np_min\nLower bound of Psoil [MPa]\n\n\n\n\n\n","category":"type"},{"location":"StomataModels/#Land.StomataModels.BetaVLinearSWC","page":"StomataModels","title":"Land.StomataModels.BetaVLinearSWC","text":"mutable struct BetaVLinearSWC{FT}\n\nLinear β function for Vcmax based on soil water content.\n\nFields\n\nswc_max\nUpper bound of SWC\nswc_min\nLower bound of SWC\n\n\n\n\n\n","category":"type"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"The beta functions are generalized with","category":"page"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"β_factor","category":"page"},{"location":"StomataModels/#Land.StomataModels.β_factor","page":"StomataModels","title":"Land.StomataModels.β_factor","text":"β_factor(bt::AbstractBetaFunction{FT},\n         pl::FT,\n         ps::FT,\n         swc::FT) where {FT<:AbstractFloat}\n\nCalculate the β correction factor, given\n\nbt AbstractBetaFunction type struct\npl Leaf water potential [MPa]\nps Soil water potential [MPa]\nswc Soil water content\n\n\n\n\n\n","category":"function"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"The StomataModels module also contains five optimization model schemes:","category":"page"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"OSMEller\nOSMSperry\nOSMWang\nOSMWAP\nOSMWAPMod","category":"page"},{"location":"StomataModels/#Land.StomataModels.OSMEller","page":"StomataModels","title":"Land.StomataModels.OSMEller","text":"struct OSMEller\n\nAn optimization model parameter set type for Eller model. The equation used for Eller model is\n\ndfracΘE = -dfracKE  dfracAK\n\nwhere K is dfracEP.\n\nFields\n\n\n\n\n\n","category":"type"},{"location":"StomataModels/#Land.StomataModels.OSMSperry","page":"StomataModels","title":"Land.StomataModels.OSMSperry","text":"struct OSMSperry\n\nAn optimization model parameter set type for Sperry model. The equation used for Sperry model is\n\ndfracΘE = -dfracKE  dfracA_maxK_max\n\nwhere K is dfracEP.\n\nFields\n\n\n\n\n\n","category":"type"},{"location":"StomataModels/#Land.StomataModels.OSMWang","page":"StomataModels","title":"Land.StomataModels.OSMWang","text":"struct OSMWang\n\nAn optimization model parameter set type for Eller type model. The equation used for Wang model is\n\ndfracΘE = dfracAE_crit - E\n\nFields\n\n\n\n\n\n","category":"type"},{"location":"StomataModels/#Land.StomataModels.OSMWAP","page":"StomataModels","title":"Land.StomataModels.OSMWAP","text":"struct OSMWAP{FT}\n\nAn optimization model parameter set type for Wolf-Anderegg-Pacala type model. The equation used for Wolf-Anderegg-Pacala model is\n\ndfracΘE = dfrac2aP + bK\n\nwhere K is ∂P/∂E.\n\nFields\n\na\nQuadratic equation parameter [μmol m⁻² s⁻¹ MPa⁻²]\nb\nQuadratic equation parameter [μmol m⁻² s⁻¹ MPa⁻¹]\n\n\n\n\n\n","category":"type"},{"location":"StomataModels/#Land.StomataModels.OSMWAPMod","page":"StomataModels","title":"Land.StomataModels.OSMWAPMod","text":"struct OSMWAPMod{FT}\n\nAn optimization model parameter set type for Wolf-Anderegg-Pacala type model,     modified by adding a photosynthesis component while set b and c = 0. The equation used for modified Wolf-Anderegg-Pacala model is\n\ndfracΘE = dfracaAPK\n\nwhere P is absolute value of leaf xylem pressure.\n\nFields\n\na\nQuadratic equation parameter [mol mol⁻¹ MPa⁻¹]\n\n\n\n\n\n","category":"type"},{"location":"StomataModels/#CanopyLayer","page":"StomataModels","title":"CanopyLayer","text":"","category":"section"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"The StomataModels module is designed for multi-layer canopies, and each canopy     has multiple leaves. The stomatal behaviors are modeled per layer basis,     and the layer may contain any number of leaves starting from 1.     Photosynthesis-related information is stored in CanopyLayer     struct, but be aware that the leaves have uniform photosynthetic parameters     and temperature (conductances are different in response to light     environment).","category":"page"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"CanopyLayer","category":"page"},{"location":"StomataModels/#Land.StomataModels.CanopyLayer","page":"StomataModels","title":"Land.StomataModels.CanopyLayer","text":"struct CanopyLayer{FT}\n\nStruct to store leaf information (multi-dimensional).\n\nFields\n\nps\nleaf photosynthesis system\nLA\nTotal leaf area [m²]\nLAI\nTotal leaf area index in the layer\nn_leaf\nH\nSensible Heat Flux [W m⁻²]\nLE\nLatent Heat Flux [W m⁻²]\nRn\nNet Radiation Balance [W m⁻²]\nLV\nLatent Heat of evaporation [J mol⁻¹]\nT\nTemperature [K]\nT_old\nOld temperature [K]\nwidth\nLeaf width [m]\ng_bc\nBoundary layer conductance to CO₂ [mol m⁻² s⁻¹]\ng_bh\nBoundary layer conductance to heat [mol m⁻² s⁻¹]\ng_bw\nBoundary layer conductance to H₂O [mol m⁻² s⁻¹]\ng_lc\nLeaf diffusive conductance to water CO₂ [mol m⁻² s⁻¹]\ng_lw\nLeaf diffusive conductance to water H₂O [mol m⁻² s⁻¹]\ng_m\nMesophyll conductance for CO₂ [mol m⁻² s⁻¹]\ng_sc\nStomatal conductance to water CO₂ [mol m⁻² s⁻¹]\ng_sw\nStomatal conductance to water H₂O [mol m⁻² s⁻¹]\ng_ias_c\nGias correction constant\ng_ias_e\nGias correction exponent\ng_max\nMaximal leaf diffusive conductance [mol m⁻² s⁻¹]\ng_max25\nMaximal leaf diffusive conductance at 298.15 K [mol m⁻² s⁻¹]\ng_min\nMinimal leaf diffusive conductance [mol m⁻² s⁻¹]\ng_min25\nMinimal leaf diffusive conductance at 298.15 K [mol m⁻² s⁻¹]\np_i\nLeaf internal CO₂ partial pressure [Pa]\np_s\nLeaf surface CO₂ partial pressure [Pa]\np_sat\nLeaf saturation vapor pressure [Pa]\nAc\nRubisCO limited photosynthetic rate [μmol m⁻² s⁻¹]\nAj\nLight limited photosynthetic rate [μmol m⁻² s⁻¹]\nAg\nGross photosynthetic rate [μmol m⁻² s⁻¹]\nAn\nNet photosynthetic rate [μmol m⁻² s⁻¹]\nAp\nProduct limited photosynthetic rate [μmol m⁻² s⁻¹]\nJ\nElectron transport [μmol m⁻² s⁻¹]\nJ_pot\nPotential Electron Transport Rate [μmol m⁻² s⁻¹]\nCO₂_per_electron\nTotal efficiency, incl. photorespiration [mol CO₂ mol⁻¹ e-]\nFm′\nlight adapted yield (Kp=0)\nFo′\nlight-adapted fluorescence yield in the dark (Kp=max)\nJa\nActual electron transport rate [μmol m⁻² s⁻¹]\nNPQ\nNon-Photochemical quenching\nqQ\nPhotochemical quenching\nqE\nenergy quenching\nφ\nPSII yield\nϕs\nSteady-state (light-adapted) yield (aka Fs)\nFm\ndark adapted yield (Kp=0)\nFo\ndark-adapted fluorescence yield (Kp=max)\nAPAR\nAbsorbed photosynthetic active radiation [μmol m⁻² s⁻¹]\nLAIx\nLeaf area fractions\na_max\nMaximal photosynthetic rate [μmol m⁻² s⁻¹]\ne\nFlow rate [mol m⁻² s⁻¹]\nec\nCritical flow rate [mol m⁻² s⁻¹]\nkr_max\nMaximal hydraulic conductance ratio\np_ups\nBase xylem pressre [MPa]\np_old\nBase xylem pressre memory [MPa]\n\n\n\n\n\n","category":"type"},{"location":"StomataModels/#Stomatal-conductance","page":"StomataModels","title":"Stomatal conductance","text":"","category":"section"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"For empirical stomatal models, the stomatal conductance is computed as the     intercept of two functions: an empirical function that describe stomatal     responses to the physiological and environmental cues and an function that     follows the diffusion nature of H₂O and CO₂. The abstractized function for     the empirical correlation is","category":"page"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"empirical_gsw_from_model","category":"page"},{"location":"StomataModels/#Land.StomataModels.empirical_gsw_from_model","page":"StomataModels","title":"Land.StomataModels.empirical_gsw_from_model","text":"empirical_gsw_from_model(model::EmpiricalStomatalModel{FT}, leaf::Leaf{FT}, envir::AirLayer{FT}, β::FT) where {FT<:AbstractFloat}\nempirical_gsw_from_model(model::EmpiricalStomatalModel{FT}, canopyi::CanopyLayer{FT}, envir::AirLayer{FT}, β::FT) where {FT<:AbstractFloat}\nempirical_gsw_from_model(model::EmpiricalStomatalModel{FT}, canopyi::CanopyLayer{FT}, envir::AirLayer{FT}, β::FT, ind::Int) where {FT<:AbstractFloat}\n\nSteady state gsw from empirical approach given\n\nmodel EmpiricalStomatalModel type empirical model parameter set\nleaf [Leaf] type struct\ncanopyi CanopyLayer type struct\nenvir [AirLayer] type struct\nβ Correction factor over the g1 part of an empirical model\nind Nth leaf in the canopy layer\n\n\n\n\n\n","category":"function"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"For optimization stomatal models, the stomatal conductance is computed as the     point where the marginal carbon gains equals the marginal carbon risk. The     marginal carbon gain and risk are generally numerically computed by     marginally increasing transpiration rate.","category":"page"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"This module uses ConstrainedRootSolver module to iterate through the two     functions to find the solution. The aim is to find the stomatal conductance     when the envir_diff! function equals 0. The envir_diff!     returns the diference between real and model-predicted conductances for     empirical stomatal models, and the difference between marginal carbon gain     and risk for optimization stomatal models.","category":"page"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"envir_diff!","category":"page"},{"location":"StomataModels/#Land.StomataModels.envir_diff!","page":"StomataModels","title":"Land.StomataModels.envir_diff!","text":"envir_diff!(x::FT,\n            photo_set::AbstractPhotoModelParaSet{FT},\n            canopyi::CanopyLayer{FT},\n            hs::LeafHydraulics{FT},\n            psoil::FT,\n            swc::FT,\n            envir::AirLayer{FT},\n            sm::OptimizationStomatalModel{FT},\n            bt::AbstractBetaFunction{FT},\n            ind::Int) where {FT<:AbstractFloat}\nenvir_diff!(x::FT,\n            photo_set::AbstractPhotoModelParaSet{FT},\n            canopyi::CanopyLayer{FT},\n            hs::LeafHydraulics{FT},\n            envir::AirLayer{FT},\n            sm::AbstractStomatalModel{FT},\n            ind::Int) where {FT<:AbstractFloat}\n\nCalculate the difference to be minimized for a given\n\nx Assumed leaf diffusive conductance\nphoto_set[C3ParaSet] or [C4ParaSet] type parameter set\ncanopyiCanopyLayer type struct\nhs Leaf hydraulic system\npsoil Soil water potential [MPa]\nswc Soil water content\nenvir[AirLayer] type struct\nsm EmpiricalStomatalModel or OptimizationStomatalModel\nbt AbstractBetaFunction type struct\nind Nth leaf in the canopy layer\n\nThe former function works for Ball-Berry, Leuning, and Medlyn models, the     latter works for Gentine and all the optimization based models.\n\n\n\n\n\n","category":"function"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"In the envir_diff! function, leaf photosynthetic rates is modeled     using update_leaf_from_glc!, which calculates the gas exchange     rates from a known total leaf diffusive conductance.","category":"page"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"update_leaf_from_glc!","category":"page"},{"location":"StomataModels/#Land.StomataModels.update_leaf_from_glc!","page":"StomataModels","title":"Land.StomataModels.update_leaf_from_glc!","text":"update_leaf_from_glc!(photo_set::AbstractPhotoModelParaSet{FT}, canopyi::CanopyLayer{FT}, envir::AirLayer{FT}, ind::Int, glc::FT) where {FT<:AbstractFloat}\nupdate_leaf_from_glc!(photo_set::AbstractPhotoModelParaSet{FT}, canopyi::CanopyLayer{FT}, envir::AirLayer{FT}) where {FT<:AbstractFloat}\n\nUpdate Nth leaf photosynthesis, given\n\nphoto_set [C3ParaSet] or [C4ParaSet] type parameter set\ncanopyi CanopyLayer type struct\nenvir [AirLayer] type struct\nind Nth leaf\nglc Given leaf diffusive conductance\n\nNote that this function does not make the gsw control, so it is not guaranteed     that gsw is within the physiological range. Thus, gsw control should be     made outside this function. This function is supposed to be used in the     optimal stomatl conductance models only, because optimal conductance can be     outside the physiological stomatal conductance range. Thus, using this     function for other purposes need to be cautious. In this case, it is     recommended to use update_leaf_from_gsw!.\n\n\n\n\n\n","category":"function"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"However, these functions do not force stomatal conductance to stay in its     ranges. For example, the stomatal conductance solution is set to be zero if     light is lower than the compensation point. In this case, the     envir_diff! function has to be used along with a control function     to guarantee realistic stomatal conductance.","category":"page"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"leaf_gsw_control!","category":"page"},{"location":"StomataModels/#Land.StomataModels.leaf_gsw_control!","page":"StomataModels","title":"Land.StomataModels.leaf_gsw_control!","text":"leaf_gsw_control!(photo_set::AbstractPhotoModelParaSet{FT}, canopyi::CanopyLayer{FT}, envir::AirLayer{FT}, ind::Int) where {FT<:AbstractFloat}\nleaf_gsw_control!(photo_set::AbstractPhotoModelParaSet{FT}, canopyi::CanopyLayer{FT}, envir::AirLayer{FT}) where {FT<:AbstractFloat}\n\nmake sure g_sw is in its physiological range limited by diffusion, given\n\nphoto_set [C3ParaSet] or [C4ParaSet] type parameter set\ncanopyi CanopyLayer type struct\nenvir [AirLayer] type struct\nind Nth leaf\n\nNote that this function is meant to use jointly with updateleaffrom_glc! when     computing optimal stomtal conductance.\n\n\n\n\n\n","category":"function"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"To facilitate the use of the StomataModels module, an abstractized function is     provided for conveniently obtaining stomatal conductance from given     environmental conditions.","category":"page"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"leaf_photo_from_envir!","category":"page"},{"location":"StomataModels/#Land.StomataModels.leaf_photo_from_envir!","page":"StomataModels","title":"Land.StomataModels.leaf_photo_from_envir!","text":"leaf_photo_from_envir!(\n            photo_set::AbstractPhotoModelParaSet{FT},\n            canopyi::CanopyLayer{FT},\n            hs::LeafHydraulics{FT},\n            psoil::FT,\n            swc::FT,\n            envir::AirLayer{FT},\n            sm::EmpiricalStomatalModel{FT},\n            bt::AbstractBetaFunction{FT}) where {FT<:AbstractFloat}\nleaf_photo_from_envir!(\n            photo_set::AbstractPhotoModelParaSet{FT},\n            canopyi::CanopyLayer{FT},\n            hs::LeafHydraulics{FT},\n            psoil::FT,\n            swc::FT,\n            envir::AirLayer{FT},\n            sm::EmpiricalStomatalModel{FT},\n            bt::AbstractBetaFunction{FT},\n            ind::Int) where {FT<:AbstractFloat}\nleaf_photo_from_envir!(\n            photo_set::AbstractPhotoModelParaSet{FT},\n            canopyi::CanopyLayer{FT},\n            hs::LeafHydraulics{FT},\n            envir::AirLayer{FT},\n            sm::AbstractStomatalModel{FT}) where {FT<:AbstractFloat}\nleaf_photo_from_envir!(\n            photo_set::AbstractPhotoModelParaSet{FT},\n            canopyi::CanopyLayer{FT},\n            hs::LeafHydraulics{FT},\n            envir::AirLayer{FT},\n            sm::AbstractStomatalModel{FT},\n            ind::Int) where {FT<:AbstractFloat}\n\nCalculate steady state gsw and photosynthesis from empirical approach, given\n\nphoto_set [C3ParaSet] or [C4ParaSet] type parameter set\ncanopyi CanopyLayer type struct\nhs Leaf hydraulic system\nenvir [AirLayer] type struct\nsm EmpiricalStomatalModel or OptimizationStomatalModel\nbt AbstractBetaFunction type struct\nind Nth leaf in canopyi\n\nThe former function works for Ball-Berry, Leuning, and Medlyn models, the     latter works for Gentine and all the optimization based models.\n\n\n\n\n\n","category":"function"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"To speed up the calculations, leaf physiological parameters are updated only     if the environmental conditions changes. For example, PAR (photosyntheis     active radiation) is constant when we iterate envir_diff!, and     the electron transport is only updated once. Similar for the cases of     leaf temperature and soil moisture. This kind of functions used in the     present module are","category":"page"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"update_leaf_TP!\nupdate_leaf_AK!","category":"page"},{"location":"StomataModels/#Land.StomataModels.update_leaf_TP!","page":"StomataModels","title":"Land.StomataModels.update_leaf_TP!","text":"update_leaf_TP!(photo_set::AbstractPhotoModelParaSet{FT}, canopyi::CanopyLayer{FT}, hs::LeafHydraulics{FT}, envir::AirLayer{FT}) where {FT<:AbstractFloat}\n\nUpdate leaf physiological parameters if temperature or pressure changes in the daytime, given\n\nphoto_set [C3ParaSet] or [C4ParaSet] type parameter set\ncanopyi CanopyLayer type struct\nhs Leaf hydraulic system\nenvir [AirLayer] type struct\n\n\n\n\n\n","category":"function"},{"location":"StomataModels/#Land.StomataModels.update_leaf_AK!","page":"StomataModels","title":"Land.StomataModels.update_leaf_AK!","text":"update_leaf_AK!(\n        photo_set::AbstractPhotoModelParaSet{FT},\n        canopyi::CanopyLayer{FT},\n        hs::LeafHydraulics{FT},\n        envir::AirLayer{FT}) where {FT<:AbstractFloat}\n\nUpdate leaf maximal A and K for Sperry model, given\n\nphoto_set [C3ParaSet] or [C4ParaSet] type parameter set\ncanopyi CanopyLayer type struct\nenvir [AirLayer] type struct\n\n\n\n\n\n","category":"function"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"I'd like to emphasize it here that the leaf_photo_from_envir!     function only applies to the case of constant leaf temperature because     leaf energy budget is not calculated, and thus     leaf_photo_from_envir! is only applicable to (1) known leaf     temperature, and (2) prognostically modeling the non-steady state stomatal     behaviors. As to the steady state case, leaf energy budget has to be     considered. For the prognotic stomatal conductance, it is recommended to     use update_leaf_from_gsw! function.","category":"page"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"update_leaf_from_gsw!","category":"page"},{"location":"StomataModels/#Land.StomataModels.update_leaf_from_gsw!","page":"StomataModels","title":"Land.StomataModels.update_leaf_from_gsw!","text":"update_leaf_from_gsw!(photo_set::AbstractPhotoModelParaSet{FT}, canopyi::CanopyLayer{FT}, envir::AirLayer{FT}, ind::Int, gsw::FT) where {FT<:AbstractFloat}\nupdate_leaf_from_gsw!(photo_set::AbstractPhotoModelParaSet{FT}, canopyi::CanopyLayer{FT}, envir::AirLayer{FT}, ind::Int) where {FT<:AbstractFloat}\nupdate_leaf_from_gsw!(photo_set::AbstractPhotoModelParaSet{FT}, canopyi::CanopyLayer{FT}, envir::AirLayer{FT}) where {FT<:AbstractFloat}\n\nUpdate Nth leaf photosynthesis, given\n\nphoto_set [C3ParaSet] or [C4ParaSet] type parameter set\ncanopyi CanopyLayer type struct\nenvir [AirLayer] type struct\nind Nth leaf\ngsw Given stomatal conductance to H₂O\n\nNote that this function makes the gsw control so that gsw is within the     physiological range.\n\n\n\n\n\n","category":"function"},{"location":"StomataModels/","page":"StomataModels","title":"StomataModels","text":"Note it here that stomtal conductance is controlled in this function, and thus     no additional control like leaf_gsw_control! is required if     update_leaf_from_gsw! is used.","category":"page"},{"location":"CanopyLayers/#CanopyLayers","page":"CanopyLayers","title":"CanopyLayers","text":"","category":"section"},{"location":"CanopyLayers/","page":"CanopyLayers","title":"CanopyLayers","text":"CurrentModule = Land.CanopyLayers","category":"page"},{"location":"CanopyLayers/#Structures","page":"CanopyLayers","title":"Structures","text":"","category":"section"},{"location":"CanopyLayers/","page":"CanopyLayers","title":"CanopyLayers","text":"Canopy4RT\nCanopyOpticals\nCanopyRads\nIncomingRadiation\nLeafBios\nLeafOpticals\nRTDimensions\nSoilOpticals\nSolarAngles\nWaveLengths","category":"page"},{"location":"CanopyLayers/#Land.CanopyLayers.Canopy4RT","page":"CanopyLayers","title":"Land.CanopyLayers.Canopy4RT","text":"mutable struct Canopy4RT\n\nA canopy struct for the radiation transfer module\n\nFields\n\nnLayer\nNumber of canopy layers\nLAI\nLeaf Area Index\nΩ\nClumping factor\nclump_a\nStructure factor a\nclump_b\nStructure factor b\nleaf_width\nLeaf width\nhc\nVegetation height\nLIDFa\nLeaf Inclination\nLIDFb\nVariation in leaf inclination\nhot\nHotSpot parameter (still need to check!)\niLAI\nLAI in the ith layer\nheight\nCanopy height [m]\nz0m\nCanopy roughness [m]\nz0h\nTree roughtnes [m]\nd\nCanopy displacement height [m]\nCd\nm/sqrt(s) turbulent transfer coefficient\nlitab\nList of mean inclination angles [°]\nlitab_bnd\nList of inclination angle boundaries [°]\nlazitab\nList of mean azimuth angles [°]\ncos_ttlo\nCosine of lazitab\ncos_philo\nCosine of lazitab - psi (relative azimuth angle), update with time\ncos_ttli\nCosine of litab\nsin_ttli\nSine of litab\nvol_scatt\nContainer for volome scatter function\nlidf\nInclination angles weight distribution\nxl\nList of level location (level = layer + 1)\ndx\n1/nLayer\nnAzi\nNumber of azimuth angles\nnIncl\nNumber of inclination angles\n\n\n\n\n\n","category":"type"},{"location":"CanopyLayers/#Land.CanopyLayers.CanopyOpticals","page":"CanopyLayers","title":"Land.CanopyLayers.CanopyOpticals","text":"mutable struct CanopyOpticals{FT}\n\nA struct for canopy optical properties\n\nFields\n\nnAzi\nNumber of azimuth angles\nnIncl\nNumber of inclination agles\nnLayer\nNumber of canopy layers\nnWL\nNumber of wave lengths\nsdb\nSolar -> Diffuse backscatter weight\nsdf\nSolar -> Diffuse forward scatter weight\ndob\nDiffuse -> Directional backscatter weight\ndof\nDiffuse -> Directional forward scatter weight\nddb\nDiffuse -> Diffuse backscatter weight\nddf\nDiffuse -> Diffuse forward scatter weight\nks\nSolar beam extinction coefficient weight\nko\nOutgoing beam extinction coefficient weight\nbf\n?\nsob\nWeight of specular2directional backscatter coefficient\nsof\nWeight of specular2directional forward coefficient\nPs\nProbability of directly viewing a leaf in solar direction\nPo\nProbability of directly viewing a leaf in viewing direction\nPso\nBi-directional probability of directly viewing a leaf (solar->canopy->viewing)\nfs\nconversion factor fs to compute irradiance on inclined leaf\nabsfs\nabs(fs)\nabsfsfo\nabs(fs*fo)\nfsfo\nfs*fo\nfo\nconversion factor fo for angle towards observer (not sun like fs)\nabsfo\nabs(fo)\ncosΘ_l\nCosine of leaf azimuths\ncos2Θ_l\ncos of leaf azimuth sqared\nsigb\ndiffuse     backscatter scattering coefficient for diffuse  incidence\nsigf\ndiffuse     forward     scattering coefficient for diffuse  incidence\nsb\ndiffuse     backscatter scattering coefficient for specular incidence\nsf\ndiffuse     forward     scattering coefficient for specular incidence\nvb\ndirectional backscatter scattering coefficient for diffuse  incidence\nvf\ndirectional forward     scattering coefficient for diffuse  incidence\nw\nbidirectional scattering coefficent (directional-directional)\na\nattenuation\nXsd\nEffective layer transmittance (direct->diffuse)\nXdd\nEffective layer transmittance (diffuse->diffuse)\nR_sd\nEffective layer reflectance (direct->diffuse)\nR_dd\nEffective layer reflectance (diffuse->diffuse)\nEs_\nSolar direct radiation per layer)\n\n\n\n\n\n","category":"type"},{"location":"CanopyLayers/#Land.CanopyLayers.CanopyRads","page":"CanopyLayers","title":"Land.CanopyLayers.CanopyRads","text":"mutable struct CanopyRads{FT}\n\nA struct for canopy radiation information\n\nFields\n\nnAzi\nNumber of azimuth angles\nnIncl\nNumber of inclination agles\nnLayer\nNumber of canopy layers\nnLevel\nNumber of canopy levels\nnWL\nNumber of wave lengths\nnWLF\nNumber of wave lengths for SIF\nintEout\nIntegrated TOC outgoing flux [W m⁻²]\nincomingPAR\nIncident spectrally integrated total PAR [mol m⁻² s⁻¹]\nincomingPAR_direct\nIncident spectrally integrated direct PAR [mol m⁻² s⁻¹]\nincomingPAR_diffuse\nIncident spectrally integrated diffuse PAR [mol m⁻² s⁻¹]\nRnSoil_diffuse\nNet radiation of shaded soil [W m⁻²]\nRnSoil_direct\nNet Short-wave radiation of sunlit soil [W m⁻²]\nRnSoil\nNet Short-wave radiation of soil (shaded + sunlit) [W m⁻²]\nRnSoilLW\nNet long-wave radiation of soil (shaded + sunlit) [W m⁻²]\nabsPAR_shade\nNet PAR of shaded leaves [mol m⁻² s⁻¹]\nabsPAR_shadeCab\nNet PAR by Cab+Car of shaded leaves [moles m⁻² s⁻¹]\nintNetSW_sunlit\nSpectrally integrated net absorbed direct radiation in each layer [W m⁻²)]\nintNetSW_shade\nSpectrally integrated net absorbed diffuse radiation in each layer [W m⁻²)]\nintNetLW_sunlit\nSpectrally integrated net absorbed direct radiation in each layer [W m⁻²)]\nintNetLW_shade\nSpectrally integrated net absorbed diffuse radiation in each layer [W m⁻²)]\nT_sun\nLeaf temperature (sunlit) [K]\nT_shade\nLeaf temperature (shaded) [K]\nϕ_shade\nFluorescence yield for shaded leaves\nH_shade\nSensible Heat flux H of shaded leaves [W m⁻²]\nLE_shade\nLatent Heat flux LE of shaded leaves [W m⁻²]\nNPQ_shade\nNPQ of shaded leaves\nGPP_shade\nGPP of shaded leaves [μmol m⁻² s⁻¹]\ngs_shade\ngs of shaded leaves [mol m⁻² s⁻¹]\nψl_shade\nLeaf water potential of shaded leaves [MPa]\nCc_shade\nCc of shaded leaves [µmol/mol]\nPi_shade\ninternal CO₂ concentration of shaded leaves [µmol/mol]\nLo\nShort-wave TOC outgoing radiance in observation direction [mW m⁻² nm⁻¹ sr⁻¹]\nEout\nShort-wave TOC outgoing radiation [mW m⁻² nm⁻¹]\nalb_obs\nShort-wave Albedo in viewing direction\nalb_direct\nShort-wave Albedo for direct incoming radiation\nalb_diffuse\nShort-wave Albedo for diffuse incoming radiation\nE_up\nUpwelling diffuse short-wave radiation within canopy [mW m⁻² nm⁻¹]\nE_down\nDownwelling diffuse short-wave radiation within canopy [mW m⁻² nm⁻¹]\nnetSW_sunlit\nNet absorbed direct radiation in each layer [mW m⁻² nm⁻¹]\nnetSW_shade\nnet absorbed diffuse radiation in each layer [mW m⁻² nm⁻¹]\nabsPAR_sun\nnet PAR of sunlit leaves [mol m⁻² s⁻¹]\nabsPAR_sunCab\nnet PAR by Cab+Car of sunlit leaves [mol m⁻² s⁻¹]\nT_sun3D\nLeaf temperature (sunlit) [K]\nϕ_sun\nFluorescence yield for sunlit leaves\nH_sun\nSensible Heat flux H of sunlit leaves [W m⁻²]\nLE_sun\nLatent Heat flux LE of sunlit leaves [W m⁻²]\nNPQ_sun\nNPQ of sunlit leaves\nGPP_sun\nGPP of sunlit leaves [μmol m⁻² s⁻¹]\ngs_sun\ngs of sunlit leaves [mol m⁻² s⁻¹]\nψl_sun\nLeaf water potential of sunlit leaves [MPa]\nCc_sun\nCc of sunlit leaves [µmol/mol]\nPi_sun\nInternal CO₂ concentration of sunlit leaves [µmol/mol]\nSIF_hemi\nHemispheric total outgoing SIF flux [mW m⁻² nm⁻¹])\nSIF_obs\nObserver-direction outgoing SIF radiance  (mW m⁻² nm⁻¹ sr⁻¹))\nSIF_obs_sunlit\nObserver-direction outgoing SIF radiance, sunlit leaves  (mW m⁻² nm⁻¹ sr⁻¹))\nSIF_obs_shaded\nObserver-direction outgoing SIF radiance, shaded leaves  (mW m⁻² nm⁻¹ sr⁻¹))\nSIF_obs_scattered\nObserver-direction outgoing SIF radiance, scattered   (mW m⁻² nm⁻¹ sr⁻¹))\nSIF_obs_soil\nObserver-direction outgoing SIF radiance, soil-reflected  (mW m⁻² nm⁻¹ sr⁻¹))\nSIF_sum\nTotal SIF sum of layer sources  [mW m⁻² nm⁻¹])\n\n\n\n\n\n","category":"type"},{"location":"CanopyLayers/#Land.CanopyLayers.IncomingRadiation","page":"CanopyLayers","title":"Land.CanopyLayers.IncomingRadiation","text":"mutable struct IncomingRadiation{FT}\n\nIncoming radiation information\n\nFields\n\nE_direct\nDirect incoming radiation [mW m⁻² nm⁻¹]\nE_diffuse\nDiffuse incoming radiation [mW m⁻² nm⁻¹]\n\n\n\n\n\n","category":"type"},{"location":"CanopyLayers/#Land.CanopyLayers.LeafBios","page":"CanopyLayers","title":"Land.CanopyLayers.LeafBios","text":"mutable struct LeafBios{FT}\n\nA struct of leaf biological parameters\n\nFields\n\nnWL\nNumber of wave length\nnWLE\nNumber of wave length for excitation\nnWLF\nNumber of wave length for SIF\nN\nLeaf structure parameter\nCab\nChlorophyll a+b content [µg cm⁻²]\nCar\nCarotenoid content [µg cm⁻²]\nAnt\nAnthocynanin content [µg cm⁻²]\nCs\nSenescent material fraction\nCw\nEquivalent water thickness [cm]\nCm\nDry matter content (dry leaf mass per unit area) [g cm⁻²]\nCx\nFractionation between Zeaxanthin and Violaxanthin in Car (1=all Zeaxanthin) (-)\nρ_LW\nBroadband thermal reflectance (-)\nτ_LW\nBroadband thermal transmission (-)\nfqe\nLeaf fluorescence efficiency (Fo standard)\nρ_SW\nShortwave leaf reflectance\nτ_SW\nShortwave leaf transmission\nkChlrel\nRelative absorbtion by Chlorophyll+Car\nkChlrel_old\nRelative absorbtion by Chlorophyll\nMb\nFluorescence excitation matrix backwards\nMf\nFluorescence excitation matrix forwards\nndub\nDoubling adding layers\n\n\n\n\n\n","category":"type"},{"location":"CanopyLayers/#Land.CanopyLayers.LeafOpticals","page":"CanopyLayers","title":"Land.CanopyLayers.LeafOpticals","text":"mutable struct LeafOpticals{FT}\n\nStruct for leaf optical properties\n\nFields\n\nnr\nKm\nKab\nKant\nKcar\nKw\nKBrown\nphi\nKcaV\nKcaZ\nlambda\nWave length [nm], same as WL in WaveLengths`\n\n\n\n\n\n","category":"type"},{"location":"CanopyLayers/#Land.CanopyLayers.RTDimensions","page":"CanopyLayers","title":"Land.CanopyLayers.RTDimensions","text":"mutable struct RTDimensions\n\nStruct that stores matrix dimension information\n\nFields\n\nnAzi\nNumber of azimuth angles\nnIncl\nNumber of inclination agles\nnLayer\nNumber of canopy layers\nnLevel\nNumber of canopy layer boundaries nLayer+1\nnPAR\nNumber of PAR wave lengths\nnWL\nNumber of wave lengths\nnWLE\nNumber of wave length for excitation\nnWLF\nNumber of wave lengths for SIF\n\n\n\n\n\n","category":"type"},{"location":"CanopyLayers/#Land.CanopyLayers.SoilOpticals","page":"CanopyLayers","title":"Land.CanopyLayers.SoilOpticals","text":"mutable struct SoilOpticals{FT}\n\nA struct of soil optical parameters\n\nFields\n\nalbedo_SW\nShortwave albedo\nalbedo_SW_SIF\nShortwave albedo for SIF\nemsvty_SW\nShortwave Emissivity\nalbedo_LW\nLongwave albedo\nsoil_skinT\nSoil surface temperature [K]\n\n\n\n\n\n","category":"type"},{"location":"CanopyLayers/#Land.CanopyLayers.SolarAngles","page":"CanopyLayers","title":"Land.CanopyLayers.SolarAngles","text":"struct SolarAngles{FT}\n\nStruct for observation and solar angles\n\nFields\n\ntts\nSolar Zenith Angle [degree]\ntto\nViewing Zenith Angle in [degree]\npsi\nrelative azimuth in [degree]\n\n\n\n\n\n","category":"type"},{"location":"CanopyLayers/#Land.CanopyLayers.WaveLengths","page":"CanopyLayers","title":"Land.CanopyLayers.WaveLengths","text":"mutable struct WaveLengths{FT}\n\nStruct for pre-set wave length parameters\n\nFields\n\nminwlPAR\nMinimal WL for PAR [nm]\nmaxwlPAR\nMaximal WL for PAR [nm]\nminwle\nMinimal WL for SIF excitation [nm]\nmaxwle\nMaximal WL for SIF excitation [nm]\nminwlf\nMinimal WL for SIF emission/fluorescence [nm]\nmaxwlf\nMaximal WL for SIF emission/fluorescence [nm]\nsWL\nStandard wave length [nm]\ndWL\nDifferential wavelength\noptis\nLeaf optical parameter set\nWL\nWave length [nm]\niWLE\nIndex of WLE in WL\niWLF\nIndex of WLF in WL\niPAR\nindex of wlPAR in WL\nWLE\nexcitation wave length [nm]\nWLF\nFluorescence wave length [nm]\nWL_iPAR\nWave length for PAR\ndWL_iPAR\nDifferential wave length for PAR\ndWL_iWLE\nDifferential wave length for iWLE\nnPAR\nLength of WL_iPAR\nnWL\nLength of WL\nnWLE\nlength of WLE\nnWLF\nlength of WLF\n\n\n\n\n\n","category":"type"},{"location":"CanopyLayers/#Containers","page":"CanopyLayers","title":"Containers","text":"","category":"section"},{"location":"CanopyLayers/","page":"CanopyLayers","title":"CanopyLayers","text":"CFContainer\ncreate_cf_container\nCGContainer\ncreate_cg_container\nSFContainer\ncreate_sf_container\nSWContainer\ncreate_sw_container\nRTContainer\ncreate_rt_container","category":"page"},{"location":"CanopyLayers/#Land.CanopyLayers.CFContainer","page":"CanopyLayers","title":"Land.CanopyLayers.CFContainer","text":"mutable struct CFContainer{FT}\n\nContainer to speed canopy_fluxes! by pre-allocating arrays\n\nFields\n\nabs_wave\nabsorbed energy from wave lengths\nabsfs_lidf\nabsfs' * lidf [nAzi]\nE_all\nwave length energy [same as dWL]\nE_iPAR\nwave length energy [same as iPAR]\nlPs\nlPs [nLayer]\nkChlrel\nkChlrel [same as iPAR]\nPAR_diff\ndiffusive PAR [same as iPAR]\nPAR_diffCab\ndiffusive PAR for photosynthesis [same as iPAR]\nPAR_dir\ndirect PAR [same as iPAR]\nPAR_dirCab\ndiffusive PAR for photosynthesis [same as iPAR]\n\n\n\n\n\n","category":"type"},{"location":"CanopyLayers/#Land.CanopyLayers.create_cf_container","page":"CanopyLayers","title":"Land.CanopyLayers.create_cf_container","text":"create_cf_container(FT, rt_dim::RTDimensions)\n\nCreate a CFContainer type struct, given\n\nFT Floating number type\nrt_dim RTDimensions type struct\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Land.CanopyLayers.CGContainer","page":"CanopyLayers","title":"Land.CanopyLayers.CGContainer","text":"mutable struct CGContainer{FT}\n\nContainer to speed canopy_geometry! by pre-allocating arrays\n\nFields\n\n_Co\ncos_ttli .* cos(tto) dim: nIncl\n_Cs\ncos_ttli .* cos(tts) dim: nIncl\n_So\nsin_ttli .* sin(tto) dim: nIncl\n_Ss\nsin_ttli .* sin(tts) dim: nIncl\n_1s\nmaxtrix filled with 1 dim: (1, nAzi)\n_2d\n2D array to speed up _cds and _cdo dim: (nIncl, nAzi)\n_cdo\nCo * _1s .+ _So * cosphilo' dim: (nIncl, nAzi)\n_cds\nCs * _1s .+ _Ss * costtlo' dim: (nIncl, nAzi)\n\n\n\n\n\n","category":"type"},{"location":"CanopyLayers/#Land.CanopyLayers.create_cg_container","page":"CanopyLayers","title":"Land.CanopyLayers.create_cg_container","text":"create_cg_container(FT, rt_dim::RTDimensions)\n\nCreate a CGContainer type struct, given\n\nFT Floating number type\nrt_dim RTDimensions type struct\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Land.CanopyLayers.SFContainer","page":"CanopyLayers","title":"Land.CanopyLayers.SFContainer","text":"mutable struct SFContainer{FT}\n\nContainer to speed SIF_fluxes! by pre-allocating arrays\n\nFields\n\nM⁻_sun\nM⁺_sun\nwfEs\nsfEs\nsbEs\nM⁺⁻\nM⁺⁺\nM⁻⁺\nM⁻⁻\nsun_dwl_iWlE\ntmp_dwl_iWlE\nϕ_cosΘ_lidf\nvfEplu_shade\nvbEmin_shade\nvfEplu_sun\nvbEmin_sun\nsigfEmin_shade\nsigbEmin_shade\nsigfEmin_sun\nsigbEmin_sun\nsigfEplu_shade\nsigbEplu_shade\nsigfEplu_sun\nsigbEplu_sun\nzeroB\ntmp_1d_nWlF\ntmp_1d_nLayer\ndnorm\nτ_dd\ntransmission of diffusive light?\nρ_dd\nextinction of diffuse light?\nXdd\nRdd\nY\nU\nS⁻\nS⁺\npiLs\npiLd\nFsmin\nFsplu\nFdmin\nFdplu\nFemo\nM⁺\nM⁻\nϕ_cosΘ\nF⁻\nF⁺\nnet_diffuse\ntmp_2d_nWlF_nLayer\ntmp_2d_nWlF_nLayer_2\n\n\n\n\n\n","category":"type"},{"location":"CanopyLayers/#Land.CanopyLayers.create_sf_container","page":"CanopyLayers","title":"Land.CanopyLayers.create_sf_container","text":"create_sf_container(FT, rt_dim::RTDimensions)\n\nCreate a SFContainer type struct, given\n\nFT Floating number type\nrt_dim RTDimensions type struct\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Land.CanopyLayers.SWContainer","page":"CanopyLayers","title":"Land.CanopyLayers.SWContainer","text":"mutable struct SWContainer{FT}\n\nContainer to speed short_wave! by pre-allocating arrays\n\nFields\n\ndnorm\ndnorm?\npiLo\npi * Lo\npiLoc\npi * Lo from canopy\npiLos\npi * Lo from soil\npiLoc2\npi * Lo from canopy 2D matrix\nρ_dd\nextinction of diffuse light?\nρ_sd\nextinction of direct light?\nτ_dd\ntransmission of diffusive light?\nτ_sd\ntransmission of direct light?\n\n\n\n\n\n","category":"type"},{"location":"CanopyLayers/#Land.CanopyLayers.create_sw_container","page":"CanopyLayers","title":"Land.CanopyLayers.create_sw_container","text":"create_sw_container(FT, rt_dim::RTDimensions)\n\nCreate a CGContainer type struct, given\n\nFT Floating number type\nrt_dim RTDimensions type struct\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Land.CanopyLayers.RTContainer","page":"CanopyLayers","title":"Land.CanopyLayers.RTContainer","text":"mutable struct RTContainer{FT}\n\nCollection of containers to speed up RT module\n\nFields\n\ncf_con\nCFContainer type container\ncg_con\nCGContainer type container\nsf_con\nSFContainer type container\nsw_con\nSWContainer type container\n\n\n\n\n\n","category":"type"},{"location":"CanopyLayers/#Land.CanopyLayers.create_rt_container","page":"CanopyLayers","title":"Land.CanopyLayers.create_rt_container","text":"create_rt_container(FT, rt_dim::RTDimensions)\n\nCreate an RTContainer, given\n\nFT Floating number type\nrt_dim RTDimensions type struct\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Initialization-of-Structures","page":"CanopyLayers","title":"Initialization of Structures","text":"","category":"section"},{"location":"CanopyLayers/","page":"CanopyLayers","title":"CanopyLayers","text":"create_canopy_opticals\ncreate_canopy_rads\ncreate_canopy_rt\ncreate_incoming_radiation\ncreate_leaf_bios\ncreate_leaf_opticals\ncreate_rt_dims\ncreate_soil_opticals\ncreate_wave_length\ninitialize_rt_module","category":"page"},{"location":"CanopyLayers/#Land.CanopyLayers.create_canopy_opticals","page":"CanopyLayers","title":"Land.CanopyLayers.create_canopy_opticals","text":"create_canopy_opticals( FT, rt_dim::RTDimensions)\n\nCreate a CanopyOpticals struct, given\n\nFT Floating number type\nrt_dim RTDimensions type struct\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Land.CanopyLayers.create_canopy_rads","page":"CanopyLayers","title":"Land.CanopyLayers.create_canopy_rads","text":"create_canopy_rads(FT, rt_dim::RTDimensions)\n\nCreate a CanopyRads struct, given\n\nFT Floating number type\nrt_dim RTDimensions type struct\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Land.CanopyLayers.create_canopy_rt","page":"CanopyLayers","title":"Land.CanopyLayers.create_canopy_rt","text":"create_canopy_rt(FT; nLayer::Intm LAI::Number)\n\nCreate Canopy4RT, given\n\nFT Floating number type\nnLayer Number of canopy layers\nLAI Leaf area index\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Land.CanopyLayers.create_incoming_radiation","page":"CanopyLayers","title":"Land.CanopyLayers.create_incoming_radiation","text":"create_incoming_radiation(\n            wls::WaveLengths{FT},\n            wlfn::String\n) where {FT<:AbstractFloat}\n\nCreate an AbstractIncomingRadiation struct, given\n\nwls WaveLengths type struct\nwlfn File that saves incoming wave information\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Land.CanopyLayers.create_leaf_bios","page":"CanopyLayers","title":"Land.CanopyLayers.create_leaf_bios","text":"create_leaf_bios(FT, rt_dim::RTDimensions)\n\nCreate a LeafBios type struct, given\n\nFT Floating number type\nrt_dim RTDimensions type struct\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Land.CanopyLayers.create_leaf_opticals","page":"CanopyLayers","title":"Land.CanopyLayers.create_leaf_opticals","text":"create_leaf_opticals(sWL::Array{FT,1}, file::String)\n\nCreate an AbstractLeafOptiPara struct, given\n\nsWL Standard wave length\nopfn File that saves optical parameters\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Land.CanopyLayers.create_rt_dims","page":"CanopyLayers","title":"Land.CanopyLayers.create_rt_dims","text":"create_rt_dims(\n            can::Canopy4RT{FT},\n            wls::WaveLengths{FT}\n) where {FT<:AbstractFloat}\n\nCreate RTDimensions, given\n\ncan Canopy4RT type struct\nwls WaveLengths type struct\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Land.CanopyLayers.create_soil_opticals","page":"CanopyLayers","title":"Land.CanopyLayers.create_soil_opticals","text":"create_soil_opticals(wls::WaveLengths{FT}) where {FT<:AbstractFloat}\n\nCreate SoilOpticals struct, given\n\nwls WaveLengths type struct\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Land.CanopyLayers.create_wave_length","page":"CanopyLayers","title":"Land.CanopyLayers.create_wave_length","text":"create_wave_length(FT)\n\nCreate WaveLengths type struct, given\n\nFT Floating number type\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Land.CanopyLayers.initialize_rt_module","page":"CanopyLayers","title":"Land.CanopyLayers.initialize_rt_module","text":"initialize_rt_module(FT; nLayer::Int, LAI::Number)\n\nInitialize the RT module and return the sturctures, given\n\nFT Floating number type\nnLayer Number of canopy layers\nLAI Leaf area index\n\nThis function initializes and returns\n\nangles SolarAngles\ncan Canopy4RT\ncan_opt CanopyOpticals\ncan_rad CanopyRads\nin_rad IncomingRadiation\nleaves Array{LeafBios,1}\nrt_con RTContainer\nrt_dim RTDimensions\nsoil SoilOpticals\nwls WaveLengths\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Big-Leaf-Model","page":"CanopyLayers","title":"Big Leaf Model","text":"","category":"section"},{"location":"CanopyLayers/","page":"CanopyLayers","title":"CanopyLayers","text":"big_leaf_partition","category":"page"},{"location":"CanopyLayers/#Land.CanopyLayers.big_leaf_partition","page":"CanopyLayers","title":"Land.CanopyLayers.big_leaf_partition","text":"big_leaf_partition(\n            lai::FT,\n            zenith::FT,\n            r_all::FT\n) where {FT<:AbstractFloat}\n\nPartition the big-leaf canopy into sunlit and shaded layers, given\n\nlai Leaf area index\nzenith Zenith angle in degree\nr_all Total radiation in [W m⁻²]\n\nThe function returns\n\nratio ratio of sunlit leaves out of all leaves\nq_slm Mean sunlit layer PAR\nq_shm Mean shaded layer PAR\ne_sl Mean sunlit layer absorbed total energy\ne_sh Mean shaded layer absorbed total energy\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#SCOPE-Model","page":"CanopyLayers","title":"SCOPE Model","text":"","category":"section"},{"location":"CanopyLayers/","page":"CanopyLayers","title":"CanopyLayers","text":"canopy_fluxes!\ncanopy_geometry!\ncanopy_matrices!\nclumping_factor!\ndiffusive_S\ndiffusive_S!\nfluspect!\nshort_wave!\nSIF_fluxes!\nthermal_fluxes!","category":"page"},{"location":"CanopyLayers/#Land.CanopyLayers.canopy_fluxes!","page":"CanopyLayers","title":"Land.CanopyLayers.canopy_fluxes!","text":"canopy_fluxes!(\n            can::Canopy4RT{FT},\n            can_opt::CanopyOpticals{FT},\n            can_rad::CanopyRads{FT},\n            in_rad::IncomingRadiation{FT},\n            soil::SoilOpticals{FT},\n            leaves::Array{LeafBios{FT},1},\n            wls::WaveLengths{FT},\n            rt_con::RTContainer{FT}\n) where {FT<:AbstractFloat}\n\nComputes a variety of integrated fluxes from the spectrally resolved     computations in the short-wave Canopy RT (e.g. absorbed soil radiation,     absorbed direct and diffuse PAR by layer (and angles for direct), net     direct and diffuse energy balance per layer), given\n\ncan Canopy4RT type struct\ncan_opt CanopyOpticals type struct\ncan_rad CanopyRads type struct\nin_rad IncomingRadiation type struct\nsoil SoilOpticals type struct\nleaves Array of LeafBios type struct\nwls WaveLengths type struct\nrt_con RTContainer type container\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Land.CanopyLayers.canopy_geometry!","page":"CanopyLayers","title":"Land.CanopyLayers.canopy_geometry!","text":"canopy_geometry!(\n            can::Canopy4RT{FT},\n            angles::SolarAngles{FT},\n            can_opt::CanopyOpticals{FT},\n            rt_con::RTContainer{FT}\n) where {FT<:AbstractFloat}\n\nComputes canopy optical properties (extinction coefficients for direct and     diffuse light) based on the SAIL model. Most important input parameters are     leaf inclination and azimuth distribution functions and sun-sensor     geometry . Canopy clumping Ω is implemented as in Pinty et al (2015), given\n\ncan Canopy4RT type struct\nangles SolarAngles type struct\ncan_opt CanopyOpticals type struct\nrt_con RTContainer type container\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Land.CanopyLayers.canopy_matrices!","page":"CanopyLayers","title":"Land.CanopyLayers.canopy_matrices!","text":"canopy_matrices!(\n            leaves::Array{LeafBios{FT},1},\n            can_opt::CanopyOpticals{FT}\n) where {FT<:AbstractFloat}\n\nCompute scattering coefficient matrices for direct and diffuse light given     geometry dependent overall extinction coefficients and pigment dependent     leaf reflectance and transmission (computed via fluspect). This function     has to be called before short_wave! can be used.\n\nleaves Array of LeafBios type struct\ncan_opt CanopyOpticals type struct\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Land.CanopyLayers.clumping_factor!","page":"CanopyLayers","title":"Land.CanopyLayers.clumping_factor!","text":"clumping_factor!(\n            can::Canopy4RT{FT},\n            angles::SolarAngles{FT}\n) where {FT<:AbstractFloat}\n\nCalculate the clumping factor, given\n\ncan Canopy4RT type struct\nangles SolarAngles type struct\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Land.CanopyLayers.diffusive_S","page":"CanopyLayers","title":"Land.CanopyLayers.diffusive_S","text":"diffusive_S(\n            τ_dd::Array{FT},\n            ρ_dd::Array{FT},\n            S⁻::Array{FT},\n            S⁺::Array{FT},\n            boundary_top::Array{FT},\n            boundary_bottom::Array{FT},\n            rsoil::Array{FT}\n) where {FT<:AbstractFloat}\n\nComputes 2-stream diffusive radiation transport (used for thermal and SIF) given:\n\nτ_dd A 2D Array with layer reflectances\nρ_dd A 2D Array with layer transmissions\nS⁻ A 2D Array with layer source terms in the downwelling direction\nS⁺ A 2D Array with layer source terms in the upwelling direction\nboundary_top A 1D array with downwelling radiation at the top (top of canopy)\nboundary_bottom A 1D array with upwnwelling radiation at the bottom (soil)\nrsoil A 1D array with soil reflectance\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Land.CanopyLayers.diffusive_S!","page":"CanopyLayers","title":"Land.CanopyLayers.diffusive_S!","text":"diffusive_S!(\n            sf_con::SFContainer{FT},\n            soil::SoilOpticals{FT},\n            rt_dim::RTDimensions\n) where {FT<:AbstractFloat}\n\nComputes 2-stream diffusive radiation transport (used for thermal and SIF),     given\n\nsf_con SFContainer type container\nsoil SoilOpticals type struct\nrt_dim RTDimensions type struct\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Land.CanopyLayers.fluspect!","page":"CanopyLayers","title":"Land.CanopyLayers.fluspect!","text":"fluspect!(\n            leaf::LeafBios{FT},\n            wls::WaveLengths{FT}\n) where {FT<:AbstractFloat}\n\nComputes leaf optical properties (reflectance and transittance) based on     pigment concentrations. Also computes Fluorescence excitation matrices.     Mostly based on PROSPECT-D for leaf reflectance/transmission and FluSpec     for fluorescence.\n\nleaf LeafBios type struct\nwls WaveLengths type struct\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Land.CanopyLayers.short_wave!","page":"CanopyLayers","title":"Land.CanopyLayers.short_wave!","text":"short_wave!(\n            can::Canopy4RT{FT},\n            can_opt::CanopyOpticals{FT},\n            can_rad::CanopyRads{FT},\n            in_rad::IncomingRadiation{FT},\n            soil::SoilOpticals{FT},\n            rt_con::RTContainer{FT}\n) where {FT<:AbstractFloat}\n\nSimulate the short wave radiation through the canopy, given\n\ncan Canopy4RT type struct\ncan_opt CanopyOpticals type struct\ncan_rad CanopyRads type struct\nin_rad IncomingRadiation type struct\nsoil SoilOpticals type struct\nrt_con RTContainer type container\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Land.CanopyLayers.SIF_fluxes!","page":"CanopyLayers","title":"Land.CanopyLayers.SIF_fluxes!","text":"SIF_fluxes!(\n            leaves::Array{LeafBios{FT},1},\n            can_opt::CanopyOpticals{FT},\n            can_rad::CanopyRads{FT},\n            can::Canopy4RT{FT},\n            soil::SoilOpticals{FT},\n            wls::WaveLengths{FT},\n            rt_con::RTContainer{FT},\n            rt_dim::RTDimensions\n) where {FT<:AbstractFloat}\n\nComputes 2-stream diffusive radiation transport for SIF radiation (calls     [diffusive_S!] internally). Layer reflectance and transmission is     computed from SW optical properties, layer sources from absorbed light and     SIF efficiencies. Boundary conditions are zero SIF incoming from atmosphere     or soil.\n\nleaves Array of LeafBios type struct\ncan_opt CanopyOpticals type struct\ncan_rad CanopyRads type struct\ncan Canopy4RT type struct\nsoil SoilOpticals type struct\nwls WaveLengths type struct\nrt_con RTContainer type container\nrt_dim RTDimensions type struct\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Land.CanopyLayers.thermal_fluxes!","page":"CanopyLayers","title":"Land.CanopyLayers.thermal_fluxes!","text":"thermal_fluxes!(\n            leaves::Array{LeafBios{FT},1},\n            can_opt::CanopyOpticals{FT},\n            can_rad::CanopyRads{FT},\n            can::Canopy4RT{FT},\n            soil::SoilOpticals{FT},\n            incLW::Array{FT},\n            wls::WaveLengths{FT}\n) where {FT<:AbstractFloat}\n\nComputes 2-stream diffusive radiation transport for thermal radiation (calls     [diffusive_S] internally). Layer reflectance and transmission is computed     from LW optical properties, layer sources from temperature and Planck law,     boundary conditions from the atmosphere and soil emissivity and     temperature. Currently only uses Stefan Boltzmann law to compute spectrally     integrated LW but can be easily adjusted to be spectrally resolved.\n\nleaves Array of LeafBios type struct\ncan_opt CanopyOpticals type struct\ncan_rad CanopyRads type struct\ncan Canopy4RT type struct\nsoil SoilOpticals type struct\nincLW A 1D array with incoming long-wave radiation\nwls WaveLengths type struct\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Utils","page":"CanopyLayers","title":"Utils","text":"","category":"section"},{"location":"CanopyLayers/","page":"CanopyLayers","title":"CanopyLayers","text":"calctav\ndcum\ndladgen\ne2phot\ne2phot!\nexpint\nfast∫\nfast∫!\npsofunction\nvolscatt!","category":"page"},{"location":"CanopyLayers/#Land.CanopyLayers.calctav","page":"CanopyLayers","title":"Land.CanopyLayers.calctav","text":"calctav(α::FT, nr::FT) where {FT<:AbstractFloat}\n\nComputes transmission of isotropic radiation across an interface between two     dielectrics (Stern F., 1964; Allen W.A., 1973)). From calctav.m in     PROSPECT-D\n\nα angle of incidence\nnr Index of refraction\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Land.CanopyLayers.dcum","page":"CanopyLayers","title":"Land.CanopyLayers.dcum","text":"dcum(a::FT, b::FT, t::FT) where {FT<:AbstractFloat}\n\nTODO Add function description\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Land.CanopyLayers.dladgen","page":"CanopyLayers","title":"Land.CanopyLayers.dladgen","text":"dladgen(a::FT, b::FT, litab_bnd::Array{FT,2}) where {FT<:AbstractFloat}\n\nTODO Calculate the freqency of WHAT?\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Land.CanopyLayers.e2phot","page":"CanopyLayers","title":"Land.CanopyLayers.e2phot","text":"e2phot(λ::Array{FT}, E::Array{FT}) where {FT<:AbstractFloat}\n\nCalculates the number of moles of photons, given\n\nλ An array of wave length in [nm], converted to [m] by _FAC\nE Joules of energy\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Land.CanopyLayers.e2phot!","page":"CanopyLayers","title":"Land.CanopyLayers.e2phot!","text":"e2phot!(\n            λ::Array{FT,1},\n            E::Array{FT,1},\n            container::Array{FT,1}\n) where {FT<:AbstractFloat}\n\nCalculates the number of moles of photons, given\n\nλ An array of wave length in [nm], converted to [m] by _FAC\nE Joules of energy\ncontainer Container to avoid memory allocations\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Land.CanopyLayers.expint","page":"CanopyLayers","title":"Land.CanopyLayers.expint","text":"expint(x::FT) where {FT<:AbstractFloat}\n\nTODO add function description\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Land.CanopyLayers.fast∫","page":"CanopyLayers","title":"Land.CanopyLayers.fast∫","text":"fast∫(f::Vector{FT}, dx::Vector{FT}) where {FT<:AbstractFloat}\n\nA fast way of integrating functions, given\n\nf f(x) for each x\ndx Delta x for each x\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Land.CanopyLayers.fast∫!","page":"CanopyLayers","title":"Land.CanopyLayers.fast∫!","text":"fast∫!(dx::Vector{FT}, f::Vector{FT}) where {FT<:AbstractFloat}\n\nA fast way of integrating functions, given\n\nf f(x) for each x\ndx Delta x for each x\n\nNote that f is a local container, and its values change in this operation.\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Land.CanopyLayers.psofunction","page":"CanopyLayers","title":"Land.CanopyLayers.psofunction","text":"psofunction(\n            K::FT,\n            k::FT,\n            Ω::FT,\n            LAI::FT,\n            q::FT,\n            dso::FT,\n            xl::FT\n) where {FT<:AbstractFloat}\n\nTODO explain the variables\n\nReturn the probability of observing a sunlit leaf at depth xl (pso, see eq     31 in vdT 2009), given\n\nxl Leaf depth in the canopy\n\n\n\n\n\n","category":"function"},{"location":"CanopyLayers/#Land.CanopyLayers.volscatt!","page":"CanopyLayers","title":"Land.CanopyLayers.volscatt!","text":"volscatt!(\n            container::Array{FT,1},\n            tts::FT,\n            tto::FT,\n            psi::FT,\n            ttl::FT\n) where {FT<:AbstractFloat}\n\nCalculate interception parameters (chi_s and chi_s) and leaf reflectance     multiplier (frho) and transmittance multiplier (ftau), given\n\ncontainer Array container for results\ntts Solar zenith angle\ntto Viewing zenith angle\npsi Azimuth angle\nttl Leaf inclination angle\n\n\n\n\n\n","category":"function"},{"location":"SoilPlantAirContinuum/#SoilPlantAirContinuum","page":"SoilPlantAirContinuum","title":"SoilPlantAirContinuum","text":"","category":"section"},{"location":"SoilPlantAirContinuum/","page":"SoilPlantAirContinuum","title":"SoilPlantAirContinuum","text":"CurrentModule = Land.SoilPlantAirContinuum","category":"page"},{"location":"SoilPlantAirContinuum/#Types","page":"SoilPlantAirContinuum","title":"Types","text":"","category":"section"},{"location":"SoilPlantAirContinuum/","page":"SoilPlantAirContinuum","title":"SoilPlantAirContinuum","text":"SPACContainer1L\nSPACContainer2L\nSPACMono\nSPACSimple","category":"page"},{"location":"SoilPlantAirContinuum/#Land.SoilPlantAirContinuum.SPACContainer1L","page":"SoilPlantAirContinuum","title":"Land.SoilPlantAirContinuum.SPACContainer1L","text":"mutable struct SPACContainer1L{FT}\n\nStruct that contains 1-layer gas exchange information.\n\nFields\n\nag\nMean gross photosynthetic rate [μmol m⁻² s⁻¹]\nan\nMean net photosynthetic rate [μmol m⁻² s⁻¹]\nc\nLeaf internal CO₂ partial pressure [Pa]\ne\nFlow rate per basal area [mol s⁻¹ m⁻²]\ngh\nLeaf diffusive conductance to H₂O [mol m⁻² s⁻¹]\np\nXylem end pressure [MPa]\nt\nLeaf temperature [K]\n\n\n\n\n\n","category":"type"},{"location":"SoilPlantAirContinuum/#Land.SoilPlantAirContinuum.SPACContainer2L","page":"SoilPlantAirContinuum","title":"Land.SoilPlantAirContinuum.SPACContainer2L","text":"mutable struct SPACContainer2L{FT}\n\nStruct that contains 2-layer gas exchange information.\n\nFields\n\ncont_sh\ncont_sl\nfrac_sh\nShaded layer fraction\nfrac_sl\nSunlit layer fraction\nla_sh\nShaded layer leaf area [m²]\nla_sl\nSunlit layer leaf area [m²]\nlai_sh\nShaded layer LAI\nlai_sl\nSunlit layer LAI\npar_sh\nShaded layer PAR [μmol m⁻² s⁻¹]\npar_sl\nSunlit layer PAR [μmol m⁻² s⁻¹]\nrad_sh\nShaded layer absorbed energy [W m⁻²]\nrad_sl\nSunlit layer absorbed energy [W m⁻²]\n\n\n\n\n\n","category":"type"},{"location":"SoilPlantAirContinuum/#Land.SoilPlantAirContinuum.SPACMono","page":"SoilPlantAirContinuum","title":"Land.SoilPlantAirContinuum.SPACMono","text":"mutable struct SPACMono{FT}\n\nStruct that mono species SoilPlantAirContinuum system.\n\nFields\n\nsoil_bounds\nSoil layers bounds [m]\nair_bounds\nAir layers bounds [m]\nz_root\nRoot depth [m]\nz_canopy\nCanopy maximal height [m]\nplant_hs\nPlant hydraulic system\nn_canopy\nNumber of canopy layers\nn_root\nNumber of root layers\nplant_ps\nPlant photosynthesis systems\nba\nBasal area [m²]\nga\nGround area [m²]\nla\nLeaf area [m²]\nenvirs\nAir layers\nwind_z0\nAerodynamic roughness [m]\nwind_d\nZero plane displacement [m]\nwind_zs\nMean layer height [m]\nwinds\nWind speed per layer [m s⁻¹]\nmswc\nMaximal soil water content\nswc\nCurrent soil water content\np_soil\nArray of soil matric potential [MPa]\nh_soil\nMaximal soil depth [m]\nlatitude\nLatitude [°]\nlongitude\nLongitude [°]\nelevation\nElevation [m]\nphoto_set\nPhotosynthesis parameter set\nstomata_model\nStomatal behavior scheme\nangles\nSolar angle container\ncanopy_rt\nCanopy4RT container\nwl_set\nWave length container\nrt_dim\nRT dimensions\ncan_rad\nCanopyRads container\ncan_opt\nCanopyOpticals container\nleaves_rt\nArray of LeafBios container\nsoil_opt\nSoilOpticals container\nin_rad\nIncoming radiation container\nrt_con\nRT container\n\n\n\n\n\n","category":"type"},{"location":"SoilPlantAirContinuum/#Land.SoilPlantAirContinuum.SPACSimple","page":"SoilPlantAirContinuum","title":"Land.SoilPlantAirContinuum.SPACSimple","text":"mutable struct SPACSimple{FT}\n\nStruct that simplest mono species SoilPlantAirContinuum system, with 1 root, stem, and leaf.\n\nFields\n\nhs\nHydraulic systems\nec\nCritical flow rate\nps\nPhotosynthesis system\nvtoj\nRatio between Vcmax25 and Jmax25\nenvir\nEnvironmental conditions\ncontainer1L\nContainer for gas exchange for a layer\ncontainer2L\nContainer for gas exchange of sunlit and shaded layers\ncontainerKS\nContainer for default hydraulic conductance\ncontainerOP\nContainer for optimizer\nopt_f_sl\nContainer for optimal sunlit layer flow rate\nopt_f_sh\nContainer for optimal shaded layer flow rate\nopt_laba\nContainer for optimal leaf area per basal area\nopt_vmax\nContainer for optimal Vcmax25\nlai\nLeaf area index\nlaba\nLeaf area per basal area\ng_max\nMaximal stomatal conductance limit at 25 °C\ngaba\nGround area per basal area\nwidth\nLeaf width\nmswc\nMaximal soil water content\nswc\nCurrent soil water content\np_soil\nSoil matrical water potential\nh_soil\nSoil depth, 2X mean root depth\nc_cons\nLeaf construction cost per leaf area\nc_vmax\nLeaf nutrient cost per Vcmax25 per leaf area\nlatitude\nLatitude [°]\nlongitude\nLongitude [°]\nelevation\nElevation [m]\n\n\n\n\n\n","category":"type"},{"location":"SoilPlantAirContinuum/#Soil","page":"SoilPlantAirContinuum","title":"Soil","text":"","category":"section"},{"location":"SoilPlantAirContinuum/","page":"SoilPlantAirContinuum","title":"SoilPlantAirContinuum","text":"soil_moisture_swc!\nsoil_moisture_p!\nsoil_moisture_p25!\nsoil_moisture!","category":"page"},{"location":"SoilPlantAirContinuum/#Land.SoilPlantAirContinuum.soil_moisture_swc!","page":"SoilPlantAirContinuum","title":"Land.SoilPlantAirContinuum.soil_moisture_swc!","text":"soil_moisture_swc!(node::SPACSimple{FT}, swc::FT) where {FT<:AbstractFloat}\n\nUpdate soil moisture and soil matrix potential, given\n\nnode SPACSimple type struct\nswc Given soil water content\n\n\n\n\n\n","category":"function"},{"location":"SoilPlantAirContinuum/#Land.SoilPlantAirContinuum.soil_moisture_p!","page":"SoilPlantAirContinuum","title":"Land.SoilPlantAirContinuum.soil_moisture_p!","text":"soil_moisture_p!(node::SPACSimple{FT}, p::FT) where {FT<:AbstractFloat}\n\nUpdate soil moisture and soil matrix potential, given\n\nnode SPACSimple type struct\np Given soil maxtrix potential\n\n\n\n\n\n","category":"function"},{"location":"SoilPlantAirContinuum/#Land.SoilPlantAirContinuum.soil_moisture_p25!","page":"SoilPlantAirContinuum","title":"Land.SoilPlantAirContinuum.soil_moisture_p25!","text":"soil_moisture_p25!(node::SPACSimple{FT}, p_25::FT) where {FT<:AbstractFloat}\n\nUpdate soil moisture and soil matrix potential, given\n\nnode SPACSimple type struct\np_25 Given soil maxtrix potential at 25 Celcius\n\n\n\n\n\n","category":"function"},{"location":"SoilPlantAirContinuum/#Land.SoilPlantAirContinuum.soil_moisture!","page":"SoilPlantAirContinuum","title":"Land.SoilPlantAirContinuum.soil_moisture!","text":"soil_moisture!(node::SPACSimple{FT}, flow, dt=1.0) where {FT<:AbstractFloat}\n\nUpdate soil moisture and soil matrix potential, given\n\nnode SPACSimple type struct\nflow Mean outlet flow rate in [Kg h⁻¹]\nΔt Time period in [h]\n\n\n\n\n\n","category":"function"},{"location":"SoilPlantAirContinuum/#Planet","page":"SoilPlantAirContinuum","title":"Planet","text":"","category":"section"},{"location":"SoilPlantAirContinuum/","page":"SoilPlantAirContinuum","title":"SoilPlantAirContinuum","text":"atmospheric_pressure_ratio\natmospheric_pressure\nppm_to_Pa\nzenith_angle","category":"page"},{"location":"SoilPlantAirContinuum/#Land.SoilPlantAirContinuum.atmospheric_pressure_ratio","page":"SoilPlantAirContinuum","title":"Land.SoilPlantAirContinuum.atmospheric_pressure_ratio","text":"atmospheric_pressure(h::FT)\n\nCalculate the atmospheric pressure, given\n\nh elevation in [m]\n\n\n\n\n\n","category":"function"},{"location":"SoilPlantAirContinuum/#Land.SoilPlantAirContinuum.atmospheric_pressure","page":"SoilPlantAirContinuum","title":"Land.SoilPlantAirContinuum.atmospheric_pressure","text":"atmospheric_pressure(h::FT)\n\nCalculate the atmospheric pressure, given\n\nh elevation in [m]\n\n\n\n\n\n","category":"function"},{"location":"SoilPlantAirContinuum/#Land.SoilPlantAirContinuum.ppm_to_Pa","page":"SoilPlantAirContinuum","title":"Land.SoilPlantAirContinuum.ppm_to_Pa","text":"ppm_to_Pa(h::FT)\n\nConvert ppm to Pa, given\n\nh elevation in [m]\n\n\n\n\n\n","category":"function"},{"location":"SoilPlantAirContinuum/#Land.SoilPlantAirContinuum.zenith_angle","page":"SoilPlantAirContinuum","title":"Land.SoilPlantAirContinuum.zenith_angle","text":"zenith_angle(latd::FT, decd::FT, lhad::FT) where {FT<:AbstractFloat}\nzenith_angle(latd::FT, day::FT, hour::FT, minute::FT) where {FT<:AbstractFloat}\n\nCalculate the zenith angle, given\n\nlatd Latitude in degree\ndecd Declination of the Sun in degree\nlhad Local hour angle in degree\nday Day of year\nhour Hour of day\nminute Minute of hour\n\n\n\n\n\n","category":"function"},{"location":"SoilPlantAirContinuum/#Big-leaf-model","page":"SoilPlantAirContinuum","title":"Big-leaf model","text":"","category":"section"},{"location":"SoilPlantAirContinuum/","page":"SoilPlantAirContinuum","title":"SoilPlantAirContinuum","text":"gain_risk_map\nleaf_gas_exchange_nonopt!\nleaf_gas_exchange!\noptimize_flows!\nbig_leaf_partition!\nradiative_conductance\nblack_body_emittance\nboundary_layer_conductance\nleaf_temperature\nleaf_temperature_sunlit\nleaf_temperature_shaded\nannual_profit\nannual_simulation!\ncreate_dataframe\ninitialize_spac_canopy!","category":"page"},{"location":"SoilPlantAirContinuum/#Land.SoilPlantAirContinuum.gain_risk_map","page":"SoilPlantAirContinuum","title":"Land.SoilPlantAirContinuum.gain_risk_map","text":"gain_risk_map(node::SPACSimple{FT}, photo_set::AbstractPhotoModelParaSet{FT}) where {FT<:AbstractFloat}\n\nReturn the matrix of optimizers at different sunlit and shaded layer flow     rates, given\n\nnode [SPACSimple] type struct\nphoto_set [AbstractPhotoModelParaSet] type photosynthesis parameter set\n\n\n\n\n\n","category":"function"},{"location":"SoilPlantAirContinuum/#Land.SoilPlantAirContinuum.leaf_gas_exchange_nonopt!","page":"SoilPlantAirContinuum","title":"Land.SoilPlantAirContinuum.leaf_gas_exchange_nonopt!","text":"leaf_gas_exchange_nonopt!(node::SPACSimple{FT}, photo_set::AbstractPhotoModelParaSet{FT}, flow::FT, par::FT, rad::FT, la::FT, container::SPACContainer1L{FT}) where {FT<:AbstractFloat}\nleaf_gas_exchange_nonopt!(node::SPACSimple{FT}, photo_set::AbstractPhotoModelParaSet{FT}, flow::FT) where {FT<:AbstractFloat}\nleaf_gas_exchange_nonopt!(node::SPACSimple{FT}, photo_set::AbstractPhotoModelParaSet{FT}, f_sl::FT, f_sh::FT) where {FT<:AbstractFloat}\n\nSimulate leaf level gas exchange and fill it into the container for 1-layer     or 2-layer canopy, given\n\nnode [SPACSimple] type struct\nphoto_set [AbstractPhotoModelParaSet] type struct\nflow Flow rate per basal area into the leaves (e.g., for sunlit leaves)\nf_sl Flow rate per basal area into the sunlit leaves\nf_sh Flow rate per basal area into the shaded leaves\npar Leaf-level photosynthetic active radiation\nrad Leaf-level absorbed radiative energy\nla Leaf area of the leaves (total or each layer)\ncontainer [SPACContainer1L] type container\n\n\n\n\n\n","category":"function"},{"location":"SoilPlantAirContinuum/#Land.SoilPlantAirContinuum.leaf_gas_exchange!","page":"SoilPlantAirContinuum","title":"Land.SoilPlantAirContinuum.leaf_gas_exchange!","text":"leaf_gas_exchange!(node::SPACSimple{FT}, photo_set::AbstractPhotoModelParaSet{FT}, flow::FT, par::FT, rad::FT, la::FT, container::SPACContainer1L{FT}) where {FT<:AbstractFloat}\nleaf_gas_exchange!(node::SPACSimple{FT}, photo_set::AbstractPhotoModelParaSet{FT}, flow::FT) where {FT<:AbstractFloat}\nleaf_gas_exchange!(node::SPACSimple{FT}, photo_set::AbstractPhotoModelParaSet{FT}, f_sl::FT, f_sh::FT) where {FT<:AbstractFloat}\n\nSimulate leaf level gas exchange and fill it into the container for 1-layer     or 2-layer canopy, given\n\nnode [SPACSimple] type struct\nphoto_set [AbstractPhotoModelParaSet] type struct\nflow Flow rate per basal area into the leaves (e.g., for sunlit leaves)\nf_sl Flow rate per basal area into the sunlit leaves\nf_sh Flow rate per basal area into the shaded leaves\npar Leaf-level photosynthetic active radiation\nrad Leaf-level absorbed radiative energy\nla Leaf area of the leaves (total or each layer)\ncontainer [SPACContainer1L] type container\n\n\n\n\n\n","category":"function"},{"location":"SoilPlantAirContinuum/#Land.SoilPlantAirContinuum.optimize_flows!","page":"SoilPlantAirContinuum","title":"Land.SoilPlantAirContinuum.optimize_flows!","text":"optimize_flows!(node::SPACSimple{FT}, photo_set::AbstractPhotoModelParaSet{FT}) where {FT<:AbstractFloat}\n\nOptimize the flow rates in sunlit and shaded layers, given\n\nnode [SPACSimple] type struct\nphoto_set [AbstractPhotoModelParaSet] type struct\n\n\n\n\n\n","category":"function"},{"location":"SoilPlantAirContinuum/#Land.SoilPlantAirContinuum.big_leaf_partition!","page":"SoilPlantAirContinuum","title":"Land.SoilPlantAirContinuum.big_leaf_partition!","text":"big_leaf_partition!(node::SPACSimple{FT}, zenith::FT, r_all::FT) where {FT <:AbstractFloat}\n\nPartition the big-leaf canopy into sunlit and shaded layers, given\n\npartition Container for partition\nzenith Zenith angle in degree\nr_all Total radiation in [W m⁻²]\n\n\n\n\n\n","category":"function"},{"location":"SoilPlantAirContinuum/#Land.SoilPlantAirContinuum.radiative_conductance","page":"SoilPlantAirContinuum","title":"Land.SoilPlantAirContinuum.radiative_conductance","text":"radiative_conductance(T::FT) where {FT<:AbstractFloat}\n\nReturn the radiative conductance of leaf, given\n\nT leaf temperature\n\n\n\n\n\n","category":"function"},{"location":"SoilPlantAirContinuum/#Land.SoilPlantAirContinuum.black_body_emittance","page":"SoilPlantAirContinuum","title":"Land.SoilPlantAirContinuum.black_body_emittance","text":"black_body_emittance(T::FT) where {FT<:AbstractFloat}\n\nReturn the energy been radiated out, given\n\nT leaf temperature\n\n\n\n\n\n","category":"function"},{"location":"SoilPlantAirContinuum/#Land.SoilPlantAirContinuum.boundary_layer_conductance","page":"SoilPlantAirContinuum","title":"Land.SoilPlantAirContinuum.boundary_layer_conductance","text":"boundary_layer_conductance(wind::FT, width::FT) where {FT<:AbstractFloat}\n\nReturn the boundary layer conductance, given\n\nwind Wind speed\nwidth Leaf width\n\n\n\n\n\n","category":"function"},{"location":"SoilPlantAirContinuum/#Land.SoilPlantAirContinuum.leaf_temperature","page":"SoilPlantAirContinuum","title":"Land.SoilPlantAirContinuum.leaf_temperature","text":"leaf_temperature(node::SPACSimple{FT}, rad::FT, e_rad::FT, epla::FT) where {FT<:AbstractFloat}\nleaf_temperature(node::SPACSimple{FT}, rad::FT, flow::FT) where {FT<:AbstractFloat}\n\nReturn leaf temperature, given\n\nnode SPACSimple type struct\nrad Absorbed solar radiation per leaf area\ne_rad Emitted absorbed radiation per leaf area\nepla Flow rate per leaf area\nflow Total flow rate per basal area\n\n\n\n\n\n","category":"function"},{"location":"SoilPlantAirContinuum/#Land.SoilPlantAirContinuum.leaf_temperature_sunlit","page":"SoilPlantAirContinuum","title":"Land.SoilPlantAirContinuum.leaf_temperature_sunlit","text":"leaf_temperature_sunlit(node::SPACSimple{FT}, rad::FT, f_sl::FT) where {FT<:AbstractFloat}\n\nReturn leaf temperature, given\n\nnode SPACSimple type struct\nrad Absorbed solar radiation per leaf area\nf_sl Total flow rate per basal area into sunlit leaves\n\n\n\n\n\n","category":"function"},{"location":"SoilPlantAirContinuum/#Land.SoilPlantAirContinuum.leaf_temperature_shaded","page":"SoilPlantAirContinuum","title":"Land.SoilPlantAirContinuum.leaf_temperature_shaded","text":"leaf_temperature_shaded(node::SPACSimple{FT}, rad::FT, f_sh::FT) where {FT<:AbstractFloat}\n\nReturn leaf temperature, given\n\nnode SPACSimple type struct\nrad Absorbed solar radiation per leaf area\nf_sh Total flow rate per basal area into shaded leaves\n\n\n\n\n\n","category":"function"},{"location":"SoilPlantAirContinuum/#Land.SoilPlantAirContinuum.annual_profit","page":"SoilPlantAirContinuum","title":"Land.SoilPlantAirContinuum.annual_profit","text":"annual_profit(node::SPACSimple{FT}, photo_set::AbstractPhotoModelParaSet{FT}, weather::Array{FT,2}) where {FT<:AbstractFloat}\n\nCalculate the profit in the growing season so as to optimize leaf investment,     given\n\nnode [SPACSimple] type struct\nphoto_set [AbstractPhotoModelParaSet] type struct\nweather Weather profile in a growing season\n\n\n\n\n\n","category":"function"},{"location":"SoilPlantAirContinuum/#Land.SoilPlantAirContinuum.annual_simulation!","page":"SoilPlantAirContinuum","title":"Land.SoilPlantAirContinuum.annual_simulation!","text":"annual_simulation!(node::SPACSimple{FT}, photo_set::AbstractPhotoModelParaSet{FT}, weather::DataFrame, output::DataFrame) where {FT<:AbstractFloat}\n\nRun annual simulation for a growing season, given\n\nnode [SPACSimple] type struct\nphoto_set [AbstractPhotoModelParaSet] type struct\nweather Weather profile in a growing season\noutput The predefined output result\n\n\n\n\n\n","category":"function"},{"location":"SoilPlantAirContinuum/#Land.SoilPlantAirContinuum.create_dataframe","page":"SoilPlantAirContinuum","title":"Land.SoilPlantAirContinuum.create_dataframe","text":"function create_dataframe(FT, weather::DataFrame)\n\nCreate a data frame to storesimulation output, given\n\nFT Floating number type\nweather Weather profile in a growing season\n\n\n\n\n\n","category":"function"},{"location":"SoilPlantAirContinuum/#Land.SoilPlantAirContinuum.initialize_spac_canopy!","page":"SoilPlantAirContinuum","title":"Land.SoilPlantAirContinuum.initialize_spac_canopy!","text":"initialize_spac_canopy!(node::SPACMono{FT}) where {FT<:AbstractFloat}\n\nInitialize the RT parameters for a given\n\nnode SPACMono type struct\n\n\n\n\n\n","category":"function"},{"location":"SoilPlantAirContinuum/#Optimal-investment","page":"SoilPlantAirContinuum","title":"Optimal investment","text":"","category":"section"},{"location":"SoilPlantAirContinuum/","page":"SoilPlantAirContinuum","title":"SoilPlantAirContinuum","text":"leaf_allocation!\noptimize_leaf!\noptimize_hs!","category":"page"},{"location":"SoilPlantAirContinuum/#Land.SoilPlantAirContinuum.leaf_allocation!","page":"SoilPlantAirContinuum","title":"Land.SoilPlantAirContinuum.leaf_allocation!","text":"leaf_allocation!(node::SPACSimple{FT}, laba::FT) where {FT<:AbstractFloat}\nleaf_allocation!(node::SPACSimple{FT}, photo_set::AbstractPhotoModelParaSet{FT}, vmax::FT) where {FT<:AbstractFloat}\nleaf_allocation!(node::SPACSimple{FT}, photo_set::AbstractPhotoModelParaSet{FT}, laba::FT, vmax::FT) where {FT<:AbstractFloat}\n\nUpdate leaf area and maximal carboxylation rate, given\n\nnode [SPACSimple] type struct\nphoto_set [AbstractPhotoModelParaSet] type struct\nlaba Given leaf area per basal area\nvmax Given Vcmax25\n\n\n\n\n\n","category":"function"},{"location":"SoilPlantAirContinuum/#Land.SoilPlantAirContinuum.optimize_leaf!","page":"SoilPlantAirContinuum","title":"Land.SoilPlantAirContinuum.optimize_leaf!","text":"optimize_leaf!(node::SPACSimple{FT}, photo_set::AbstractPhotoModelParaSet{FT}, weather::Array{FT,2}, printing::Bool) where {FT<:AbstractFloat}\n\nOptimize leaf area (LAI within 0-20) and photosynthetic capacity (within     5-200), given\n\nnode [SPACSimple] type struct\nphoto_set [AbstractPhotoModelParaSet] type struct\nweather Weather profile in a growing season\nprinting Optional. If true, printing progress\n\n\n\n\n\n","category":"function"},{"location":"SoilPlantAirContinuum/#Land.SoilPlantAirContinuum.optimize_hs!","page":"SoilPlantAirContinuum","title":"Land.SoilPlantAirContinuum.optimize_hs!","text":"optimize_hs!(node::SPACSimple{FT}, photo_set::AbstractPhotoModelParaSet{FT}, weather::Array{FT,2}) where {FT<:AbstractFloat}\n\nOptimize hydraulic conductance and leaf investment, given\n\nnode [SPACSimple] type struct\nphoto_set [AbstractPhotoModelParaSet] type struct\nweather Weather profile in a growing season\n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Photosynthesis","page":"Photosynthesis","title":"Photosynthesis","text":"","category":"section"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"CurrentModule = Land.Photosynthesis","category":"page"},{"location":"Photosynthesis/#Leaf-and-Environment-Structures","page":"Photosynthesis","title":"Leaf and Environment Structures","text":"","category":"section"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"To model photosynthesis more efficiently, we use a container (Leaf     struct) to store the photosynthesis-related information. For example, many     of the physiological parameters are temperature-dependent, but these     temperature-dependent values only need to be updated when leaf temperature     changes. Therefore, use of the container significantly reduces the time     required when programing leaf gas exchange prognostically. The     Leaf struct has the following fields:","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"Leaf","category":"page"},{"location":"Photosynthesis/#Land.Photosynthesis.Leaf","page":"Photosynthesis","title":"Land.Photosynthesis.Leaf","text":"mutable struct Leaf{FT}\n\nStruct to store leaf information.\n\nFields\n\nT\nTemperature [K]\nKd\nRate constant for thermal dissipation\nKf\nRate constant for fluorescence (const)\nKn\nNPQ rate constant (initially zero)\nKp\nRate constant for photochemistry (all reaction centers open)\nmaxPSII\nmax PSII yield (Kn=0, all RC open)\nPSII_frac\nFraction of absorbed light used by PSII ETR\np_i\nLeaf internal CO₂ partial pressure [Pa]\np_s\nLeaf surface CO₂ partial pressure [Pa]\np_sat\nSaturation H₂O vapor pressure [Pa]\ng_bc\nLeaf diffusive conductance to CO₂ [mol m⁻² s⁻¹]\ng_lc\nLeaf diffusive conductance to CO₂ [mol m⁻² s⁻¹]\nAc\nRubisCO limited photosynthetic rate [μmol m⁻² s⁻¹]\nAj\nLight limited photosynthetic rate [μmol m⁻² s⁻¹]\nAg\nGross photosynthetic rate [μmol m⁻² s⁻¹]\nAn\nNet photosynthetic rate [μmol m⁻² s⁻¹]\nAp\nProduct limited photosynthetic rate [μmol m⁻² s⁻¹]\nJ\nElectron transport [μmol m⁻² s⁻¹]\nJ_pot\nPotential Electron Transport Rate [μmol m⁻² s⁻¹]\nJmax\nMaximal electron transport rate [μmol m⁻² s⁻¹]\nJmax25\nMaximal electron transport rate at 298.15 K [μmol m⁻² s⁻¹]\nKc\nRubisCO coefficient Kc [Pa]\nKo\nRubisCO coefficient Ko [Pa]\nKpep\nPEP coefficient Ko [Pa]\nKm\nMichaelis-Menten's coefficient [Pa]\nRd\nRespiration rate [μmol m⁻² s⁻¹]\nRd25\nRespiration rate at 298.15 K [μmol m⁻² s⁻¹]\nVcmax\nMaximal carboxylation rate [μmol m⁻² s⁻¹]\nVcmax25\nMaximal carboxylation rate at 298.15 K [μmol m⁻² s⁻¹]\nVpmax\nMaximal PEP carboxylation rate [μmol m⁻² s⁻¹]\nVpmax25\nMaximal PEP carboxylation rate at 298.15 K [μmol m⁻² s⁻¹]\nΓ_star\nCO₂ compensation point with the absence of Rd [Pa]\nJmax25WW\nWell watered maximal electron transport rate at 298.15 K [μmol m⁻² s⁻¹]\nRd25WW\nWell watered respiration rate at 298.15 K [μmol m⁻² s⁻¹]\nVcmax25WW\nWell watered maximal carboxylation rate at 298.15 K [μmol m⁻² s⁻¹]\nVpmax25WW\nWell watered maximal PEP carboxylation rate at 298.15 K [μmol m⁻² s⁻¹]\nCO₂_per_electron\nTotal efficiency, incl. photorespiration [mol CO₂ mol⁻¹ e-]\nFm\ndark adapted yield (Kp=0)\nFm′\nlight adapted yield (Kp=0)\nFo\ndark-adapted fluorescence yield (Kp=max)\nFo′\nlight-adapted fluorescence yield in the dark (Kp=max)\nJa\nActual electron transport rate [μmol m⁻² s⁻¹]\nNPQ\nNon-Photochemical quenching\nqQ\nPhotochemical quenching\nqE\nenergy quenching\nφ\nPSII yield\nϕs\nSteady-state (light-adapted) yield (aka Fs)\nAPAR\nAbsorbed photosynthetic active radiation [μmol m⁻² s⁻¹]\n\n\n\n\n\n","category":"type"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"Also, environmental conditions are required to compute photosynthetic rate, and     these conditions are stored in AirLayer struct. An     AirLayer struct further allows for more conveniently modeling     photosynthesis the vertical CO₂ and H₂O gradients in the canopy. The     AirLayer structs has the following fields:","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"AirLayer","category":"page"},{"location":"Photosynthesis/#Land.Photosynthesis.AirLayer","page":"Photosynthesis","title":"Land.Photosynthesis.AirLayer","text":"mutable struct AirLayer{FT}\n\nStruct to store environmental conditions in each air layer corresponds to one     canopy layer.\n\nFields\n\nt_air\nAir temperature [K]\np_a\nAtmospheric CO₂ partial pressure [Pa]\np_atm\nAtmospheric pressure [Pa]\np_H₂O\nAtmospheric vapor pressure [Pa]\np_O₂\nAtmospheric O₂ partial pressure [Pa]\np_sat\nSaturation vapor pressure [Pa]\nRH\nRelatiev humidity\nvpd\nVapor pressure deficit [Pa]\nwind\nWind speed [m s⁻¹]\n\n\n\n\n\n","category":"type"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"See exmaples below for how to create the structs","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"using Photosynthesis\n\nFT = Float32;\nleaf = Leaf{FT}();\nenvir = AirLayer{FT}();","category":"page"},{"location":"Photosynthesis/#Temperature-Dependency-Structs","page":"Photosynthesis","title":"Temperature Dependency Structs","text":"","category":"section"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"The temperature-dependent (TD) photosynthetic parameters include","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"J_textmax Maximal electron transport rate\nK_textc Michaelis constant for CO₂\nK_textm Michaelis-Menten's coefficient\nK_texto Michaelis constant for O₂\nK_textpep Michaelis constant for PEP carboxylation\nR_textd Dark respiration\nV_textcmax Maximal RuBP carboxylation rate\nV_textomax Maximal RuBP oxygenation rate\nV_textpmax Maximal PEP carboxylation rate\nΓ^* CO₂ compensation point with the absence of dark respiration","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"There are two typical types of temperature dependencies using the classic     Arrhenius equation. We define the three types as ArrheniusTD,     ArrheniusPeakTD, and Q10TD subject to     AbstractTDParameterSet type:","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"AbstractTDParameterSet\nArrheniusTD\nArrheniusPeakTD\nQ10TD","category":"page"},{"location":"Photosynthesis/#Land.Photosynthesis.AbstractTDParameterSet","page":"Photosynthesis","title":"Land.Photosynthesis.AbstractTDParameterSet","text":"abstract type AbstractTDParameterSet{FT}\n\nHierarchy of the AbstractTDParameterSet:\n\nArrheniusTD\nArrheniusPeakTD\n\n\n\n\n\n","category":"type"},{"location":"Photosynthesis/#Land.Photosynthesis.ArrheniusTD","page":"Photosynthesis","title":"Land.Photosynthesis.ArrheniusTD","text":"struct ArrheniusTD{FT}\n\nAn AbstractTDParameterSet type struct using\n\ncorr = exp left( dfracΔHaR T_0 - dfracΔHaR T_1 right)\n\nFields\n\nVAL_25\nUncorrected value at 298.15 K\nΔHa_to_R\nRatio between ΔHa and R [K]\nΔHa_to_RT25\nRatio between ΔHa and R*K_25\n\n\n\n\n\n","category":"type"},{"location":"Photosynthesis/#Land.Photosynthesis.ArrheniusPeakTD","page":"Photosynthesis","title":"Land.Photosynthesis.ArrheniusPeakTD","text":"struct ArrheniusPeakTD{FT}\n\nAn AbstractTDParameterSet type struct using\n\ncorr = exp left( dfracΔHaR T_0 - dfracΔHaR T_1 right)\n       cdot\n       dfrac 1 + exp left( dfracS_v T_0 - H_dR T_0 right) \n               1 + exp left( dfracS_v T_1 - H_dR T_1 right) \n\nFields\n\nΔHa_to_RT25\nRatio between ΔHa and R*K_25\nΔHd_to_R\nRatio between ΔHd and R\nΔSv_to_R\nRatio between ΔSv and R\nC\nCorrection factor C = 1 + exp( Sv/R + Hd/(RT0) )\n\n\n\n\n\n","category":"type"},{"location":"Photosynthesis/#Land.Photosynthesis.Q10TD","page":"Photosynthesis","title":"Land.Photosynthesis.Q10TD","text":"struct Q10TD{FT}\n\nAn AbstractTDParameterSet type struct using\n\nVAL = VAL_REF left( dfracT_1 - T_REF10 right)^Q_10\n\nFields\n\nVAL_REF\nUncorrected value at reference temperature\nT_REF\nReference temperature [K]\nQ_10\nPower of Q10 correction\n\n\n\n\n\n","category":"type"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"There are many published parameter sets for the various temperature     dependencies, and to ease the modeling we predefined most of the structs:","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"JmaxTDBernacchi\nJmaxTDCLM\nJmaxTDLeuning\nKcTDBernacchi\nKcTDCLM\nKoTDBernacchi\nKoTDCLM\nKpepTDBoyd\nKpepTDCLM\nRespirationTDBernacchi\nRespirationTDCLM\nVcmaxTDBernacchi\nVcmaxTDCLM\nVcmaxTDLeuning\nVomaxTDBernacchi\nVpmaxTDBoyd\nΓStarTDBernacchi\nΓStarTDCLM","category":"page"},{"location":"Photosynthesis/#Land.Photosynthesis.JmaxTDBernacchi","page":"Photosynthesis","title":"Land.Photosynthesis.JmaxTDBernacchi","text":"ArrheniusPeakTD type Jmax TD \n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Land.Photosynthesis.JmaxTDCLM","page":"Photosynthesis","title":"Land.Photosynthesis.JmaxTDCLM","text":"ArrheniusPeakTD type Jmax TD \n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Land.Photosynthesis.JmaxTDLeuning","page":"Photosynthesis","title":"Land.Photosynthesis.JmaxTDLeuning","text":"ArrheniusPeakTD type Jmax TD from Leuning's data \n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Land.Photosynthesis.KcTDBernacchi","page":"Photosynthesis","title":"Land.Photosynthesis.KcTDBernacchi","text":"ArrheniusTD type Kc TD from Bernacchi's data \n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Land.Photosynthesis.KcTDCLM","page":"Photosynthesis","title":"Land.Photosynthesis.KcTDCLM","text":"ArrheniusTD type Kc TD \n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Land.Photosynthesis.KoTDBernacchi","page":"Photosynthesis","title":"Land.Photosynthesis.KoTDBernacchi","text":"ArrheniusTD type Ko TD from Bernacchi's data \n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Land.Photosynthesis.KoTDCLM","page":"Photosynthesis","title":"Land.Photosynthesis.KoTDCLM","text":"ArrheniusTD type Ko TD \n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Land.Photosynthesis.KpepTDBoyd","page":"Photosynthesis","title":"Land.Photosynthesis.KpepTDBoyd","text":"ArrheniusTD type Kpep TD from Boyd's data \n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Land.Photosynthesis.KpepTDCLM","page":"Photosynthesis","title":"Land.Photosynthesis.KpepTDCLM","text":"ArrheniusTD type Kpep TD \n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Land.Photosynthesis.RespirationTDBernacchi","page":"Photosynthesis","title":"Land.Photosynthesis.RespirationTDBernacchi","text":"ArrheniusTD type Respiration TD from Bernacchi's data \n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Land.Photosynthesis.RespirationTDCLM","page":"Photosynthesis","title":"Land.Photosynthesis.RespirationTDCLM","text":"ArrheniusPeakTD type Respiration TD \n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Land.Photosynthesis.VcmaxTDBernacchi","page":"Photosynthesis","title":"Land.Photosynthesis.VcmaxTDBernacchi","text":"ArrheniusTD type Vcmax TD from Bernacchi's data \n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Land.Photosynthesis.VcmaxTDCLM","page":"Photosynthesis","title":"Land.Photosynthesis.VcmaxTDCLM","text":"ArrheniusPeakTD type Vcmax TD \n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Land.Photosynthesis.VcmaxTDLeuning","page":"Photosynthesis","title":"Land.Photosynthesis.VcmaxTDLeuning","text":"ArrheniusPeakTD type Vcmax TD from Leuning's data \n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Land.Photosynthesis.VomaxTDBernacchi","page":"Photosynthesis","title":"Land.Photosynthesis.VomaxTDBernacchi","text":"ArrheniusTD type Vomax TD from Bernacchi's data \n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Land.Photosynthesis.VpmaxTDBoyd","page":"Photosynthesis","title":"Land.Photosynthesis.VpmaxTDBoyd","text":"ArrheniusPeakTD type Vpmax TD from Boyd's data \n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Land.Photosynthesis.ΓStarTDBernacchi","page":"Photosynthesis","title":"Land.Photosynthesis.ΓStarTDBernacchi","text":"ArrheniusTD type Γ^* TD from Bernacchi's data \n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Land.Photosynthesis.ΓStarTDCLM","page":"Photosynthesis","title":"Land.Photosynthesis.ΓStarTDCLM","text":"ArrheniusTD type Γ* TD \n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"The TDs can be easily created using commands like","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"using Photosynthesis\n\nFT = Float32;\n_td_1 = JmaxTDBernacchi(FT);\n_td_2 = VcmaxTDCLM(FT);","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"However, be aware that these pre-defined TD structs are not mutable, to create     customized TD struct, code like this will be useful","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"using Photosynthesis\n\nFT = Float32;\n_td_1 = ArrheniusTD{FT}(1, 10000, 30);\n_td_1 = ArrheniusPeakTD{FT}(1, 10000, 30, 1);","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"To further simplify the use of Photosynthesis module, we provide a few     collections/structs of temperature dependencies as well as other parameter     sets like FluoParaSet. The structs are catergorized to     C3ParaSet and C4ParaSet subject to an     AbstractPhotoModelParaSet type, and the structs are meant for     modeling C3 photosynthesis and C4 photosynthesis, respectively.","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"AbstractPhotoModelParaSet\nC3ParaSet\nC4ParaSet","category":"page"},{"location":"Photosynthesis/#Land.Photosynthesis.AbstractPhotoModelParaSet","page":"Photosynthesis","title":"Land.Photosynthesis.AbstractPhotoModelParaSet","text":"abstract type AbstractPhotoModelParaSet{FT}\n\nHierarchy of the AbstractPhotoModelParaSet:\n\nC3ParaSet\nC4ParaSet\n\n\n\n\n\n","category":"type"},{"location":"Photosynthesis/#Land.Photosynthesis.C3ParaSet","page":"Photosynthesis","title":"Land.Photosynthesis.C3ParaSet","text":"mutable struct C3Paraset{FT}\n\nParameter sets for C3 photosynthesis.\n\nFields\n\nJT\nJmax temperature dependency\nKcT\nKc temperature dependency\nKoT\nKo temperature dependency\nReT\nRespiration temperature dependency\nVcT\nVcmax temperature dependency\nΓsT\nΓ_star temperature dependency\nFlu\nFluorescence model\nVR\nVcmax25 and respiration correlation\nEff_1\nCoefficient 4.0/4.5 for NADPH/ATP requirement stochiometry, respectively\nEff_2\nCoefficient 8.0/10.5 for NADPH/ATP requirement stochiometry, respectively\n\n\n\n\n\n","category":"type"},{"location":"Photosynthesis/#Land.Photosynthesis.C4ParaSet","page":"Photosynthesis","title":"Land.Photosynthesis.C4ParaSet","text":"mutable struct C4ParaSet{FT}\n\nParameter sets for C3 photosynthesis.\n\nFields\n\nKpT\nKpep temperature dependency\nReT\nRespiration temperature dependency\nVcT\nVcmax temperature dependency\nVpT\nVpmax temperature dependency\nFlu\nFluorescence model\nVR\nVcmax25 and respiration correlation\n\n\n\n\n\n","category":"type"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"Again, to guarantee a quick start, we provided a few pre-defined parameter     sets:","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"C3Bernacchi\nC3CLM\nC4CLM","category":"page"},{"location":"Photosynthesis/#Land.Photosynthesis.C3Bernacchi","page":"Photosynthesis","title":"Land.Photosynthesis.C3Bernacchi","text":"C3ParaSet type C3 photosynthesis using Bernacchi's data \n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Land.Photosynthesis.C3CLM","page":"Photosynthesis","title":"Land.Photosynthesis.C3CLM","text":"C3ParaSet type C3 photosynthesis using CLM5's data \n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Land.Photosynthesis.C4CLM","page":"Photosynthesis","title":"Land.Photosynthesis.C4CLM","text":"C4ParaSet type C4 photosynthesis using CLM5's data \n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"Examples:","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"using Photosynthesis\n\nFT = Float32;\nset_b = C3Bernacchi(FT);\nset_3 = C3CLM(FT);\nset_4 = C4CLM(FT);","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"Note it here that the C3ParaSet and C4ParaSet structs are     mutable, and the fields can be changed to another non-mutable TD struct.     We'd like to mention that in some cases, leaf respiration rate is not     measured, and in this case, the dark respiration rate will be computed from     V_textcmax using a multiplier","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"VtoRCollatz\nVtoRDefault","category":"page"},{"location":"Photosynthesis/#Land.Photosynthesis.VtoRCollatz","page":"Photosynthesis","title":"Land.Photosynthesis.VtoRCollatz","text":"A constant of 0.01 \n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Land.Photosynthesis.VtoRDefault","page":"Photosynthesis","title":"Land.Photosynthesis.VtoRDefault","text":"A constant of 0.015 \n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Temperature-Dependency","page":"Photosynthesis","title":"Temperature Dependency","text":"","category":"section"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"As mentioned above, temperature corrections only need to be done once per     temperature change, and storing the temperature corrected values will     significantly boost the code speed. Here we provide a few functions to     change the stored values. First of all, all the temperature corrections are     made with temperature_correction:","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"temperature_correction","category":"page"},{"location":"Photosynthesis/#Land.Photosynthesis.temperature_correction","page":"Photosynthesis","title":"Land.Photosynthesis.temperature_correction","text":"temperature_correction(\n            td_set::AbstractTDParameterSet{FT},\n            T::FT) where {FT<:AbstractFloat}\n\nA correction factor based on arrhenius's fitting procedure, given\n\ntd_set ArrheniusTD or ArrheniusPeakTD type struct\nT Leaf temperature in [K]\n\nThe equation used for ArrheniusTD is\n\ncorr = exp left( dfracΔHaR T_0 - dfracΔHaR T_1 right)\n\nThe equations used for ArrheniusPeakTD are\n\ncorr = exp left( dfracΔHaR T_0 - dfracΔHaR T_1 right)\n       cdot\n       dfrac 1 + exp left( dfracS_v T_0 - H_dR T_0 right) \n               1 + exp left( dfracS_v T_1 - H_dR T_1 right) \n\nThe equation used for Q10TD is\n\ncorr = left( dfracT_1 - T_REF10 right)^Q_10\n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"Second, depending on which physiological parameter to correct, some corrections     use the VAL_25 field in the ArrheniusTD, like K_textc,     K_texto, and K_textpep:","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"photo_TD_from_set","category":"page"},{"location":"Photosynthesis/#Land.Photosynthesis.photo_TD_from_set","page":"Photosynthesis","title":"Land.Photosynthesis.photo_TD_from_set","text":"photo_TD_from_set(td_set::ArrheniusTD{FT}, T::FT) where {FT<:AbstractFloat}\nphoto_TD_from_set(td_set::Q10TD{FT}, T::FT) where {FT<:AbstractFloat}\n\nMake temperature correction from parameter set, given\n\ntd_set ArrheniusTD type parameter set, which has a VAL_25 field\nT Leaf temperature\n\nUseful for Kc, Ko, Kpep, and Γ^*.\n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"Some corrections use the reference values from the Leaf struct, like     V_textcmax and J_textmax:","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"photo_TD_from_val","category":"page"},{"location":"Photosynthesis/#Land.Photosynthesis.photo_TD_from_val","page":"Photosynthesis","title":"Land.Photosynthesis.photo_TD_from_val","text":"photo_TD_from_val(\n            td_set::AbstractTDParameterSet{FT},\n            val::FT,\n            T::FT) where {FT<:AbstractFloat}\n\nMake temperature correction from a given value, given\n\ntd_set ArrheniusTD or ArrheniusPeakTD type struct\nval Uncorrected value at 298.15 K\nT Leaf temperature\n\nUseful for Vcmax, Vomac, Vpmax, Jmax, and Respiration.\n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"The functions to make temperature corrections to each individual variables are","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"leaf_jmax!\nleaf_kc!\nleaf_km!\nleaf_ko!\nleaf_kpep!\nleaf_rd!\nleaf_vcmax!\nleaf_vpmax!\nleaf_Γstar!","category":"page"},{"location":"Photosynthesis/#Land.Photosynthesis.leaf_jmax!","page":"Photosynthesis","title":"Land.Photosynthesis.leaf_jmax!","text":"leaf_jmax!(td_set::AbstractTDParameterSet{FT},\n           leaf::Leaf{FT}) where {FT<:AbstractFloat}\n\nUpdate maximal electron transport rate at leaf temperature, given\n\ntd_set AbstractTDParameterSet type TD parameter set\nleaf Leaf type struct\n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Land.Photosynthesis.leaf_kc!","page":"Photosynthesis","title":"Land.Photosynthesis.leaf_kc!","text":"leaf_kc!(td_set::ArrheniusTD{FT}, leaf::Leaf{FT}) where {FT<:AbstractFloat}\n\nUpdate Kc at leaf temperature, given\n\ntd_set ArrheniusTD type TD parameter set\nleaf Leaf type struct\n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Land.Photosynthesis.leaf_km!","page":"Photosynthesis","title":"Land.Photosynthesis.leaf_km!","text":"leaf_km!(photo_set::C3ParaSet{FT},\n         leaf::Leaf{FT},\n         envir::AirLayer{FT}) where {FT<:AbstractFloat}\n\nUpdate Ko at leaf temperature, given\n\nphoto_set C3ParaSet type photosynthesis parameter set\nleaf Leaf type struct\nenvir AirLayer type struct\n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Land.Photosynthesis.leaf_ko!","page":"Photosynthesis","title":"Land.Photosynthesis.leaf_ko!","text":"leaf_ko!(td_set::ArrheniusTD{FT}, leaf::Leaf{FT}) where {FT<:AbstractFloat}\n\nUpdate Ko at leaf temperature, given\n\ntd_set ArrheniusTD type TD parameter set\nleaf Leaf type struct\n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Land.Photosynthesis.leaf_kpep!","page":"Photosynthesis","title":"Land.Photosynthesis.leaf_kpep!","text":"leaf_kpep!(td_set::ArrheniusTD{FT},\n           leaf::Leaf{FT}) where {FT<:AbstractFloat}\n\nUpdate Kpep at leaf temperature, given\n\ntd_set ArrheniusTD type TD parameter set\nleaf Leaf type struct\n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Land.Photosynthesis.leaf_rd!","page":"Photosynthesis","title":"Land.Photosynthesis.leaf_rd!","text":"leaf_rd!(td_set::AbstractTDParameterSet{FT},\n         leaf::Leaf{FT}) where {FT<:AbstractFloat}\n\nUpdate leaf dark respiration rate at leaf temperature, given\n\ntd_set AbstractTDParameterSet type TD parameter set\nleaf Leaf type struct\n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Land.Photosynthesis.leaf_vcmax!","page":"Photosynthesis","title":"Land.Photosynthesis.leaf_vcmax!","text":"leaf_vcmax!(td_set::AbstractTDParameterSet{FT},\n            leaf::Leaf{FT}) where {FT<:AbstractFloat}\n\nUpdate leaf maximal carboxylation rate at leaf temperature, given\n\ntd_set AbstractTDParameterSet type TD parameter set\nleaf Leaf type struct\n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Land.Photosynthesis.leaf_vpmax!","page":"Photosynthesis","title":"Land.Photosynthesis.leaf_vpmax!","text":"leaf_vpmax!(td_set::AbstractTDParameterSet{FT},\n            leaf::Leaf{FT}) where {FT<:AbstractFloat}\n\nUpdate leaf maximal PEP carboxylation rate at leaf temperature, given\n\ntd_set AbstractTDParameterSet type TD parameter set\nleaf Leaf type struct\n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Land.Photosynthesis.leaf_Γstar!","page":"Photosynthesis","title":"Land.Photosynthesis.leaf_Γstar!","text":"leaf_Γstar!(td_set::ArrheniusTD{FT},\n            leaf::Leaf{FT}) where {FT<:AbstractFloat}\n\nUpdate Γ^* at leaf temperature, given\n\ntd_set ArrheniusTD type TD parameter set\nleaf Leaf type struct\n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"Again to ease the coding, we provide a function to run all the temperature     dependencies:","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"leaf_temperature_dependence!","category":"page"},{"location":"Photosynthesis/#Land.Photosynthesis.leaf_temperature_dependence!","page":"Photosynthesis","title":"Land.Photosynthesis.leaf_temperature_dependence!","text":"leaf_temperature_dependence!(\n            photo_set::AbstractPhotoModelParaSet{FT},\n            leaf::Leaf{FT},\n            envir::AirLayer{FT}) where {FT<:AbstractFloat}\nleaf_temperature_dependence!(\n            photo_set::AbstractPhotoModelParaSet{FT},\n            leaf::Leaf{FT},\n            envir::AirLayer{FT},\n            T::FT) where {FT<:AbstractFloat}\n\nUpdate the temperature dependent photosynthesis only, given\n\nphoto_set AbstractPhotoModelParaSet type parameter set\nleaf Leaf type struct\nenvir AirLayer type struct\nT Given leaf temperature\n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"Note it here that function leaf_temperature_dependence! updates     saturated vapor pressure from leaf temperature as well.","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"Example:","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"using Photosynthesis\n\nFT = Float32;\nleaf = Leaf{FT}();\nenvir = AirLayer{FT}();\nset_3 = C3CLM(FT);\n\nleaf_temperature_dependence!(c3_set, leaf, envir);\nleaf_temperature_dependence!(c3_set, leaf, envir, FT(300));","category":"page"},{"location":"Photosynthesis/#RubisCO-limited-Photosynthesis","page":"Photosynthesis","title":"RubisCO-limited Photosynthesis","text":"","category":"section"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"By default, Photosynthesis module computes gross photosynthetic rate as the     minimal of the three:","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"A_textc RubisCO-limited photosynthetic rate\nA_textj Light-limited photosynthetic rate\nA_textp Product-limited photosynthetic rate","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"If leaf internal CO₂ is known, A_textc (gross rate) can be computed using","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"rubisco_limited_rate!","category":"page"},{"location":"Photosynthesis/#Land.Photosynthesis.rubisco_limited_rate!","page":"Photosynthesis","title":"Land.Photosynthesis.rubisco_limited_rate!","text":"rubisco_limited_rate!(\n            photo_set::AbstractPhotoModelParaSet{FT},\n            leaf::Leaf{FT}) where {FT<:AbstractFloat}\n\nCalculate the RubisCO limited photosynthetic rate, given\n\nphoto_set C3ParaSet or C4ParaSet type struct\nleaf Leaf type struct\n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"If total leaf diffusive conductance to CO₂ is known, A_textc can be     computed analytically by solving the quadratic function using","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"lower_quadratic","category":"page"},{"location":"Photosynthesis/#Land.Photosynthesis.lower_quadratic","page":"Photosynthesis","title":"Land.Photosynthesis.lower_quadratic","text":"lower_quadratic(a::FT, b::FT, c::FT) where {FT<:AbstractFloat}\n\nReturn the lower quadratic solution or NaN, given\n\na Parameter in a*x^2 + b*x + c = 0\nb Parameter in a*x^2 + b*x + c = 0\nc Parameter in a*x^2 + b*x + c = 0\n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"The function to analytically compute A_textc is","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"rubisco_limited_rate_glc!","category":"page"},{"location":"Photosynthesis/#Land.Photosynthesis.rubisco_limited_rate_glc!","page":"Photosynthesis","title":"Land.Photosynthesis.rubisco_limited_rate_glc!","text":"rubisco_limited_rate_glc!(\n            photo_set::C3ParaSet{FT},\n            leaf::Leaf{FT},\n            envir::AirLayer{FT}) where {FT<:AbstractFloat}\n\nCalculate the RubisCO limited photosynthetic rate from glc, given\n\nphoto_set C3ParaSet type struct\nleaf Leaf type struct\nenvir AirLayer type struct\n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"Note it here that rubisco_limited_rate_glc! only applies to C3     photosynthesis as the RubisCO-limited rate for C4 plants is     V_textcmax.","category":"page"},{"location":"Photosynthesis/#Light-limited-Photosynthesis","page":"Photosynthesis","title":"Light-limited Photosynthesis","text":"","category":"section"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"If leaf internal CO₂ is known, A_textj (gross rate) can be computed using","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"light_limited_rate!","category":"page"},{"location":"Photosynthesis/#Land.Photosynthesis.light_limited_rate!","page":"Photosynthesis","title":"Land.Photosynthesis.light_limited_rate!","text":"light_limited_rate!(\n            photo_set::AbstractPhotoModelParaSet{FT},\n            leaf::Leaf{FT}) where {FT<:AbstractFloat}\n\nCalculate the Light limited photosynthetic rate, given\n\nphoto_set C3ParaSet or C4ParaSet type struct\nleaf Leaf type struct\n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"If total leaf diffusive conductance to CO₂ is known, A_textj can be     computed analytically using","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"light_limited_rate_glc!","category":"page"},{"location":"Photosynthesis/#Land.Photosynthesis.light_limited_rate_glc!","page":"Photosynthesis","title":"Land.Photosynthesis.light_limited_rate_glc!","text":"light_limited_rate_glc!(\n            photo_set::C3ParaSet{FT},\n            leaf::Leaf{FT},\n            envir::AirLayer{FT}) where {FT<:AbstractFloat}\n\nCalculate the Light limited photosynthetic rate from glc, given\n\nphoto_set C3ParaSet type struct\nleaf Leaf type struct\nenvir AirLayer type struct\n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"Note it here that light_limited_rate_glc! only applies to C3     photosynthesis as the RubisCO-limited rate for C4 plants is the electron     transport rate.","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"Be aware that leaf electron transport rate needs to be calculated before the     light-limited rate:","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"leaf_ETR!","category":"page"},{"location":"Photosynthesis/#Land.Photosynthesis.leaf_ETR!","page":"Photosynthesis","title":"Land.Photosynthesis.leaf_ETR!","text":"leaf_ETR!(photo_set::AbstractPhotoModelParaSet{FT},\n          leaf::Leaf{FT}) where {FT<:AbstractFloat}\n\nUpdate the electron transport variables in the leaf struct, given\n\nphoto_set C3ParaSet or C4ParaSet type struct\nleaf Leaf type struct\n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Product-limited-Photosynthesis","page":"Photosynthesis","title":"Product-limited Photosynthesis","text":"","category":"section"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"If leaf internal CO₂ is known, A_textp (gross rate) can be computed using","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"product_limited_rate!","category":"page"},{"location":"Photosynthesis/#Land.Photosynthesis.product_limited_rate!","page":"Photosynthesis","title":"Land.Photosynthesis.product_limited_rate!","text":"product_limited_rate!(\n            photo_set::AbstractPhotoModelParaSet{FT},\n            leaf::Leaf{FT}) where {FT<:AbstractFloat}\n\nCalculate the Product limited photosynthetic rate, given\n\nphoto_set C3ParaSet or C4ParaSet type struct\nleaf Leaf type struct\n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"If total leaf diffusive conductance to CO₂ is known, A_textp can be     computed analytically using","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"product_limited_rate_glc!","category":"page"},{"location":"Photosynthesis/#Land.Photosynthesis.product_limited_rate_glc!","page":"Photosynthesis","title":"Land.Photosynthesis.product_limited_rate_glc!","text":"product_limited_rate_glc!(\n            photo_set::C4ParaSet{FT},\n            leaf::Leaf{FT},\n            envir::AirLayer{FT}) where {FT<:AbstractFloat}\n\nCalculate the Product limited photosynthetic rate from glc, given\n\nphoto_set C4ParaSet type struct\nleaf Leaf type struct\nenvir AirLayer type struct\n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"Note it here that product_limited_rate_glc! only applies to C4     photosynthesis as the RubisCO-limited rate for C4 plants is     V_textcmax/2.","category":"page"},{"location":"Photosynthesis/#Photosynthetic-Rates","page":"Photosynthesis","title":"Photosynthetic Rates","text":"","category":"section"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"For empirical and optimization stomatal models, iterations are required to get     the final solution as in StomataModels module. In this case, more     conveniently computing photosynthetic rates for each leaf is preferable. In     this case, leaf_photo_from_pi! and leaf_photo_from_glc!     are better options:","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"leaf_photo_from_pi!\nleaf_photo_from_glc!","category":"page"},{"location":"Photosynthesis/#Land.Photosynthesis.leaf_photo_from_pi!","page":"Photosynthesis","title":"Land.Photosynthesis.leaf_photo_from_pi!","text":"leaf_photo_from_pi!(\n            photo_set::AbstractPhotoModelParaSet{FT},\n            leaf::Leaf{FT}) where {FT<:AbstractFloat}\nleaf_photo_from_pi!(\n            photo_set::AbstractPhotoModelParaSet{FT},\n            leaf::Leaf{FT},\n            p_i::FT) where {FT<:AbstractFloat}\n\nCompute leaf photosynthetic rates, given\n\nphoto_set AbstractPhotoModelParaSet type parameter set\nleaf Leaf type struct\np_i Given leaf internal CO₂\n\nThe C3 photosynthesis model is from Farquhar et al. (1980) \"A biochemical model     of photosynthetic CO₂ assimilation in leaves of C3 species.\"\n\nThe C4 photosynthesis model is adapted from Collatz et al. (1992) \"Coupled     photosynthesis-stomatal conductance model for leaves of C4 plants.\"\n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Land.Photosynthesis.leaf_photo_from_glc!","page":"Photosynthesis","title":"Land.Photosynthesis.leaf_photo_from_glc!","text":"leaf_photo_from_glc!(\n            photo_set::AbstractPhotoModelParaSet{FT},\n            leaf::Leaf{FT},\n            envir::AirLayer{FT}) where {FT<:AbstractFloat}\nleaf_photo_from_glc!(\n            photo_set::AbstractPhotoModelParaSet{FT},\n            leaf::Leaf{FT},\n            envir::AirLayer{FT},\n            g_lc::FT) where {FT<:AbstractFloat}\n\nUpdate leaf photosynthetic rates from a known leaf diffusive conductance, given\n\nphoto_set AbstractPhotoModelParaSet type parameter set\nleaf Leaf type struct\nenvir AirLayer type struct\ng_lc Given leaf diffusive conductance to CO₂\n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/#Fluorescence","page":"Photosynthesis","title":"Fluorescence","text":"","category":"section"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"Photosynthesis module also provide ways to compute leaf fluorescence. By     default, the modules uses fluorescence parameters from Flexas et al. with     struct FluorescenceFlexas:","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"AbstractFluoModelParaSet\nFluoParaSet\nFluorescenceFlexas","category":"page"},{"location":"Photosynthesis/#Land.Photosynthesis.AbstractFluoModelParaSet","page":"Photosynthesis","title":"Land.Photosynthesis.AbstractFluoModelParaSet","text":"abstract type AbstractFluoModelParaSet{FT}\n\nHierarchy of the AbstractFluoModelParaSet:\n\nFluoParaSet\n\n\n\n\n\n","category":"type"},{"location":"Photosynthesis/#Land.Photosynthesis.FluoParaSet","page":"Photosynthesis","title":"Land.Photosynthesis.FluoParaSet","text":"mutable struct FluoParaSet{FT}\n\nA AbstractFluoModelParaSet type paramter set.\n\nFields\n\nKn1\nFluorescence model coefficient\nKn2\nFluorescence model coefficient\nKn3\nFluorescence model coefficient\n\n\n\n\n\n","category":"type"},{"location":"Photosynthesis/#Land.Photosynthesis.FluorescenceFlexas","page":"Photosynthesis","title":"Land.Photosynthesis.FluorescenceFlexas","text":"FluoParaSet type parameter set using Flexas's data \n\n\n\n\n\n","category":"function"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"The function that is used to compute fluorescene is","category":"page"},{"location":"Photosynthesis/","page":"Photosynthesis","title":"Photosynthesis","text":"leaf_fluorescence!","category":"page"},{"location":"Photosynthesis/#Land.Photosynthesis.leaf_fluorescence!","page":"Photosynthesis","title":"Land.Photosynthesis.leaf_fluorescence!","text":"leaf_fluorescence!(\n            fluo_set::FluoParaSet{FT},\n            leaf::Leaf{FT}) where {FT<:AbstractFloat}\n\nCompute fluorescence yield, Kn, and Kp for leaf, given\n\nfluo_set FluoParaSet type parameter set\nleaf Leaf struct\n\n\n\n\n\n","category":"function"},{"location":"Land/#Land","page":"Land","title":"Land","text":"","category":"section"},{"location":"Land/","page":"Land","title":"Land","text":"CurrentModule = Land","category":"page"},{"location":"Land/","page":"Land","title":"Land","text":"VerticalLayers\nvertical_layers!","category":"page"},{"location":"Land/#Land.VerticalLayers","page":"Land","title":"Land.VerticalLayers","text":"mutable struct VerticalLayers{FT}\n\nStruct that store trace gas information along vertical layers.\n\nFields\n\nn_layer\nNumber of layers\nd_layer\nThickness per layer\nx_layer\nVertical distances among layers (0.5 for boundaries)\nT\nTemperature at each layer\nd_CO₂\nDiffusion coefficient array\np_CO₂\nVertical CO₂ partial pressure\nΔ_CO₂\nderivative operator for CO₂ partial pressure\n\n\n\n\n\n","category":"type"},{"location":"Land/#Land.vertical_layers!","page":"Land","title":"Land.vertical_layers!","text":"vertical_layers!(vls::VerticalLayers{FT}, t::FT) where {FT<:AbstractFloat}\n\nUpdate vertical trace gas information with time, given\n\nvls VerticalLayers type struct\nt Time since last update\n\n\n\n\n\n","category":"function"},{"location":"PlantHydraulics/#API","page":"PlantHydraulics","title":"API","text":"","category":"section"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"CurrentModule = Land.PlantHydraulics","category":"page"},{"location":"PlantHydraulics/#Plant-Hydraulic-System","page":"PlantHydraulics","title":"Plant Hydraulic System","text":"","category":"section"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"The PlantHydraulics module provides two levels of hydraulics system:     organ-level and plant-level. The organ-level hydraulic systems include     Leaf, Root, and Stem (trunk and branch). The plant-level hydraulic system     is can be any combination of the three organs (custimized definition may     apply).","category":"page"},{"location":"PlantHydraulics/#Leaf,-Root,-and-Stem-HS","page":"PlantHydraulics","title":"Leaf, Root, and Stem HS","text":"","category":"section"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"Plant hydraulics is segmented to three organ-level systems/structs     (LeafHydraulics, RootHydraulics, and     StemHydraulics) subject to an Abstract type     (AbstractHydraulicSystem). The major differences among the three     structs are","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"LeafHydraulics has an extra-xylary component\nRootHydraulics has a rhizosphere component\nRootHydraulics and StemHydraulics have a gravity component","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"See the documentation for each struct for more details:","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"AbstractHydraulicSystem\nLeafHydraulics\nRootHydraulics\nStemHydraulics","category":"page"},{"location":"PlantHydraulics/#Land.PlantHydraulics.AbstractHydraulicSystem","page":"PlantHydraulics","title":"Land.PlantHydraulics.AbstractHydraulicSystem","text":"abstract type AbstractHydraulicSystem{FT}\n\nHierarchy of AbstractHydraulicSystem\n\nLeafHydraulics\nRootHydraulics\nStemHydraulics\n\n\n\n\n\n","category":"type"},{"location":"PlantHydraulics/#Land.PlantHydraulics.LeafHydraulics","page":"PlantHydraulics","title":"Land.PlantHydraulics.LeafHydraulics","text":"mutable struct LeafHydraulics{FT<:AbstractFloat}\n\nA struct that contains leaf hydraulics information.\n\nFields\n\narea\nLeaf area [m²]\nk_ox\nMaximal extra-xylary hydraulic conductance [mol s⁻¹ MPa⁻¹ m⁻²]\nk_sla\nMaximal leaf hydraulic conductance per leaf area [mol s⁻¹ MPa⁻¹ m⁻²]\nvc\nVulnerability curve\np_crt\nCritical xylem pressure [MPa]\nflow\nFlow rate in the xylem [mol s⁻¹]\np_dos\nLeaf xylem water pressure at the downstream end of leaf xylem [MPa]\np_leaf\nLeaf end water pressure at air-water interface [MPa]\np_ups\nLeaf xylem water pressure at the leaf base (upstream) [MPa]\nk_element\nList of leaf k_max per element [mol s⁻¹ MPa⁻¹ m⁻²]\nk_history\nList of leaf kr history per element\np_element\nList of xylem water pressure [MPa]\np_history\nList of xylem water pressure history (normalized to 298.15 K) [MPa]\nf_st\nRelative surface tension\nf_vis\nRelative viscosity\nT_old\nTemperature memory [K]\nT_sap\nUpstream sap temperature [K]\n\n\n\n\n\n","category":"type"},{"location":"PlantHydraulics/#Land.PlantHydraulics.RootHydraulics","page":"PlantHydraulics","title":"Land.PlantHydraulics.RootHydraulics","text":"mutable struct RootHydraulics{FT<:AbstractFloat}\n\nA struct that contains root hydraulics information.\n\nFields\n\narea\nRoot cross-section area [m²]\nk_max\nMaximal hydraulic conductance [mol s⁻¹ MPa⁻¹]\nk_s\nMaximal xylem hydraulic conductivity [mol s⁻¹ MPa⁻¹ m⁻²]\nvc\nVulnerability curve\nΔh\nRoot z difference [m]\nk_rhiz\nRhizosphere  conductance [mol s⁻¹ MPa⁻¹]\nsh\nSoil hydraulics\nflow\nFlow rate in the xylem [mol s⁻¹]\np_dos\nXylem water pressure at the downstream end of xylem [MPa]\np_rhiz\nXylem-rhizosphere interface water pressure [MPa]\np_ups\nSoil matrix potential [MPa]\nk_element\nList of k_max per element [mol s⁻¹ MPa⁻¹ m⁻²]\nk_history\nList of kr history per element\np_element\nList of xylem water pressure [MPa]\np_gravity\nList of pressure drop caused by gravity [MPa]\np_history\nList of xylem water pressure history (normalized to 298.15 K) [MPa]\nf_st\nRelative surface tension\nf_vis\nRelative viscosity\nT_old\nTemperature memory [K]\nT_sap\nUpstream sap temperature [K]\n\n\n\n\n\n","category":"type"},{"location":"PlantHydraulics/#Land.PlantHydraulics.StemHydraulics","page":"PlantHydraulics","title":"Land.PlantHydraulics.StemHydraulics","text":"mutable struct StemHydraulics{FT<:AbstractFloat}\n\nA struct that contains stem hydraulics information.\n\nFields\n\narea\nStem cross-section area [m²]\nk_max\nMaximal hydraulic conductance [mol s⁻¹ MPa⁻¹]\nk_s\nMaximal xylem hydraulic conductivity [mol s⁻¹ MPa⁻¹ m⁻²]\nvc\nVulnerability curve\nΔh\nStem height difference [m]\np_dos\nXylem water pressure at the downstream end of xylem [MPa]\np_ups\nXylem water pressure at the base (upstream) [MPa]\nk_element\nList of k_max per element [mol s⁻¹ MPa⁻¹ m⁻²]\nk_history\nList of kr history per element\np_element\nList of xylem water pressure [MPa]\np_gravity\nList of pressure drop caused by gravity [MPa]\np_history\nList of xylem water pressure history (normalized to 298.15 K) [MPa]\nf_st\nRelative surface tension\nf_vis\nRelative viscosity\nT_old\nTemperature memory [K]\nT_sap\nUpstream sap temperature [K]\n\n\n\n\n\n","category":"type"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"To initialize a hydraulics system, one needs to provide the floating type, for     example:","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"using PlantHydraulics\n\nFT = Float32;\nhs_leaf = LeafHydraulics{FT}();\nhs_root = RootHydraulics{FT}();\nhs_stem = StemHydraulics{FT}();","category":"page"},{"location":"PlantHydraulics/#Whole-plant-HS","page":"PlantHydraulics","title":"Whole-plant HS","text":"","category":"section"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"Plants differ in their structures, for example, some plants have a canopy far     above the ground elevated by a trunk, some plants have a structured canopy     supported by branch systems, and some plant has no trunk at all. To     represent the structural differences, several types of plant hydraulics     systems are pre-defined, and they are GrassLikeHS,     PalmLikeHS, TreeLikeHS, and TreeSimple     structs subject to a AbstractPlantHS type, where HS stands for     hydraulic system. The major difference between the HSs are","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"GrassLikeHS has only mutiple root and canopy layers, no trunk or   branch\nPalmLikeHS has multiple root layers, a trunk, and multiple canopy   layers, no branch system\nTreeLikeHS has multiple root layers, a trunk, and multiple branch +   canopy layers, and each branch corresponds to a canopy layer\nTreeSimple has one root, one stem, and one leaf for testing purpose","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"See the documentation for each struct for more details:","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"AbstractPlantHS\nGrassLikeHS\nPalmLikeHS\nTreeLikeHS\nTreeSimple","category":"page"},{"location":"PlantHydraulics/#Land.PlantHydraulics.AbstractPlantHS","page":"PlantHydraulics","title":"Land.PlantHydraulics.AbstractPlantHS","text":"abstract type AbstractPlantHS{FT}\n\nHierachy of AbstractPlantHS\n\nGrassLikeHS\nPalmLikeHS\nTreeLikeHS\n\n\n\n\n\n","category":"type"},{"location":"PlantHydraulics/#Land.PlantHydraulics.GrassLikeHS","page":"PlantHydraulics","title":"Land.PlantHydraulics.GrassLikeHS","text":"mutable struct GrassLikeHS{FT<:AbstractFloat}\n\nA plant hydraulic system like a grass, which contains multiple root layers, and multiple canopy layers. No trunk or branch system applies.\n\nFields\n\nn_root\nRoot Layers\nn_canopy\nCanopy Layers\nroots\nRoots system\nleaves\nLeaves\nroot_index_in_soil\nCorresponding soil layer per root layer\ncanopy_index_in_air\nCorresponding air layer per canopy layer\ncontainer_k\nConductances for each layer at given flow\ncontainer_p\nPressure for each layer at given flow\ncontainer_q\nFlow rate\n\n\n\n\n\n","category":"type"},{"location":"PlantHydraulics/#Land.PlantHydraulics.PalmLikeHS","page":"PlantHydraulics","title":"Land.PlantHydraulics.PalmLikeHS","text":"mutable struct PalmLikeHS{FT<:AbstractFloat}\n\nA plant hydraulic system like a palm, which contains multiple root layers, one trunk, and multiple canopy layers. No branch system applies.\n\nFields\n\nn_root\nRoot Layers\nn_canopy\nCanopy Layers\nroots\nRoots system\ntrunk\nTrunk\nleaves\nLeaves\nroot_index_in_soil\nCorresponding soil layer per root layer\ncanopy_index_in_air\nCorresponding air layer per canopy layer\ncontainer_k\nConductances for each layer at given flow\ncontainer_p\nPressure for each layer at given flow\ncontainer_q\nFlow rate\n\n\n\n\n\n","category":"type"},{"location":"PlantHydraulics/#Land.PlantHydraulics.TreeLikeHS","page":"PlantHydraulics","title":"Land.PlantHydraulics.TreeLikeHS","text":"mutable struct TreeLikeHS{FT<:AbstractFloat}\n\nA plant hydraulic system like a tree, which contains multiple root layers, one trunk, and multiple branch and canopy layers.\n\nFields\n\nn_root\nRoot Layers\nn_canopy\nCanopy Layers\nroots\nRoots system\ntrunk\nTrunk\nbranch\nBranch system\nleaves\nLeaves\nroot_index_in_soil\nCorresponding soil layer per root layer\ncanopy_index_in_air\nCorresponding air layer per canopy layer\ncontainer_k\nConductances for each layer at given flow\ncontainer_p\nPressure for each layer at given flow\ncontainer_q\nFlow rate\n\n\n\n\n\n","category":"type"},{"location":"PlantHydraulics/#Land.PlantHydraulics.TreeSimple","page":"PlantHydraulics","title":"Land.PlantHydraulics.TreeSimple","text":"mutable struct TreeSimple{FT<:AbstractFloat}\n\nA plant hydraulic system with one root, one stem, and one leaf for testing purpose\n\nFields\n\nroot\nRoot\nstem\nStem\nleaf\nLeaf\nkrs\nRelative hydraulic conductance\n\n\n\n\n\n","category":"type"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"To ease the initialization of a plant hydraulics system, a few customized     functions are provided for quick initialization. More importantly,     modifications to each field in the struct are always allowed. The quick     functions are create_grass_like_hs, create_palm_like_hs     , and create_tree_like_hs:","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"create_grass_like_hs\ncreate_palm_like_hs\ncreate_tree_like_hs","category":"page"},{"location":"PlantHydraulics/#Land.PlantHydraulics.create_grass_like_hs","page":"PlantHydraulics","title":"Land.PlantHydraulics.create_grass_like_hs","text":"create_grass_like_hs(z_root::FT, z_trunk::FT, z_canopy::FT, soil_bounds::Array{FT,1}, air_bounds::Array{FT,1}) where {FT<:AbstractFloat}\n\nCreate a GrassLikeHS, given\n\nz_root Maximal root depth (negative value)\nz_canopy Maximal canopy height (positive value)\nsoil_bounds Array of soil layer boundaries starting from 0\nair_bounds Array of air layer boundaries starting from 0\n\n\n\n\n\n","category":"function"},{"location":"PlantHydraulics/#Land.PlantHydraulics.create_palm_like_hs","page":"PlantHydraulics","title":"Land.PlantHydraulics.create_palm_like_hs","text":"create_palm_like_hs(z_root::FT, z_trunk::FT, z_canopy::FT, soil_bounds::Array{FT,1}, air_bounds::Array{FT,1}) where {FT<:AbstractFloat}\n\nCreate a PalmLikeHS, given\n\nz_root Maximal root depth (negative value)\nz_trunk Maximal trunk height (positive value)\nz_canopy Maximal canopy height (positive value)\nsoil_bounds Array of soil layer boundaries starting from 0\nair_bounds Array of air layer boundaries starting from 0\n\n\n\n\n\n","category":"function"},{"location":"PlantHydraulics/#Land.PlantHydraulics.create_tree_like_hs","page":"PlantHydraulics","title":"Land.PlantHydraulics.create_tree_like_hs","text":"create_tree_like_hs(z_root::FT, z_trunk::FT, z_canopy::FT, soil_bounds::Array{FT,1}, air_bounds::Array{FT,1}) where {FT<:AbstractFloat}\n\nCreate a TreeLikeHS, given\n\nz_root Maximal root depth (negative value)\nz_trunk Maximal trunk height (positive value)\nz_canopy Maximal canopy height (positive value)\nsoil_bounds Array of soil layer boundaries starting from 0\nair_bounds Array of air layer boundaries starting from 0\n\n\n\n\n\n","category":"function"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"What these functions do are to determine how many root layers and branch/canopy     layers to add based on the tree information and environmental settings. To     determine number of root layers, rooting depth and the soil layer     information are required. The z_root is the maximal root depth in     negative number, and soil_bounds is the boundaries of soil layers staring     from 0. For example, for a soil_bounds of [0.0, -1.0, -2.0, -3.0, -4.0],     a z_root of -1 gives 1 root layer, and a z_root of -1.5 or -2.0 gives 2     root layers. The z_trunk, z_canopy, and air_bounds determine how many     canopy layers to add. For example, for a air_bounds of [0.0, 1.0, 2.0,     3.0, 4.0, 5.0 ... 20.0, 21.0, 22.0], a z_trunk of 5.0 z_canopy of 7.0     give 2 canopy layers, and a z_trunk of 5.5 z_canopy of 7.0 give 2     canopy layers. Also, the root_index_in_soil and canopy_index_in_air     indicate which soil or air layer the root or canopy layer corresponds with,     respectively. For instance, a index of 7 means that the canopy layer should     use the 7th air layer.","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"To initialize a whole-plant hydraulic system, checkout the example below:","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"using PlantHydraulics\n\nFT = Float32;\ngrass = create_grass_like_hs(FT(-2.1), FT(0.5), FT(8), FT[0,-1,-2,-3], collect(FT,0:1:20));\npalm  =  create_palm_like_hs(FT(-2.1), FT(0.5), FT(8), FT[0,-1,-2,-3], collect(FT,0:1:20));\ntree  =  create_tree_like_hs(FT(-2.1), FT(0.5), FT(8), FT[0,-1,-2,-3], collect(FT,0:1:20));\ntreet = TreeSimple{FT}();","category":"page"},{"location":"PlantHydraulics/#Xylem-hydraulic-conductance","page":"PlantHydraulics","title":"Xylem hydraulic conductance","text":"","category":"section"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"Plants transport water through xylem conduits (vessels in most angiosperms,     trachieds in most gymnosperms). With the ascent of sap along the hydraulic     system, water pressure in the conduits is typically negative. The negative     xylem water pressure tends to pull air from surrounding tisses or the     atmosphere into the xylem conduits, resulting in xylem cavitation. The air     bubbles in cavitated conduits block water flow, and thus results in decline     of water transport capability (measured by xylem hydraulic conductance).","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"Typically, the correlation between xylem water pressure (P leq 0) and     hydraulic conductance (k) is expressed by a Weibull function for     WeibullSingle type correlation:","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"k = k_textmax cdot exp left( -left( dfrac-PB right)^C right)","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"where k_textmax is the maximal hydraulic conductance, and B and C are     the Weibull parameters. This correlation is also known as vulnerability     curve (VC) to drought stress. Sometimes, plants exhibit a segmented VC, for     example, the fibers may transport water as well and are much more resistant     to drought than vessels. Thus, a dual Weibull function is presented for     WeibullDual type correlation (P leq 0):","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"k = k_textmax cdot left f_1 cdot exp left -left( dfrac-PB_1 right)^C_1 right +\n                         (1 - f_1) cdot exp left -left( dfrac-PB_2 right)^C_2 right right","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"The VC formulations are abstractized as","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"AbstractXylemVC\nWeibullDual\nWeibullSingle","category":"page"},{"location":"PlantHydraulics/#Land.PlantHydraulics.AbstractXylemVC","page":"PlantHydraulics","title":"Land.PlantHydraulics.AbstractXylemVC","text":"abstract type AbstractXylemVC{FT}\n\nHierachy of AbstractXylemVC\n\nWeibullSingle\nWeibullDual\n\n\n\n\n\n","category":"type"},{"location":"PlantHydraulics/#Land.PlantHydraulics.WeibullDual","page":"PlantHydraulics","title":"Land.PlantHydraulics.WeibullDual","text":"mutable struct WeibullDual{FT}\n\nStruct that contains dual Weibull function parameters.\n\nFields\n\nb1\nB of first part [MPa]\nc1\nC of first part\nf1\nF of first part\nb2\nB of second part [MPa]\nc2\nC of second part\nf2\nF of second part\n\n\n\n\n\n","category":"type"},{"location":"PlantHydraulics/#Land.PlantHydraulics.WeibullSingle","page":"PlantHydraulics","title":"Land.PlantHydraulics.WeibullSingle","text":"mutable struct WeibullSingle{FT}\n\nStruct that contains single Weibull function parameters.\n\nFields\n\nb\nB of first part [MPa]\nc\nC of first part\n\n\n\n\n\n","category":"type"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"The function to call is","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"xylem_k_ratio","category":"page"},{"location":"PlantHydraulics/#Land.PlantHydraulics.xylem_k_ratio","page":"PlantHydraulics","title":"Land.PlantHydraulics.xylem_k_ratio","text":"xylem_k_ratio(vc::WeibullSingle{FT}, p_25::FT, vis::FT) where {FT<:AbstractFloat}\nxylem_k_ratio(vc::  WeibullDual{FT}, p_25::FT, vis::FT) where {FT<:AbstractFloat}\n\nReturns the relative hydraulic conductance, given\n\nvc Xylem vulnerability curve\np Xylem pressure at 298.15 K in [MPa]\np_25 Equivalent xylem pressure at 298.15 K in [MPa]\nvis Relative viscosity. If missing, vis = 1.\n\n\n\n\n\n","category":"function"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"Note it here that xylem_k_ratio(vc, p) calculate the k without making     temperature corrections, but the xylem_k_ratio(vc, p_25, vis) makes     correction over the viscosity (the higher the viscosity, the lower the k).     Also, p_25 means that the pressure has been corrected to 298.15 K for     surface tension (the higher the surface tension, the more resistant the     xylem).","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"Meanwhile, there is a function to call to calculate the critical pressure,     beyond which leaf will decicate. The critical pressure is calculated as the     pressure at which k is 0.001 of k_textmax for     WeibullSingle (for WeibullDual, each segment need to     reach 0.001). The functions is","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"xylem_p_crit","category":"page"},{"location":"PlantHydraulics/#Land.PlantHydraulics.xylem_p_crit","page":"PlantHydraulics","title":"Land.PlantHydraulics.xylem_p_crit","text":"xylem_p_crit(vc::WeibullSingle{FT}, f_st::FT) where {FT<:AbstractFloat}\nxylem_p_crit(vc::WeibullDual{FT}, f_st::FT) where {FT<:AbstractFloat}\n\nReturns the relative hydraulic conductance, given\n\nvc Xylem vulnerability curve\nst Relative surface tension. If missing, vis = 1.\n\n\n\n\n\n","category":"function"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"Examples:","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"using PlantHydraulics\n\nFT = Float32;\nvc_1 = WeibullSingle{FT}();\nvc_2 = WeibullDual{FT}();\n\nk_1 = xylem_k_ratio(vc_1, -1.0);\nk_2 = xylem_k_ratio(vc_2, -1.0);\nk_3 = xylem_k_ratio(vc_1, -1.0, 1.2);\nk_4 = xylem_k_ratio(vc_2, -1.0, 1.2);","category":"page"},{"location":"PlantHydraulics/#Rhizosphere-hydraulic-conductance","page":"PlantHydraulics","title":"Rhizosphere hydraulic conductance","text":"","category":"section"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"As mentioned above, there is a rhizosphere component in the root hydraulic     system, and thus one needs to compute the pressure dtop along the     rhizosphere. The soil properties are classified to BrooksCorey     and VanGenuchten types subjected to AbstractSoilVC:","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"AbstractSoilVC\nBrooksCorey\nVanGenuchten","category":"page"},{"location":"PlantHydraulics/#Land.PlantHydraulics.AbstractSoilVC","page":"PlantHydraulics","title":"Land.PlantHydraulics.AbstractSoilVC","text":"abstract type AbstractSoilVC{FT}\n\nHierachy of AbstractSoilVC:\n\nBrooksCorey\nVanGenuchten\n\n\n\n\n\n","category":"type"},{"location":"PlantHydraulics/#Land.PlantHydraulics.BrooksCorey","page":"PlantHydraulics","title":"Land.PlantHydraulics.BrooksCorey","text":"mutable struct BrooksCorey{FT<:AbstractFloat}\n\nBrooks Corey soil parameters\n\nFields\n\nstype\nSoil type\nb\nSoil b\nϕs\nϕ at saturation [MPa]\nΘs\nSoil water content (Θ) at saturation\nΘr\nResidual soil water content\n\n\n\n\n\n","category":"type"},{"location":"PlantHydraulics/#Land.PlantHydraulics.VanGenuchten","page":"PlantHydraulics","title":"Land.PlantHydraulics.VanGenuchten","text":"mutable struct VanGenuchten{FT<:AbstractFloat}\n\nVan Gunechten soil parameters\n\nFields\n\nstype\nSoil type\nα\nSoil α is related to the inverse of the air entry suction, α > 0\nn\nSoil n is Measure of the pore-size distribution\nm\nSoil m = 1 - 1/n\nΘs\nSoil water content (Θ) at saturation\nΘr\nResidual soil water content\n\n\n\n\n\n","category":"type"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"Correlations among soil relative water content, relative hydraulic conductance,     and soil matrix potential are","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"soil_erwc\nsoil_rwc\nsoil_swc\nsoil_k_ratio_erwc\nsoil_k_ratio_rwc\nsoil_k_ratio_swc\nsoil_k_ratio_p25\nsoil_p_25_erwc\nsoil_p_25_rwc\nsoil_p_25_swc","category":"page"},{"location":"PlantHydraulics/#Land.PlantHydraulics.soil_erwc","page":"PlantHydraulics","title":"Land.PlantHydraulics.soil_erwc","text":"soil_erwc(sh::BrooksCorey{FT}, p_25::FT) where {FT<:AbstractFloat}\nsoil_erwc(sh::VanGenuchten{FT}, p_25::FT) where {FT<:AbstractFloat}\n\nReturns the Effective relative water content of the soil     fracΘs - ΘrΘs - Θ, given\n\nsh BrooksCorey or VanGenuchten type soil hydraulics\np_25 Matrix water potential equivalent to 25 degree C, with surface tension\n\ncorrection\n\n\n\n\n\n","category":"function"},{"location":"PlantHydraulics/#Land.PlantHydraulics.soil_rwc","page":"PlantHydraulics","title":"Land.PlantHydraulics.soil_rwc","text":"soil_rwc(sh::BrooksCorey{FT}, p_25::FT) where {FT<:AbstractFloat}\nsoil_rwc(sh::VanGenuchten{FT}, p_25::FT) where {FT<:AbstractFloat}\n\nReturns the relative soil water content, given\n\nsh BrooksCorey or VanGenuchten type soil hydraulics\np_25 Matrix water potential equivalent to 25 degree C, with surface tension\n\ncorrection\n\n\n\n\n\n","category":"function"},{"location":"PlantHydraulics/#Land.PlantHydraulics.soil_swc","page":"PlantHydraulics","title":"Land.PlantHydraulics.soil_swc","text":"soil_swc(sh::BrooksCorey{FT}, p_25::FT) where {FT<:AbstractFloat}\nsoil_swc(sh::VanGenuchten{FT}, p_25::FT) where {FT<:AbstractFloat}\n\nReturns the soil water content, given\n\nsh BrooksCorey or VanGenuchten type soil hydraulics\np_25 Matrix water potential equivalent to 25 degree C, with surface tension\n\ncorrection\n\n\n\n\n\n","category":"function"},{"location":"PlantHydraulics/#Land.PlantHydraulics.soil_k_ratio_erwc","page":"PlantHydraulics","title":"Land.PlantHydraulics.soil_k_ratio_erwc","text":"soil_k_ratio_erwc(sh::BrooksCorey{FT}, erwc::FT) where {FT<:AbstractFloat}\nsoil_k_ratio_erwc(sh::VanGenuchten{FT}, erwc::FT) where {FT<:AbstractFloat}\n\nReturn the soil k relative to maximal k, given\n\nsh BrooksCorey or VanGenuchten type soil hydraulics\nerwc Effective relative soil water content (fracΘs - ΘrΘs - Θ)\n\n\n\n\n\n","category":"function"},{"location":"PlantHydraulics/#Land.PlantHydraulics.soil_k_ratio_rwc","page":"PlantHydraulics","title":"Land.PlantHydraulics.soil_k_ratio_rwc","text":"soil_k_ratio_rwc(sh::BrooksCorey{FT}, rwc::FT) where {FT<:AbstractFloat}\nsoil_k_ratio_rwc(sh::VanGenuchten{FT}, rwc::FT) where {FT<:AbstractFloat}\n\nReturn the soil k relative to maximal k, given\n\nsh BrooksCorey or VanGenuchten type soil hydraulics\nrwc Relative soil water content\n\n\n\n\n\n","category":"function"},{"location":"PlantHydraulics/#Land.PlantHydraulics.soil_k_ratio_swc","page":"PlantHydraulics","title":"Land.PlantHydraulics.soil_k_ratio_swc","text":"soil_k_ratio_swc(sh::BrooksCorey{FT}, swc::FT) where {FT<:AbstractFloat}\nsoil_k_ratio_swc(sh::VanGenuchten{FT}, swc::FT) where {FT<:AbstractFloat}\n\nReturn the soil k relative to maximal k, given\n\nsh BrooksCorey or VanGenuchten type soil hydraulics\nswc Relative soil water content\n\n\n\n\n\n","category":"function"},{"location":"PlantHydraulics/#Land.PlantHydraulics.soil_k_ratio_p25","page":"PlantHydraulics","title":"Land.PlantHydraulics.soil_k_ratio_p25","text":"soil_k_ratio_p25(sh::AbstractSoilVC{FT}, p_25::FT) where {FT<:AbstractFloat}\nsoil_k_ratio_p25(sh::VanGenuchten{FT}, p_25::FT) where {FT<:AbstractFloat}\n\nReturn the soil k relative to maximal k, given\n\nsh AbstractSoilVC type soil hydraulics\np_25 Matrix water potential equivalent to 25 degree C, with surface tension\n\n\n\n\n\n","category":"function"},{"location":"PlantHydraulics/#Land.PlantHydraulics.soil_p_25_erwc","page":"PlantHydraulics","title":"Land.PlantHydraulics.soil_p_25_erwc","text":"soil_p_25_erwc(sh::BrooksCorey{FT}, erwc::FT) where {FT<:AbstractFloat}\nsoil_p_25_erwc(sh::VanGenuchten{FT}, erwc::FT) where {FT<:AbstractFloat}\n\nReturns the Relative water content of the soil, given\n\nsh BrooksCorey or VanGenuchten type soil hydraulics\nerwc Effectibe relative soil water content (fracΘs - ΘrΘs - Θ)\n\nNote that this function returns the matrix potential of water, not water potential. Also, the potential is that at 25 degree C, not yet been corrected for temperature effect on surface tension.\n\n\n\n\n\n","category":"function"},{"location":"PlantHydraulics/#Land.PlantHydraulics.soil_p_25_rwc","page":"PlantHydraulics","title":"Land.PlantHydraulics.soil_p_25_rwc","text":"soil_p_25_rwc(sh::BrooksCorey{FT}, rwc::FT) where {FT<:AbstractFloat}\nsoil_p_25_rwc(sh::VanGenuchten{FT}, rwc::FT) where {FT<:AbstractFloat}\n\nReturns the Relative water content of the soil, given\n\nsh BrooksCorey or VanGenuchten type soil hydraulics\nrwc Relative soil water content\n\nNote that this function returns the matrix potential of water, not water potential. Also, the potential is that at 25 degree C, not yet been corrected for temperature effect on surface tension.\n\n\n\n\n\n","category":"function"},{"location":"PlantHydraulics/#Land.PlantHydraulics.soil_p_25_swc","page":"PlantHydraulics","title":"Land.PlantHydraulics.soil_p_25_swc","text":"soil_p_25_swc(sh::BrooksCorey{FT}, rwc::FT) where {FT<:AbstractFloat}\nsoil_p_25_swc(sh::VanGenuchten{FT}, rwc::FT) where {FT<:AbstractFloat}\n\nReturns the Relative water content of the soil, given\n\nsh BrooksCorey or VanGenuchten type soil hydraulics\nswc Soil water content\n\nNote that this function returns the matrix potential of water, not water potential. Also, the potential is that at 25 degree C, not yet been corrected for temperature effect on surface tension.\n\n\n\n\n\n","category":"function"},{"location":"PlantHydraulics/#Pressure-and-Flow","page":"PlantHydraulics","title":"Pressure and Flow","text":"","category":"section"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"The PlantHydraulics module is designed to run numerically for the following     reasons:","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"Weibull function is cannot be integrated\nThe VC is segmented, i.e., if P  0, k = k_textmax (implemented in   xylem_k_ratio)\nOnce xylem cavitation occurs, it cannot be easily recovered unless P  0,   and thus there is a drought legacy effect. This is why there are a few   fields in the LeafHydraulics, RootHydraulics, and   StemHydraulics structs to store the drought history information.\nTemperature may change along the flow path. The f_st and f_vis in the   structs help deal with these effects.","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"Function xylem_p_from_flow calculates the xylem end pressure for an     organ-level hysraulic system. As mentioned above, the     RootHydraulics and StemHydraulics has a gravity     component, and the RootHydraulics has a rhizosphere component.     Also be aware that xylem_p_from_flow accounts for temperature     effects on surface tension and viscosity.","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"xylem_p_from_flow","category":"page"},{"location":"PlantHydraulics/#Land.PlantHydraulics.xylem_p_from_flow","page":"PlantHydraulics","title":"Land.PlantHydraulics.xylem_p_from_flow","text":"xylem_p_from_flow(leaf::LeafHydraulics{FT}, flow::FT) where {FT<:AbstractFloat}\nxylem_p_from_flow(root::RootHydraulics{FT}, flow::FT) where {FT<:AbstractFloat}\nxylem_p_from_flow(stem::StemHydraulics{FT}, flow::FT) where {FT<:AbstractFloat}\nxylem_p_from_flow(tree::GrassLikeHS{FT}, flow::FT) where {FT<:AbstractFloat}\nxylem_p_from_flow(tree::PalmLikeHS{FT}, flow::FT) where {FT<:AbstractFloat}\nxylem_p_from_flow(tree::TreeLikeHS{FT}, flow::FT) where {FT<:AbstractFloat}\nxylem_p_from_flow(tree::TreeSimple{FT}, flow::FT) where {FT<:AbstractFloat}\nxylem_p_from_flow(tree::TreeSimple{FT}, f_sl::FT, f_sh::FT, r_sl::FT) where {FT<:AbstractFloat}\n\nReturn the xylen end pressure(s) from flow rate(s), given\n\nleaf LeafHydraulics type struct\nroot RootHydraulics type struct\nstem StemHydraulics type struct\ntree AbstractPlantHS type struct\nflow Flow rate (per leaf area for LeafHydraulics)\nf_sl Flow rate to sunlit leaves\nf_sh Flow rate to shaded leaves\nr_sl Fraction of sunlit leaves\n\nNote, gravity is accounted for in root and stem; rhizosphere conductance is     accounted for in root; extra-xylary conductance is not accounted for in     leaf here because it calculates xylem end pressure.\n\n\n\n\n\n","category":"function"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"Noe that function xylem_p_from_flow does not update the pressure     profiles or history in the xylem. To update these profiles, use     hydraulic_p_profile!, and to remove these legacy profiles, use     inititialize_legacy!:","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"hydraulic_p_profile!\ninititialize_legacy!","category":"page"},{"location":"PlantHydraulics/#Land.PlantHydraulics.hydraulic_p_profile!","page":"PlantHydraulics","title":"Land.PlantHydraulics.hydraulic_p_profile!","text":"hydraulic_p_profile!(leaf::LeafHydraulics{FT}, flow::FT) where {FT<:AbstractFloat}\nhydraulic_p_profile!(root::RootHydraulics{FT}, flow::FT) where {FT<:AbstractFloat}\nhydraulic_p_profile!(stem::StemHydraulics{FT}, flow::FT) where {FT<:AbstractFloat}\nhydraulic_p_profile!(tree::TreeSimple{FT}, p_soil::FT, flow::FT) where {FT<:AbstractFloat}\nhydraulic_p_profile!(tree::TreeSimple{FT}, p_soil::FT, f_sl::FT, f_sh::FT, r_sl::FT) where {FT<:AbstractFloat}\n\nUpdate the pressure profile, given\n\nleaf LeafHydraulics type struct\nroot RootHydraulics type struct\nstem StemHydraulics type struct\ntree TreeSimple type struct\np_soil Soil water potential\nflow Flow rate (per leaf area for LeafHydraulics)\nf_sl Flow rate to sunlit leaves\nf_sh Flow rate to shaded leaves\nr_sl Fraction of sunlit leaves\n\n\n\n\n\n","category":"function"},{"location":"PlantHydraulics/#Land.PlantHydraulics.inititialize_legacy!","page":"PlantHydraulics","title":"Land.PlantHydraulics.inititialize_legacy!","text":"inititialize_legacy!(hs::AbstractHydraulicSystem{FT}) where {FT<:AbstractFloat}\ninititialize_legacy!(tree::TreeSimple{FT}) where {FT<:AbstractFloat}\n\nInitialize the drought legacy effects in the xylem, given\n\nhs [AbstractHydraulicSystem] type struct\ntree TreeSimple type struct\n\n\n\n\n\n","category":"function"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"Examples:","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"using PlantHydraulics\n\nFT = Float32;\nleaf = LeafHydraulics{FT}();\np = xylem_p_from_flow(leaf, FT(0.01));\n@show leaf.p_element;\nhydraulic_p_profile!(leaf, FT(0.01));\n@show leaf.p_element;","category":"page"},{"location":"PlantHydraulics/#Root-Hydraulics","page":"PlantHydraulics","title":"Root Hydraulics","text":"","category":"section"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"Function xylem_p_from_flow works for the case of only 1 root layer if     one needs the plant base xylem water pressure. However, when there are     multiple root layers, xylem_p_from_flow does not apply. In this     case, iterations are required to calculate the xylem end pressure for each     root layers, and then make sure all root layers have the same xylem end     pressure. A few functions are provided to realize this.","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"Function root_q_from_pressure uses Root Solving method to calculate     the flow rate through the RootHydraulics struct that yields the     given xylem end pressure. The ini in the function is optional. However,     using the flow rate from last instant when pressure does not differ much     will speed up the calculation.","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"root_q_from_pressure","category":"page"},{"location":"PlantHydraulics/#Land.PlantHydraulics.root_q_from_pressure","page":"PlantHydraulics","title":"Land.PlantHydraulics.root_q_from_pressure","text":"root_q_from_pressure(root::RootHydraulics{FT}, pressure::FT, ini::FT) where {FT<:AbstractFloat}\n\nCalculate the flow rate from a given tree base pressure, given\n\nroot RootHydraulics type struct\npressure Given tree base pressure in [MPa]\nini Initial guess\n\n\n\n\n\n","category":"function"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"In the plant hydraulic module design, flow rate is computed for each canopy     layer, and thus computing flow rate for each root layer is required for a     multiple layered root system. One feasible way is to do iterations using     root_q_from_pressure function, i.e., iterate the xylem end     pressure til the total flow rate equals the given value. However, this     method is too inefficient. What I did is","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"Calculate the xylem end pressure and whole root layer conductance from the   initial flow rate;\nCalculate the mean xylem end pressure, and tune the flow rates in all root   layers using the difference from mean pressure and root conductance;\nSum up the new flow rates, and calculate the difference with given total flow   rate;\nUse the calculated condutcance to weight out the differences.","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"The functions provided by PlantHydraulics module are","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"root_pk_from_flow\nrecalculate_roots_flow!","category":"page"},{"location":"PlantHydraulics/#Land.PlantHydraulics.root_pk_from_flow","page":"PlantHydraulics","title":"Land.PlantHydraulics.root_pk_from_flow","text":"root_pk_from_flow(root::RootHydraulics{FT}, flow::FT) where {FT<:AbstractFloat}\n\nReturn root xylem end pressure and root hydraulic conductance (reverse of     summed resistance), given\n\nroot RootHydraulics struct\nflow Given flow rates in the root layer\n\n\n\n\n\n","category":"function"},{"location":"PlantHydraulics/#Land.PlantHydraulics.recalculate_roots_flow!","page":"PlantHydraulics","title":"Land.PlantHydraulics.recalculate_roots_flow!","text":"rrecalculate_roots_flow!(roots::Array{RootHydraulics{FT},1}, ks::Array{FT,1}, ps::Array{FT,1}, qs::Array{FT,1}, flow::FT) where {FT<:AbstractFloat}\n\nRecalculate the flow rates in the root from the pressure and conductance     profiles in each root at non-steady state, given\n\nroots Array of RootHydraulics structs\nks Container for conductance in each root layer\nps Container for end xylem pressure in each layer\nqs Container for flow rate in each layer\nflow Total flow rate\n\n\n\n\n\n","category":"function"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"However, the steps above are only 1 iteration, and can only be used for the     non-steady state version of model. For the steady-state flow rates,     function roots_flow! does thw work. What the function does is to     iterate recalculate_roots_flow! till the difference among the     calculated end pressures is small enough. I also emphasize that to speed up     the code, 3 containers are added to the AbstractPlantHS structs,     and they are container_k, container_p, and container_q.","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"roots_flow!","category":"page"},{"location":"PlantHydraulics/#Land.PlantHydraulics.roots_flow!","page":"PlantHydraulics","title":"Land.PlantHydraulics.roots_flow!","text":"root_qs_p_from_q(roots::Array{RootHydraulics{FT},1}, ks::Array{FT,1}, ps::Array{FT,1}, qs::Array{FT,1}, flow::FT) where {FT<:AbstractFloat}\n\nSolve for the flow rates in each root layer and root pressure at steady state,     given\n\nroots Array of RootHydraulics structs\nks Container for conductance in each root layer\nps Container for end xylem pressure in each layer\nqs Container for flow rate in each layer\nflow Total flow rate\n\n\n\n\n\n","category":"function"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"Example:","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"using PlantHydraulics\n\nFT = Float32;\npalm  =  create_palm_like_hs(FT(-2.1), FT(0.5), FT(8), FT[0,-1,-2,-3], collect(FT,0:1:20));\nroots_flow!(palm.roots, palm.container_k, palm.container_p, palm.container_q, FT(1));","category":"page"},{"location":"PlantHydraulics/#Leaf-Hydraulics","page":"PlantHydraulics","title":"Leaf Hydraulics","text":"","category":"section"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"The stomatal models often require plant hydraulics either as a correction     factor (in empirical stomatal models) or as the risk term (in optimal     stomatal models). To facilitate the calculations, a few specific functions     are provided.","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"Function leaf_xylem_risk returns the risk in xylem hydraulic function     based on the most downstream end of the xylem. The risk of plant hydraulic     system is not only on current system, but also potential new growth (plants     don't want to risk new growth either). Thus, function     leaf_xylem_risk evaluates the risk from the xylem pressure     calculated from current system (with drought history), and then compute the     risk from the pressure (the severer the srought history, the higher the     risk):","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"leaf_xylem_risk","category":"page"},{"location":"PlantHydraulics/#Land.PlantHydraulics.leaf_xylem_risk","page":"PlantHydraulics","title":"Land.PlantHydraulics.leaf_xylem_risk","text":"leaf_xylem_risk(hs::LeafHydraulics{FT}, flow::FT) where {FT<:AbstractFloat}\n\nEvaluate the hydraulic risk at the end of leaf xylem, given\n\nhs LeafHydraulics type struct\nflow Flow rate (per leaf area)\n\n\n\n\n\n","category":"function"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"Note that function leaf_xylem_risk can work on its own without having     other organ-level components. For example, by changing the p_ups of a     LeafHydraulics, one can simulate the case of drought without     caring about other hydraulic systems. Same for function     leaf_e_crit below. However, these functions are only useful for     sensitivity analysis or when p_ups in the LeafHydraulics is     accurate.","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"Examples","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"using PlantHydraulics\n\nFT = Float32;\nleaf = LeafHydraulics{FT}();\nrisk = leaf_xylem_risk(leaf, FT(0.01));\n@show risk;\nleaf.p_ups = FT(-1.0);\nrisk = leaf_xylem_risk(leaf, FT(0.01));\n@show risk;","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"Function leaf_e_crit calculates critical leaf transpiration rate,     beyond which leaf will desicate. Function leaf_e_crit accounts     for drought legacy effect by design, and the more severe the drought     history, the lower the e_crit. Again, ini in the function is also     optional, but a good guess will speed up the calculations.","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"leaf_e_crit","category":"page"},{"location":"PlantHydraulics/#Land.PlantHydraulics.leaf_e_crit","page":"PlantHydraulics","title":"Land.PlantHydraulics.leaf_e_crit","text":"leaf_e_crit(hs::LeafHydraulics{FT}, ini::FT) where {FT<:AbstractFloat}\n\nCalculate the critical flow rate (K ≈ 0), given\n\nhs LeafHydraulics type struct\nini Initial guess\n\nNote, for the safety of no NaN, update e_crit when ΔP >= -0.01\n\n\n\n\n\n","category":"function"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"Examples","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"using PlantHydraulics\n\nFT = Float32;\nleaf = LeafHydraulics{FT}();\nrisk = leaf_e_crit(leaf);\n@show risk;\nleaf.p_ups = FT(-1.0);\nrisk = leaf_e_crit(leaf);\n@show risk;","category":"page"},{"location":"PlantHydraulics/#Whole-plant-Hydraulics","page":"PlantHydraulics","title":"Whole-plant Hydraulics","text":"","category":"section"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"Though leaf_xylem_risk and leaf_e_crit can work on their     own, the functions only evaluate the risks on leaf level. The more     realistic case is that when leaf transpiration rate increases, p_ups in     the LeafHydraulics gets more negative. Thus, the     leaf_xylem_risk and leaf_e_crit tends to underestimate     the risk and overestimate the critical flow rate. To overcome this problem,     whole-plant level plant hydraulics are provided.","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"Function xylem_p_from_flow calculates the leaf xylem end pressure for     a whole-plant struct using these steps:","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"calculate the plant base pressure from a given total flow rate\ncalculate the trunk end pressure (if present)\ncalculate the branch end pressure (if present)\ncalculate the leaf end pressure (if present)","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"Accordingly, there is a function tree_e_crit to calculate the     critical flow rate for the whole plant. Be aware that Plant-level function     xylem_p_from_flow and tree_e_crit only applies to the     case of only one canopy layer (or big-leaf model). As to the case of     multiple canopy layer, more functions are pending.","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"tree_e_crit","category":"page"},{"location":"PlantHydraulics/#Land.PlantHydraulics.tree_e_crit","page":"PlantHydraulics","title":"Land.PlantHydraulics.tree_e_crit","text":"tree_e_crit(tree::PalmLikeHS{FT}, ini::FT) where {FT<:AbstractFloat}\n\nCalculate the critical flow rate for the tree per LA, given\n\ntree GrassLikeHS or PalmLikeHS or TreeLikeHS   type hydraulics system\nini Initial guess of the critical flow rate\n\n\n\n\n\n","category":"function"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"Note that the organ level or whole-plant level conductances are different from     xylem hydraulic conductance at a given xylem slice. Also, simply computing     the conductance as the flow rate divided by pressre drop is not accurate     because of the gravity. In the PlantHydraulics module, the organ and     whole-plant level conductances are computed by firstly adding up all the     resistances in each element, and then computing the relative loss of     conductance. The function available to use is","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"plant_conductances!","category":"page"},{"location":"PlantHydraulics/#Land.PlantHydraulics.plant_conductances!","page":"PlantHydraulics","title":"Land.PlantHydraulics.plant_conductances!","text":"plant_conductances!(tree::TreeSimple{FT}) where {FT<:AbstractFloat}\n\nUpdate plant total hydraulic information in each element and whole plant, given\n\ntree TreeSimple type struct\n\n\n\n\n\n","category":"function"},{"location":"PlantHydraulics/#Temperature-effects","page":"PlantHydraulics","title":"Temperature effects","text":"","category":"section"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"Plant hydraulic properties changes with temperature, due to its impacts on     surface tension and viscosity. As to surface tension, when temperature     increases, air-water interface surface tension decreases, meaning that with     the same curvature, the capillary pressure provided decreases. As a result,     soil matrix potential becomes less nagative (good for plants!), but the     conduit resistance to cavitation decreases (bad for plants!). As to     viscosity, when temperature increases, viscosity decreases, meaning that     pressure drop decreases at the same flow rate (good for plants!). To     account for these effects, we provided vc_temperature_effects!     function:","category":"page"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"vc_temperature_effects!","category":"page"},{"location":"PlantHydraulics/#Land.PlantHydraulics.vc_temperature_effects!","page":"PlantHydraulics","title":"Land.PlantHydraulics.vc_temperature_effects!","text":"vc_temperature_effects!(hs::AbstractHydraulicSystem{FT}, T::FT) where {FT<:AbstractFloat}\nvc_temperature_effects!(hs::AbstractHydraulicSystem{FT}) where {FT<:AbstractFloat}\nvc_temperature_effects!(tree::TreeSimple{FT}) where {FT<:AbstractFloat}\n\nUpdate temperature effetcs on hydralic system, given\n\nhs AbstractHydraulicSystem type struct\nT Given temperature\ntree TreeSimple type struct\n\n\n\n\n\n","category":"function"},{"location":"PlantHydraulics/","page":"PlantHydraulics","title":"PlantHydraulics","text":"Keep in mind that, leaf critical pressure changes due to surface tension,     though the impact can be neglected for minor temperature change. However,     soil water content is still computed using the equivalent matrix potential     at 25 Celcius because water content is only related to the air-water     interface curvature.","category":"page"},{"location":"#CliMA-Land-Model","page":"Home","title":"CliMA Land Model","text":"","category":"section"},{"location":"#Use-Land-model","page":"Home","title":"Use Land model","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"julia> using Pkg\njulia> Pkg.add(PackageSpec(url=\"https://github.com/CliMA/Land.git\"))\njulia> using Land","category":"page"},{"location":"#Pages-description","page":"Home","title":"Pages description","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Tips           -- docs/src/pages/Tips.md\nTutorials      -- docs/src/tutorial_scripts/*.jl","category":"page"},{"location":"#To-do-lists","page":"Home","title":"To do lists","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Add more docs to the sub-modules","category":"page"}]
}
